webpackJsonp([1],{"9M+g":function(t,a){},Jmt5:function(t,a){},NHnr:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("7+uW"),n={render:function(){var t=this.$createElement,a=this._self._c||t;return a("div",{attrs:{id:"app"}},[a("RouterView")],1)},staticRenderFns:[]},i=e("VU/8")({name:"App"},n,!1,null,null,null).exports,r=e("/ocq"),l=e("lbHh"),o=e.n(l),c=e("NYxO"),d=e("//Fk"),_=e.n(d),p=e("mtWM"),v=e.n(p),u={1002:"Agent 注册",1003:"Agent 删除",1004:"重置 AppSecret",1005:"下发通用配置",1006:"下发白名单配置",1007:"下发算法配置",1008:"下发报警配置",1009:"下发检测插件",1010:"上传插件",1011:"删除插件",1012:"创建应用",1013:"删除应用",1014:"更新应用信息",1015:"重置插件配置"},m=[{name:"X-Frame-Options",descr:"点击劫持防护",options:[{name:"不开启",value:void 0},{name:"拒绝 (deny)",value:"deny"},{name:"只允许同源 (sameorigin)",value:"sameorigin"}]},{name:"X-Content-Type-Options",descr:"MIME 嗅探防护",options:[{name:"不开启",value:void 0},{name:"开启",value:"nosniff"}]},{name:"X-XSS-Protection",descr:"XSS Auditor 防护",options:[{name:"不开启",value:void 0},{name:"拦截模式",value:"1; mode=block"}]},{name:"X-Download-Options",descr:"文件下载防护",options:[{name:"不开启",value:void 0},{name:"关闭自动运行 (noopen)",value:"noopen"}]}],h={3001:"Cookie httpOnly 检查",3002:"进程启动账号检查",3003:"后台弱口令检查",3004:"不安全的默认应用检查",3005:"开放目录检查",3006:"数据库连接账号审计",3007:"JBoss 后台无认证检查",3009:"Web 根目录敏感文件泄露",4001:"allow_url_include 配置审计",4002:"expose_php 配置审计",4003:"display_errors 配置审计",4004:"yaml.decode_php 配置审计"},f={sql:"SQL 注入",sql_exception:"SQL 语句异常",eval:"EVAL 代码执行",loadLibrary:"类库加载",command:"命令执行",xxe:"XXE 外部实体加载",directory:"目录遍历",rename:"文件重命名",readFile:"任意文件读取",deleteFile:"任意文件删除",include:"任意文件包含",writeFile:"任意文件写入",ssrf:"SSRF 请求伪造",ssrfRedirect:"SSRF 请求伪造(重定向后)",ognl:"OGNL 代码执行",webdav:"任意文件上传 (PUT)",fileUpload:"任意文件上传",deserialization:"反序列化攻击",xss_echo:"Echo XSS 跨站脚本攻击",xss_userinput:"BODY XSS 跨站脚本攻击",webshell_callable:"WebShell - 变形后门",webshell_eval:"WebShell - 中国菜刀",webshell_command:"WebShell - 命令执行",webshell_file_put_contents:"WebShell - 后门上传",webshell_ld_preload:"WebShell - 环境变量方式",response:"HTTP 响应采样检测",request:"请求开始",link:"文件链接",jndi:"JNDI请求",dns:"DNS请求"},g={block:"拦截请求",log:"记录日志"};function b(t,a){return t.replace(/\s/g,"").split(a).filter(function(t){return t})}function y(t){var a=!1;try{new RegExp(t)}catch(t){a="正则表达式错误:"+t.toString()}return a}function k(t){return g[t]||t}function C(t){return"webshell"==t?"WebShell 网站后门":"xss"==t?"XSS 跨站脚本攻击":f[t]||t}var w=v.a.create({baseURL:"/",timeout:8e3});function x(t,a){var e=new Blob([a],{type:"application/octet-stream"}),s=document.createElement("a");s.href=window.URL.createObjectURL(e),s.download=t,s.click()}w.interceptors.request.use(function(t){return t},function(t){console.error(t),_.a.reject(t)}),w.interceptors.response.use(function(t){var a=t.data;return 0!==a.status?(401===a.status?(o.a.set("RASP_AUTH_ID",null),"login"!==Ya.currentRoute.name&&Ya.push({name:"login",query:{redirect:location.href}})):alert(t.config.url+" 接口出错: "+a.status+" - "+a.description),_.a.reject(a)):a.data},function(t){return alert("HTTP 请求出错: 响应码 "+t.response.status),console.error(t),_.a.reject(t)}),s.default.use(c.a);var P=new c.a.Store({state:{app_list:[],current_app:{},app_count:0,sticky:!0},mutations:{setCurrentApp:function(t,a){this.state.current_app=a},setAppList:function(t,a){this.state.app_list=a},setAppListCount:function(t,a){this.state.app_count=a},setSticky:function(t,a){this.state.sticky=a}},actions:{loadAppList:function(t,a){var e=t.commit;w.post("v1/api/app/get",{page:1,perpage:50}).then(function(t){var s=t.data,n=t.total;if(e("setAppList",s),e("setAppListCount",n),a){var i=s.find(function(t){return t.id===a});i?e("setCurrentApp",i):w.post("v1/api/app/get",{app_id:a}).then(function(t){t?e("setCurrentApp",t):(alert("没有这个应用: "+a),e("setCurrentApp",s[0]))})}else e("setCurrentApp",s[0])})}},getters:{app_list:function(t){return t.app_list},app_count:function(t){return t.app_count},current_app:function(t){return t.current_app},sticky:function(t){return t.sticky}}}),A={name:"Login",data:function(){return{username:"openrasp",password:"",title:"OpenRASP 管理后台登录",logo:""}},mounted:function(){this.updateLogo()},methods:{updateLogo:function(){var t=this;v.a.get("static/frontend.json").then(function(a){try{var e=a.data;e.enable&&(t.title=e.title,t.logo=e.logo,document.title=e.title)}catch(t){console.log(t)}}).catch(function(t){})},doLogin:function(){var t=this;return w.post("v1/user/login",{username:this.username,password:this.password}).then(function(a){t.$route.query.redirect?location.href=t.$route.query.redirect:t.$router.replace({name:"dashboard"})})}}},S={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"container"},[e("div",{staticClass:"row",staticStyle:{height:"100vh"}},[e("div",{staticClass:"col col-login m-auto"},[t.logo?e("div",{staticClass:"text-center mb-6"},[e("img",{staticStyle:{width:"100px"},attrs:{src:t.logo}})]):t._e(),t._v(" "),e("form",{staticClass:"card",on:{submit:function(a){return t.doLogin()}}},[e("div",{staticClass:"card-body p-6"},[e("div",{staticClass:"card-title text-center"},[t._v("\n            "+t._s(t.title)+"\n          ")]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n              用户名\n            ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.username,expression:"username",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.username},on:{input:function(a){a.target.composing||(t.username=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[t._m(0),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password",placeholder:"输入密码",autocomplete:"off"},domProps:{value:t.password},on:{input:function(a){a.target.composing||(t.password=a.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-footer"},[e("button",{staticClass:"btn btn-primary btn-block",attrs:{type:"submit",plain:!0},on:{click:function(a){return a.preventDefault(),t.doLogin()}}},[t._v("\n              登录\n            ")])])])])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("label",{staticClass:"form-label"},[this._v("\n              密码\n              "),a("a",{staticClass:"float-right small",attrs:{href:"https://rasp.baidu.com/doc/install/panel.html#forget-password",target:"_blank"}},[this._v("\n                忘记密码?\n              ")])])}]},j=e("VU/8")(A,S,!1,null,null,null).exports,E=e("Dd8w"),D=e.n(E),M=e("0+QU"),N=e.n(M),q={name:"TopAttackType",components:{VueC3:N.a},data:function(){return{data:[],category_handler:new s.default}},methods:{setData:function(t){this.data=t;var a={size:{height:192},data:{columns:t,type:"pie",names:f},axis:{},legend:{show:!1},padding:{bottom:0,top:0}};this.category_handler.$emit("init",a)}}},U={render:function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticStyle:{height:"12rem"}},[a("VueC3",{directives:[{name:"show",rawName:"v-show",value:this.data.length,expression:"data.length"}],attrs:{handler:this.category_handler}}),this._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:!this.data.length,expression:"! data.length"}],staticClass:"text-center",staticStyle:{display:"flex","justify-content":"center",height:"100%","align-items":"center"}},[this._v("\n    暂无数据\n  ")])],1)},staticRenderFns:[]},R=e("VU/8")(q,U,!1,null,null,null).exports,L={name:"TopAttackUa",components:{VueC3:N.a},data:function(){return{source_handler:new s.default,data:[]}},methods:{setData:function(t){this.data=t;var a={size:{height:192},data:{columns:this.data,type:"donut",names:f},axis:{x:{tick:{width:200}}},legend:{show:!1},padding:{bottom:0,top:0},tooltip:{format:{name:function(t,a,e,s){return t.length>70?t.substr(0,70)+" ...":t}}}};this.source_handler.$emit("init",a)}}},O={render:function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticStyle:{height:"12rem"}},[a("VueC3",{directives:[{name:"show",rawName:"v-show",value:this.data.length,expression:"data.length"}],attrs:{handler:this.source_handler}}),this._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:!this.data.length,expression:"! data.length"}],staticClass:"text-center",staticStyle:{display:"flex","justify-content":"center",height:"100%","align-items":"center"}},[this._v("\n    暂无数据\n  ")])],1)},staticRenderFns:[]},I=e("VU/8")(L,O,!1,null,null,null).exports,z={name:"EventTrend",components:{VueC3:N.a},data:function(){return{trend_handler:new s.default}},methods:{setData:function(t){var a=this;t.data[0].unshift("拦截请求"),t.data[1].unshift("记录日志");var e={size:{height:250},data:{columns:t.data,type:"area",groups:[["data1","data2"]],colors:{data1:"#467fcf",data2:"#5eba00"},names:{data1:"拦截数量",data2:"日志数量"}},axis:{y:{padding:{bottom:0},show:!1,tick:{outer:!1}},x:{padding:{left:0,right:0},show:!1}},legend:{position:"inset",padding:0,inset:{anchor:"top-left",x:20,y:8,step:10}},tooltip:{format:{title:function(e){return a.moment(t.labels[e]).format("YYYY-MM-DD")}}},padding:{bottom:0,left:-1,right:-1},point:{show:!1}};this.trend_handler.$emit("init",e)}}},F={render:function(){var t=this.$createElement;return(this._self._c||t)("VueC3",{staticStyle:{height:"15rem"},attrs:{handler:this.trend_handler}})},staticRenderFns:[]},T={name:"Dashboard",components:{TopAttackType:R,TopAttackUa:I,EventTrend:e("VU/8")(z,F,!1,null,null,null).exports},data:function(){return{}},computed:D()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.loadChartData()}},mounted:function(){this.current_app.id&&this.loadChartData()},methods:{loadChartData:function(){var t=this,a={app_id:this.current_app.id,size:10,start_time:1e3*this.moment().subtract(1,"months").unix(),end_time:1e3*this.moment().unix(),interval:"day",time_zone:"+08:00"};this.request.post("v1/api/log/attack/aggr/type",a).then(function(a){t.$refs.top_attack_type.setData(a)}),this.request.post("v1/api/log/attack/aggr/ua",a).then(function(a){t.$refs.top_attack_ua.setData(a)}),this.request.post("v1/api/log/attack/aggr/time",a).then(function(a){t.$refs.event_trend.setData(a)})}}},H={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[t._e(),t._v(" "),e("div",{staticClass:"row row-cards"},[e("div",{staticClass:"col-lg-6"},[e("div",{staticClass:"card"},[t._m(6),t._v(" "),e("EventTrend",{ref:"event_trend"})],1)]),t._v(" "),e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-6"},[e("div",{staticClass:"card"},[t._m(7),t._v(" "),e("div",{staticClass:"card-body"},[e("TopAttackUa",{ref:"top_attack_ua"})],1)])]),t._v(" "),e("div",{staticClass:"col-sm-6"},[e("div",{staticClass:"card"},[t._m(8),t._v(" "),e("div",{staticClass:"card-body"},[e("TopAttackType",{ref:"top_attack_type"})],1)])])])])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col-6 col-sm-4 col-lg-2"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body p-3 text-center"},[a("div",{staticClass:"text-right text-green"},[this._v("\n              6%\n              "),a("i",{staticClass:"fe fe-chevron-up"})]),this._v(" "),a("div",{staticClass:"h1 m-0"},[a("span",{staticClass:"text-danger"},[this._v("\n                1\n              ")])]),this._v(" "),a("div",{staticClass:"text-muted mb-4"},[this._v("\n              未处理\n            ")])])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col-6 col-sm-4 col-lg-2"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body p-3 text-center"},[a("div",{staticClass:"text-right text-red"},[this._v("\n              -3%\n              "),a("i",{staticClass:"fe fe-chevron-down"})]),this._v(" "),a("div",{staticClass:"h1 m-0"},[this._v("\n              17\n            ")]),this._v(" "),a("div",{staticClass:"text-muted mb-4"},[this._v("\n              拦截数量\n            ")])])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col-6 col-sm-4 col-lg-2"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body p-3 text-center"},[a("div",{staticClass:"text-right text-green"},[this._v("\n              9%\n              "),a("i",{staticClass:"fe fe-chevron-up"})]),this._v(" "),a("div",{staticClass:"h1 m-0"},[this._v("\n              7\n            ")]),this._v(" "),a("div",{staticClass:"text-muted mb-4"},[this._v("\n              放行数量\n            ")])])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col-6 col-sm-4 col-lg-2"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body p-3 text-center"},[a("div",{staticClass:"text-right text-green"},[this._v("\n              3%\n              "),a("i",{staticClass:"fe fe-chevron-up"})]),this._v(" "),a("div",{staticClass:"h1 m-0"},[this._v("\n              1\n            ")]),this._v(" "),a("div",{staticClass:"text-muted mb-4"},[this._v("\n              在线主机\n            ")])])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col-6 col-sm-4 col-lg-2"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body p-3 text-center"},[a("div",{staticClass:"text-right text-red"},[this._v("\n              -2%\n              "),a("i",{staticClass:"fe fe-chevron-down"})]),this._v(" "),a("div",{staticClass:"h1 m-0"},[this._v("\n              3\n            ")]),this._v(" "),a("div",{staticClass:"text-muted mb-4"},[this._v("\n              失联主机\n            ")])])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col-6 col-sm-4 col-lg-2"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body p-3 text-center"},[a("div",{staticClass:"text-right text-red"},[this._v("\n              -1%\n              "),a("i",{staticClass:"fe fe-chevron-down"})]),this._v(" "),a("div",{staticClass:"h1 m-0"},[this._v("\n              10d\n            ")]),this._v(" "),a("div",{staticClass:"text-muted mb-4"},[this._v("\n              运行时间\n            ")])])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n              攻击趋势\n            ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n                  TOP 10 攻击UA\n                ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n                  TOP 10 攻击类型\n                ")])])}]},V=e("VU/8")(T,H,!1,null,null,null).exports,Y=e("fZjL"),X=e.n(Y),B=e("mvHQ"),J=e.n(B),W=e("PJh5"),Q=e.n(W),K={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",["3001"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            配置文件路径\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.config_file)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            问题描述\n        ")]),t._v(" "),t._m(0)]):t._e(),t._v(" "),"3005"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            配置文件路径\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.config_file)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            问题描述\n        ")]),t._v(" "),t._m(1)]):t._e(),t._v(" "),"3007"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            配置文件路径\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.config_file)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            问题描述\n        ")]),t._v(" "),t._m(2)]):t._e(),t._v(" "),"3002"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            进程 PID\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.pid)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            问题描述\n        ")]),t._v(" "),t._m(3)]):t._e(),t._v(" "),"3003"==t.data.policy_id?e("div",[t.data.policy_params.config_file?e("div",[e("div",{staticClass:"h6"},[t._v("\n                配置文件路径\n            ")]),t._v(" "),e("p",[t._v("\n                "+t._s(t.data.policy_params.config_file)+"\n            ")])]):t._e(),t._v(" "),t.data.policy_params.hostname&&t.data.policy_params.port?e("div",[e("div",{staticClass:"h6"},[t._v("\n                服务器信息\n            ")]),t._v(" "),e("p",[t._v("\n                "+t._s(t.data.policy_params.hostname)+":"+t._s(t.data.policy_params.port)+"\n            ")])]):t._e(),t._v(" "),t.data.policy_params.socket?e("div",[e("div",{staticClass:"h6"},[t._v("\n                服务器信息\n            ")]),t._v(" "),e("p",[t._v("\n                "+t._s(t.data.policy_params.socket)+"\n            ")])]):t._e(),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            弱口令\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.username)+":"+t._s(t.data.policy_params.password)+"\n        ")]),t._v(" "),t.data.stack_trace&&t.data.stack_trace.length?e("div",[e("div",{staticClass:"h6"},[t._v("\n                应用堆栈\n            ")]),t._v(" "),e("pre",[t._v(t._s(t.data.stack_trace))])]):t._e(),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            问题描述\n        ")]),t._v(" "),t.data.policy_params.server?e("p",[t._v("\n            "+t._s(t.data.policy_params.server)+" 存在弱口令，若账号被爆破会有数据泄露风险。\n            "),e("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3003",target:"_blank"}},[t._v("点击这里")]),t._v("了解更多。\n        ")]):t.data.policy_params.type?e("p",[t._v("\n            "+t._s(t.data.policy_params.type)+" 存在弱口令。\n            "),e("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3003",target:"_blank"}},[t._v("点击这里")]),t._v("了解更多。\n        ")]):e("p",[t._v("\n            Tomcat 管理后台存在弱口令，若管理后台对外暴露，会有被入侵的风险。\n            "),e("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3003",target:"_blank"}},[t._v("点击这里")]),t._v("了解更多。\n        ")])]):t._e(),t._v(" "),"3004"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            webapps 路径\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.path)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            未删除的默认应用列表\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.apps.join(", "))+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            问题描述\n        ")]),t._v(" "),t._m(4)]):t._e(),t._v(" "),"3006"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            数据库类型\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.server)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            用户名\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.username)+"\n        ")]),t._v(" "),t.data.policy_params.connectionString?e("div",{staticClass:"h6"},[t._v("\n            connectionString\n        ")]):t._e(),t._v(" "),t.data.policy_params.connectionString?e("p",[t._v("\n            "+t._s(t.data.policy_params.connectionString)+"\n        ")]):t._e(),t._v(" "),t.data.policy_params.socket?e("div",{staticClass:"h6"},[t._v("\n            UNIX socket 路径\n        ")]):t._e(),t._v(" "),t.data.policy_params.socket?e("p",[t._v("\n            "+t._s(t.data.policy_params.socket)+"\n        ")]):t._e(),t._v(" "),t.data.stack_trace&&t.data.stack_trace.length?e("div",[e("div",{staticClass:"h6"},[t._v("\n                应用堆栈\n            ")]),t._v(" "),e("pre",[t._v(t._s(t.data.stack_trace))])]):t._e(),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            问题描述\n        ")]),t._v(" "),t._m(5)]):t._e(),t._v(" "),"3009"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            问题描述\n        ")]),t._v(" "),t._m(6),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            Web 根目录\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.webroot)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            敏感文件列表\n        ")]),t._v(" "),e("ul",t._l(t.data.policy_params.files,function(a,s){return e("li",{key:s},[t._v("\n                "+t._s(a)+"\n            ")])}),0)]):t._e(),t._v(" "),"4001"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            问题描述\n        ")]),t._v(" "),t._m(7)]):t._e(),t._v(" "),"4002"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            问题描述\n        ")]),t._v(" "),t._m(8)]):t._e(),t._v(" "),"4003"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            问题描述\n        ")]),t._v(" "),t._m(9)]):t._e(),t._v(" "),"4004"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            问题描述\n        ")]),t._v(" "),t._m(10)]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            JSESSIONID 未开启 httpOnly，若开启可提升服务器对XSS的防范效果。\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3001",target:"_blank"}},[this._v("点击这里")]),this._v("了解更多。\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            开启 Directory Listing 功能，可能会泄露项目代码、配置等敏感信息。\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3005",target:"_blank"}},[this._v("点击这里")]),this._v("了解更多。\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            以 root/Administrator/system 权限启动应用服务器，会产生巨大的风险。\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3007",target:"_blank"}},[this._v("点击这里")]),this._v("了解更多。\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            以root权限启动应用服务器，会产生巨大的风险。\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3002",target:"_blank"}},[this._v("点击这里")]),this._v("了解更多。\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            没有删除 tomcat 默认的 app，或多或少会泄露敏感信息，或者造成管理后台对外暴露的风险。\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3004",target:"_blank"}},[this._v("点击这里")]),this._v("了解更多。\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            当存在SQL注入漏洞，使用高权限账号连接数据库会带来更大风险，泄露更多的数据。\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3004",target:"_blank"}},[this._v("点击这里")]),this._v("了解更多。\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            Web 根目录下存在压缩包或者其他敏感文件。若被外界下载，可能造成源代码、网站备份泄露，加大网站被入侵的风险。\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3009",target:"_blank"}},[this._v("点击这里")]),this._v("了解更多。\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            allow_url_include 没有关闭，当应用存在文件包含、任意文件读取等漏洞，开启这个配置会让应用更加容易被入侵。\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#4001",target:"_blank"}},[this._v("点击这里")]),this._v("了解更多。\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            expose_php 没有关闭，会泄露PHP版本号。\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#4002",target:"_blank"}},[this._v("点击这里")]),this._v("了解更多。\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            display_errors 没有关闭，用户可以在前台看到PHP程序的错误信息。\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#4002",target:"_blank"}},[this._v("点击这里")]),this._v("了解更多。\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            yaml.decode_php 没有关闭，将允许YAML反序列化PHP对象。若应用存在漏洞，可导致服务器被入侵。\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#4002",target:"_blank"}},[this._v("点击这里")]),this._v("了解更多。\n        ")])}]},G={name:"baselineDetailModal",data:function(){return{tabIndex:0,tabs:["报警信息","资产信息"],data:{}}},methods:{exportJSON:function(){x("policy.json",J()(this.data,null,2))},showModal:function(t){this.tabIndex=0,this.data=t,this.$refs.baseline_params.setData(t),$("#showBaselineDetailModal").modal()}},components:{baseline_params:e("VU/8")({name:"baseline_params",data:function(){return{data:{policy_params:{}}}},methods:{setData:function(t){this.data=t,t.policy_params||(t.policy_params={}),!t.stack_trace&&t.policy_params.stack&&(t.stack_trace=t.policy_params.stack.join("\n"))}}},K,!1,null,null,null).exports}},Z={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"showBaselineDetailModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),e("div",{staticClass:"modal-body",staticStyle:{"padding-top":"0"}},[e("ul",{staticClass:"nav nav-tabs",attrs:{id:"myTab",role:"tablist"}},t._l(t.tabs,function(a,s){return e("li",{key:s,staticClass:"nav-item"},[e("a",{class:{"nav-link":!0,active:t.tabIndex==s},attrs:{href:"javascript:"},on:{click:function(a){t.tabIndex=s}}},[t._v("\n              "+t._s(a)+"\n            ")])])}),0),t._v(" "),e("br"),t._v(" "),e("div",{staticClass:"tab-content",attrs:{id:"myTabContent"}},[e("div",{class:{"tab-pane":!0,fade:!0,show:0==t.tabIndex,active:0==t.tabIndex}},[e("div",{staticClass:"h6"},[t._v("\n              报警时间\n            ")]),t._v(" "),e("p",[t._v(t._s(t.moment(t.data.event_time).format("YYYY-MM-DD HH:mm:ss")))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              报警消息\n            ")]),t._v(" "),e("p",[t._v("\n              ["+t._s(t.data.policy_id)+"] "+t._s(t.data.message)+"\n            ")]),t._v(" "),e("baseline_params",{ref:"baseline_params"})],1),t._v(" "),e("div",{class:{"tab-pane":!0,fade:!0,show:1==t.tabIndex,active:1==t.tabIndex}},[e("div",{staticClass:"h6"},[t._v("\n              主机名称\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.server_hostname))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              服务器 IP\n            ")]),t._v(" "),e("ul",t._l(t.data.server_nic,function(a){return e("li",{key:a.name},[t._v(t._s(a.name)+": "+t._s(a.ip))])}),0),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              RASP 版本\n            ")]),t._v(" "),e("p",[t._v("\n              "+t._s(t.data.rasp_version)+"\n            ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              RASP ID\n            ")]),t._v(" "),e("p",[t._v("\n              "+t._s(t.data.rasp_id)+"\n            ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              应用版本\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.server_type)+"/"+t._s(t.data.server_version))])])])]),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-primary mr-auto",on:{click:function(a){return t.exportJSON()}}},[t._v("\n          导出\n        ")]),t._v(" "),e("button",{staticClass:"btn btn-primary",attrs:{"data-dismiss":"modal"}},[t._v("\n          关闭\n        ")])])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[this._v("基线详情")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])}]},tt=e("VU/8")(G,Z,!1,null,null,null).exports,at=(e("PL/P"),{name:"DatePicker",data:function(){return{start:Q()().subtract(1,"months").startOf("day"),end:Q()().endOf("day")}},mounted:function(){var t=this;window.$(this.$refs.daterangepicker).daterangepicker({startDate:this.start,endDate:this.end},function(a,e,s){t.start=a,t.end=e,t.$emit("selected"),t.$emit("change",{start:a,end:e})})}}),et={render:function(){var t=this.$createElement;return(this._self._c||t)("input",{ref:"daterangepicker",staticClass:"form-control",staticStyle:{width:"210px"},attrs:{type:"text",name:"daterange",autocomplete:"off"}})},staticRenderFns:[]},st=e("VU/8")(at,et,!1,null,null,null).exports,nt=(e("RiEM"),{name:"Baseline",components:{baselineDetailModal:tt,DatePicker:st},data:function(){return{data:[],loading:!1,currentPage:1,hostname:"",total:0,baseline_types:h,message:"",selected:X()(h)}},computed:D()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.loadEvents(1)},selected:function(){this.loadEvents(1)}},mounted:function(){this.current_app.id&&this.loadEvents(1)},methods:{ceil:Math.ceil,selectAll:function(t){var a=t.target;this.selected=a.checked?X()(this.baseline_types):[]},showBaselineDetailModal:function(t){this.$refs.baselineDetailModal.showModal(t)},loadEvents:function(t){var a=this,e={data:{app_id:this.current_app.id,start_time:this.$refs.datePicker.start.valueOf(),end_time:this.$refs.datePicker.end.valueOf(),policy_id:this.selected,message:this.message},page:t,perpage:10};return this.hostname&&(e.data.server_hostname=this.hostname),this.loading=!0,this.request.post("v1/api/log/policy/search",e).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})}}}),it={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header"},[e("h1",{staticClass:"page-title"},[t._v("\n        基线检查\n      ")]),t._v(" "),e("div",{staticClass:"page-options d-flex"},[e("div",{staticClass:"input-icon ml-2"},[t._m(0),t._v(" "),e("DatePicker",{ref:"datePicker",on:{selected:function(a){return t.loadEvents(1)}}})],1),t._v(" "),e("b-dropdown",{staticClass:"ml-2",attrs:{text:"基线类型",left:""}},[e("b-container",{staticStyle:{width:"500px"}},[e("b-form-row",[e("b-col",[e("label",{staticClass:"custom-switch"},[e("input",{staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:""},on:{change:t.selectAll}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                    全选\n                  ")])])]),t._v(" "),e("div",{staticClass:"w-100"}),t._v(" "),t._l(t.baseline_types,function(a,s,n){return[e("b-col",{key:s},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.selected)?t._i(t.selected,s)>-1:t.selected},on:{change:function(a){var e=t.selected,n=a.target,i=!!n.checked;if(Array.isArray(e)){var r=s,l=t._i(e,r);n.checked?l<0&&(t.selected=e.concat([r])):l>-1&&(t.selected=e.slice(0,l).concat(e.slice(l+1)))}else t.selected=i}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                      "+t._s(a)+"\n                    ")])])]),t._v(" "),n%2==1?e("div",{staticClass:"w-100"}):t._e()]})],2)],1)],1),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(1),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.hostname,expression:"hostname",modifiers:{trim:!0}}],staticClass:"form-control w-10",attrs:{type:"text",placeholder:"搜索主机或者IP"},domProps:{value:t.hostname},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.hostname=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(2),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.message,expression:"message",modifiers:{trim:!0}}],staticClass:"form-control w-10",attrs:{type:"text",placeholder:"过滤消息"},domProps:{value:t.message},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.message=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("button",{staticClass:"btn btn-primary ml-2",on:{click:function(a){return t.loadEvents(1)}}},[t._v("\n          搜索\n        ")])],1)]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("vue-loading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadEvents(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-hover table-bordered"},[t._m(3),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.id},[e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(t.moment(a.event_time).format("YYYY-MM-DD"))+"\n                "),e("br"),t._v("\n                "+t._s(t.moment(a.event_time).format("HH:mm:ss"))+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(a.server_type)+"/"+t._s(a.server_version)+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(a.server_hostname)+"\n              ")]),t._v(" "),e("td",[t._v("\n                ["+t._s(a.policy_id)+"] "+t._s(a.message)+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.showBaselineDetailModal(a)}}},[t._v("\n                  查看详情\n                ")])])])}),0)]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadEvents(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),t.loading||0!=t.total?t._e():e("p",{staticClass:"text-center"},[t._v("暂无数据")])],1)])]),t._v(" "),e("baselineDetailModal",{ref:"baselineDetailModal"})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-calendar"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",{attrs:{nowrap:""}},[t._v("\n                报警时间\n              ")]),t._v(" "),e("th",{attrs:{nowrap:""}},[t._v("\n                应用信息\n              ")]),t._v(" "),e("th",{attrs:{nowrap:""}},[t._v("\n                主机信息\n              ")]),t._v(" "),e("th",[t._v("\n                报警内容\n              ")]),t._v(" "),e("th",[t._v("\n                操作\n              ")])])])}]},rt=e("VU/8")(nt,it,!1,null,null,null).exports,lt={name:"CrashDetailModal",data:function(){return{tabIndex:0,data:{url:"",stack_md5:"",stack_trace:""}}},methods:{showModal:function(t){this.tabIndex=0,this.data=t,this.data.stack_trace=t.crash_log.replace(/(^\s*)|(\s*$)/g,""),$("#showCrashDetailModal").modal()},env2str:function(t){var a="";for(var e in t)a=a+e+"="+t[e]+"\n";return a}}},ot={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"showCrashDetailModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),e("div",{staticClass:"modal-body",staticStyle:{"padding-top":"0","padding-bottom":"0"}},[t._m(1),t._v(" "),e("br"),t._v(" "),e("div",{staticClass:"tab-content",attrs:{id:"myTabContent"}},[e("div",{staticClass:"tab-pane fade show active",attrs:{id:"crash",role:"tabpanel","aria-labelledby":"crash-tab"}},[e("pre",{staticStyle:{"max-height":"400px","overflow-y":"scroll"}},[t._v(t._s(t.data.stack_trace))])]),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{id:"basic",role:"tabpanel","aria-labelledby":"home-tab"}},[e("div",{staticClass:"h6"},[t._v("\n              主机名称\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.hostname))]),t._v(" "),t.data.host_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n                容器类型\n              ")]),t._v(" "),e("p",[t._v(t._s(t.data.host_type))])]):t._e(),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              注册时间\n            ")]),t._v(" "),e("p",[t._v(t._s(t.moment(1e3*t.data.register_time).format("YYYY-MM-DD HH:mm:ss")))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              注册 IP\n            ")]),t._v(" "),e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n              "+t._s(t.data.register_ip)+"\n            ")]),t._v(" "),t.data.environ&&0!=Object.keys(t.data.environ).length?e("div",[e("div",{staticClass:"h6"},[t._v("\n                环境变量\n              ")]),t._v(" "),e("pre",[t._v(t._s(t.env2str(t.data.environ)))])]):t._e()]),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{id:"profile",role:"tabpanel","aria-labelledby":"profile-tab"}},[e("div",{staticClass:"h6"},[t._v("\n              服务器版本\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.language)+"/"+t._s(t.data.language_version))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              Agent 版本\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.version))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              插件版本\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.plugin_version))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              RASP ID\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.id))])])])]),t._v(" "),t._m(2)])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[this._v("\n          崩溃详情\n        ")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])},function(){var t=this.$createElement,a=this._self._c||t;return a("ul",{staticClass:"nav nav-tabs",attrs:{id:"myTab",role:"tablist"}},[a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link active",attrs:{id:"crash-tab","data-toggle":"tab",href:"#crash"}},[this._v("\n              原始日志\n            ")])]),this._v(" "),a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link",attrs:{id:"home-tab","data-toggle":"tab",href:"#basic"}},[this._v("\n              主机信息\n            ")])]),this._v(" "),a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link",attrs:{id:"profile-tab","data-toggle":"tab",href:"#profile"}},[this._v("\n              RASP 信息\n            ")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-primary",attrs:{"data-dismiss":"modal"}},[this._v("\n          关闭\n        ")])])}]},ct={name:"Crash",components:{CrashDetailModal:e("VU/8")(lt,ot,!1,null,null,null).exports,DatePicker:st},data:function(){return{data:[],language_list:[{name:"Java",value:"java"},{name:"PHP",value:"php"}],loading:!1,currentPage:1,hostname:"",rasp_id:"",selected_language:["java","php"],crash_message:"",total:0}},computed:D()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.loadEvents(1)},selected:function(){this.loadEvents(1)},selected_language:function(){this.loadEvents(1)}},mounted:function(){this.current_app.id&&this.loadEvents(1)},methods:{ceil:Math.ceil,displayURL:function(t){return t.url?t.url.length>100?t.url.substring(0,100)+" ...":t.url:"-"},selectAll:function(t){var a=t.target;this.selected=a.checked?X()(this.attack_types):[]},showEventDetail:function(t){this.$refs.crashDetailModal.showModal(t)},loadEvents:function(t){var a=this;return this.loading=!0,this.request.post("v1/api/log/crash/search",{data:{start_time:this.$refs.datePicker.start.valueOf(),end_time:this.$refs.datePicker.end.valueOf(),app_id:this.current_app.id,hostname:this.hostname,language:this.selected_language,rasp_id:this.rasp_id,crash_message:this.crash_message},page:t,perpage:10}).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})}}},dt={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header",staticStyle:{"flex-direction":"column",display:"flex"}},[e("div",{staticStyle:{display:"flex","flex-direction":"row","justify-content":"flex-start",width:"100%"}},[e("h1",{staticClass:"page-title",staticStyle:{"padding-top":"3px"}},[t._v("\n          崩溃信息\n        ")]),t._v(" "),e("div",{staticClass:"page-options d-flex",staticStyle:{"margin-top":"5px"}},[e("div",{staticClass:"input-icon ml-2"},[t._m(0),t._v(" "),e("DatePicker",{ref:"datePicker",on:{selected:function(a){return t.loadEvents(1)}}})],1),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(1),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.hostname,expression:"hostname",modifiers:{trim:!0}}],staticClass:"form-control w-10",attrs:{type:"text",placeholder:"主机名称"},domProps:{value:t.hostname},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.hostname=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(2),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.crash_message,expression:"crash_message",modifiers:{trim:!0}}],staticClass:"form-control w-10",staticStyle:{width:"210px"},attrs:{type:"text",placeholder:"报警信息"},domProps:{value:t.crash_message},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.crash_message=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("button",{staticClass:"btn btn-primary ml-2",staticStyle:{height:"38px"},on:{click:function(a){return t.loadEvents(1)}}},[t._v("\n            搜索\n          ")])])])]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("VueLoading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" /\n                "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadEvents(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-striped table-bordered"},[t._m(3),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.id},[e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(t.moment(a.event_time).format("YYYY-MM-DD"))+"\n                "),e("br"),t._v("\n                "+t._s(t.moment(a.event_time).format("HH:mm:ss"))+"\n              ")]),t._v(" "),e("td",[t._v("\n                "+t._s(a.hostname)+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(a.language)+"/"+t._s(a.version)+" "),e("br"),t._v("\n                "+t._s(a.plugin_name?a.plugin_name:"official")+"/"+t._s(a.plugin_version)+"\n              ")]),t._v(" "),e("td",[t._v("\n                "+t._s(a.rasp_home)+"\n              ")]),t._v(" "),e("td",{staticStyle:{"word-break":"break-word"}},[t._v("\n                "+t._s(a.crash_message)+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.showEventDetail(a)}}},[t._v("\n                  查看详情\n                ")])])])}),0)]),t._v(" "),t.loading||0!=t.total?t._e():e("p",{staticClass:"text-center"},[t._v("暂无数据")]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" /\n                "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadEvents(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e()],1)])]),t._v(" "),e("CrashDetailModal",{ref:"crashDetailModal"})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-calendar"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",[t._v("\n                最后发现时间\n              ")]),t._v(" "),e("th",{attrs:{nowrap:""}},[t._v("\n                主机名\n              ")]),t._v(" "),e("th",[t._v("\n                RASP 版本\n              ")]),t._v(" "),e("th",[t._v("\n                RASP 目录\n              ")]),t._v(" "),e("th",{attrs:{nowrap:""}},[t._v("\n                报警信息\n              ")]),t._v(" "),e("th",[t._v("\n                操作\n              ")])])])}]},_t=e("VU/8")(ct,dt,!1,null,null,null).exports,pt={name:"HostDetailModal",data:function(){return{data:{}}},methods:{showModal:function(t){this.data=t,$("#showHostDetailModal").modal()},env2str:function(t){var a="";for(var e in t)a=a+e+"="+t[e]+"\n";return a}}},vt={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"showHostDetailModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),e("div",{staticClass:"modal-body",staticStyle:{"padding-top":"0"}},[t._m(1),t._v(" "),e("br"),t._v(" "),e("div",{staticClass:"tab-content",attrs:{id:"myTabContent"}},[e("div",{staticClass:"tab-pane fade show active",attrs:{id:"basic",role:"tabpanel","aria-labelledby":"home-tab"}},[e("div",{staticClass:"h6"},[t._v("\n              主机名称\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.hostname))]),t._v(" "),t.data.host_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n                容器类型\n              ")]),t._v(" "),e("p",[t._v(t._s(t.data.host_type))])]):t._e(),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              注册时间\n            ")]),t._v(" "),e("p",[t._v(t._s(t.moment(1e3*t.data.register_time).format("YYYY-MM-DD HH:mm:ss")))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              注册 IP\n            ")]),t._v(" "),e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n              "+t._s(t.data.register_ip)+"\n            ")]),t._v(" "),t.data.environ&&0!=Object.keys(t.data.environ).length?e("div",[e("div",{staticClass:"h6"},[t._v("\n                环境变量\n              ")]),t._v(" "),e("pre",[t._v(t._s(t.env2str(t.data.environ)))])]):t._e()]),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{id:"profile",role:"tabpanel","aria-labelledby":"profile-tab"}},[e("div",{staticClass:"h6"},[t._v("\n              服务器版本\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.language)+"/"+t._s(t.data.language_version))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              Agent 版本\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.version))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              插件版本\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.plugin_version))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              RASP ID\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.id))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              RASP 目录\n            ")]),t._v(" "),e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n              "+t._s(t.data.rasp_home)+"\n            ")])])])]),t._v(" "),t._m(2)])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[this._v("\n          主机详情\n        ")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])},function(){var t=this.$createElement,a=this._self._c||t;return a("ul",{staticClass:"nav nav-tabs",attrs:{id:"myTab",role:"tablist"}},[a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link active",attrs:{id:"home-tab","data-toggle":"tab",href:"#basic"}},[this._v("\n              基础信息\n            ")])]),this._v(" "),a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link",attrs:{id:"profile-tab","data-toggle":"tab",href:"#profile",role:"tab"}},[this._v("\n              RASP 信息\n            ")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-primary",attrs:{"data-dismiss":"modal"}},[this._v("\n          关闭\n        ")])])}]},ut={name:"Hosts",components:{HostDetailModal:e("VU/8")(pt,vt,!1,null,null,null).exports},data:function(){return{data:[],loading:!1,currentVersion:"",agent_versions:[],currentPage:1,total:0,hostname:"",filter:{online:!0,offline:!0,language_java:!0,language_php:!0}}},computed:D()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.currentVersion="",this.loadRaspList(1)},currentVersion:function(){this.loadRaspList(1)},filter:{handler:function(){this.current_app.id&&(this.loadRaspList(1),localStorage.setItem("host_filter_status",J()(this.filter)))},deep:!0}},mounted:function(){try{var t=JSON.parse(localStorage.getItem("host_filter_status"));"boolean"==typeof t.online&&"boolean"==typeof t.offline&&"boolean"==typeof t.language_java&&"boolean"==typeof t.language_php&&(this.filter=t)}catch(t){}this.current_app.id&&this.loadRaspList(1)},methods:{ceil:Math.ceil,getHref:function(){return"/v1/api/rasp/csv?app_id="+this.current_app.id+"&version="+this.currentVersion+"&online="+this.filter.online+"&offline="+this.filter.offline+"&hostname="+this.hostname+"&language_java="+this.filter.language_java+"&language_php="+this.filter.language_php},enumAgentVersion:function(){var t=this,a={data:{app_id:this.current_app.id},page:1,perpage:10};this.filter.online&&!this.filter.offline?a.data.online=!0:!this.filter.online&&this.filter.offline&&(a.data.online=!1),this.filter.language_java&&!this.filter.language_php?a.data.language="java":!this.filter.language_java&&this.filter.language_php&&(a.data.language="php"),this.request.post("v1/api/rasp/search/version",a).then(function(a){t.agent_versions=a.data,0==t.agent_versions.length&&t.currentVersion&&t.agent_versions.push({version:t.currentVersion,count:0})})},toHostStatus:function(){return this.filter.online&&this.filter.offline?": 全部":this.filter.online||this.filter.offline?this.filter.online?": 仅在线":": 仅离线":""},toLanguageStatus:function(){return this.filter.language_java&&this.filter.language_php?": 全部":this.filter.language_java||this.filter.language_php?this.filter.language_java?": 仅 Java":": 仅 PHP":""},showHostDetail:function(t){this.$refs.showHostDetail.showModal(t)},loadRaspList:function(t){var a=this;if(!this.filter.online&&!this.filter.offline||!this.filter.language_java&&!this.filter.language_php)return this.currentPage=t,this.data=[],this.total=0,this.loading=!1,void(this.agent_versions=[]);this.enumAgentVersion();var e={data:{app_id:this.current_app.id},page:t,perpage:10};return this.currentVersion&&(e.data.version=this.currentVersion),this.hostname&&(e.data.hostname=this.hostname),this.filter.online&&!this.filter.offline?e.data.online=!0:!this.filter.online&&this.filter.offline&&(e.data.online=!1),this.filter.language_java&&!this.filter.language_php?e.data.language="java":!this.filter.language_java&&this.filter.language_php&&(e.data.language="php"),this.loading=!0,this.request.post("v1/api/rasp/search",e).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})},setComment:function(t){var a=this,e=t.description,s=prompt("输入新的备注",e);null!=s&&this.request.post("v1/api/rasp/describe",{id:t.id,description:s}).then(function(t){a.loadRaspList(a.currentPage)})},doDelete:function(t){var a=this;if(confirm("确认删除? 删除前请先在主机端卸载 OpenRASP Agent")){var e={id:t.id,app_id:this.current_app.id};this.request.post("v1/api/rasp/delete",e).then(function(){return a.loadRaspList(1)})}},deleteExpired:function(){var t=this;if(confirm("删除离线超过7天的主机？")){var a={app_id:this.current_app.id,expire_time:604800};this.request.post("v1/api/rasp/delete",a).then(function(){return t.loadRaspList(1)})}}}},mt={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header"},[e("h1",{staticClass:"page-title"},[t._v("\n        Agent 管理\n      ")]),t._v(" "),e("div",{staticClass:"page-options d-flex",staticStyle:{"margin-top":"5px"}},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.currentVersion,expression:"currentVersion"}],staticClass:"form-control",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.currentVersion=a.target.multiple?e:e[0]}}},[e("option",{attrs:{value:""}},[t._v("\n            版本: 全部\n          ")]),t._v(" "),t._l(t.agent_versions,function(a){return e("option",{key:a.version,domProps:{value:a.version}},[t._v("\n            版本: "+t._s(a.version)+" ("+t._s(a.count)+")\n          ")])})],2)]),t._v(" "),e("div",{staticClass:"page-options d-flex",staticStyle:{"margin-top":"5px","margin-left":"10px"}},[e("div",[e("b-dropdown",{attrs:{text:"状态"+t.toHostStatus()}},[e("div",{staticClass:"row px-2"},[e("div",{staticClass:"col-6"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.online,expression:"filter.online"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"filter.online"},domProps:{checked:Array.isArray(t.filter.online)?t._i(t.filter.online,null)>-1:t.filter.online},on:{change:[function(a){var e=t.filter.online,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.filter,"online",e.concat([null])):i>-1&&t.$set(t.filter,"online",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.filter,"online",n)},function(a){return t.$emit("selected")}]}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                    在线\n                  ")])])]),t._v(" "),e("div",{staticClass:"col-6"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.offline,expression:"filter.offline"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"filter.offline"},domProps:{checked:Array.isArray(t.filter.offline)?t._i(t.filter.offline,null)>-1:t.filter.offline},on:{change:[function(a){var e=t.filter.offline,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.filter,"offline",e.concat([null])):i>-1&&t.$set(t.filter,"offline",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.filter,"offline",n)},function(a){return t.$emit("selected")}]}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                    离线\n                  ")])])])])]),t._v(" "),e("b-dropdown",{staticStyle:{"margin-left":"10px"},attrs:{text:"语言"+t.toLanguageStatus()}},[e("div",{staticClass:"row px-2"},[e("div",{staticClass:"col-6"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.language_java,expression:"filter.language_java"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"filter.language_java"},domProps:{checked:Array.isArray(t.filter.language_java)?t._i(t.filter.language_java,null)>-1:t.filter.language_java},on:{change:[function(a){var e=t.filter.language_java,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.filter,"language_java",e.concat([null])):i>-1&&t.$set(t.filter,"language_java",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.filter,"language_java",n)},function(a){return t.$emit("selected")}]}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                    Java\n                  ")])])]),t._v(" "),e("div",{staticClass:"col-6"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.language_php,expression:"filter.language_php"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"filter.language_php"},domProps:{checked:Array.isArray(t.filter.language_php)?t._i(t.filter.language_php,null)>-1:t.filter.language_php},on:{change:[function(a){var e=t.filter.language_php,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.filter,"language_php",e.concat([null])):i>-1&&t.$set(t.filter,"language_php",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.filter,"language_php",n)},function(a){return t.$emit("selected")}]}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                    PHP\n                  ")])])])])])],1),t._v(" "),e("div",{staticClass:"input-icon ml-3"},[t._m(0),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.hostname,expression:"hostname",modifiers:{trim:!0}}],staticClass:"form-control w-10",attrs:{type:"text",placeholder:"主机名/备注/RASP目录/IP/OS"},domProps:{value:t.hostname},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadRaspList(1)},input:function(a){a.target.composing||(t.hostname=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("button",{staticClass:"btn btn-primary ml-2",on:{click:function(a){return t.loadRaspList(1)}}},[t._v("\n          搜索\n        ")]),t._v(" "),e("a",{staticClass:"btn btn-primary ml-2",attrs:{href:t.getHref(),target:"_blank"}},[t._v("\n          导出\n        ")]),t._v(" "),e("button",{staticClass:"btn btn-info ml-2",on:{click:function(a){return t.deleteExpired()}}},[t._v("\n          清理\n        ")])])]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("vue-loading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadRaspList(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-hover table-bordered"},[t._m(1),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.id},[e("td",{staticStyle:{"min-width":"100px"}},[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.showHostDetail(a)}}},[t._v(t._s(a.hostname))]),t._v(" "),a.description?e("span",[e("br"),t._v("["+t._s(a.description)+"]")]):t._e()]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(a.register_ip)+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(a.language)+"/"+t._s(a.version)+" "),e("br"),t._v("\n                "+t._s(a.plugin_name?a.plugin_name:"official")+"/"+t._s(a.plugin_version)+"\n              ")]),t._v(" "),e("td",[t._v("\n                "+t._s(a.rasp_home)+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(t.moment(1e3*a.last_heartbeat_time).format("YYYY-MM-DD"))+" "),e("br"),t._v("\n                "+t._s(t.moment(1e3*a.last_heartbeat_time).format("HH:mm:ss"))+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[a.online?t._e():e("span",{staticClass:"text-danger"},[t._v("\n                  离线\n                ")]),t._v(" "),a.online?e("span",[t._v("\n                  正常\n                ")]):t._e()]),t._v(" "),e("td",{attrs:{nowrap:""}},[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.setComment(a)}}},[t._v("\n                  备注\n                ")]),t._v(" "),a.online?t._e():e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.doDelete(a)}}},[t._v("\n                  删除\n                ")])])])}),0)]),t._v(" "),t.loading||0!=t.total?t._e():e("p",{staticClass:"text-center"},[t._v("暂无数据")]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadRaspList(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e()],1)])]),t._v(" "),e("HostDetailModal",{ref:"showHostDetail"})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",{attrs:{nowrap:""}},[t._v("\n                主机名\n              ")]),t._v(" "),e("th",[t._v("\n                注册 IP\n              ")]),t._v(" "),e("th",[t._v("\n                RASP 版本\n              ")]),t._v(" "),e("th",[t._v("\n                RASP 目录\n              ")]),t._v(" "),e("th",[t._v("\n                上次通信\n              ")]),t._v(" "),e("th",[t._v("\n                状态\n              ")]),t._v(" "),e("th",[t._v("\n                操作\n              ")])])])}]},ht=e("VU/8")(ut,mt,!1,null,null,null).exports,ft=e("woOf"),gt=e.n(ft),bt={name:"AlarmSettings",props:{data:{type:Object,default:function(){return{general_config:{"inject.custom_headers":{}},whitelist_config:[],email_alarm_conf:{recv_addr:[]},ding_alarm_conf:{recv_user:[],recv_party:[]},http_alarm_conf:{recv_addr:[]},kafka_alarm_conf:{},general_alarm_conf:{}}}}},data:function(){return{attack_types:f,sendMethods:{}}},computed:D()({},Object(c.c)(["current_app","sticky"])),watch:{data:function(t,a){this.loadAlarmMethod()}},beforeMount:function(){this.resetAlarmMethods(!1)},methods:{loadAlarmMethod:function(){var t=this,a=t.data.attack_type_alarm_conf;a?(t.sendMethods.crash={},X()(t.sendMethods).forEach(function(e){t.sendMethods[e]={ding:!1,http:!1,email:!1},a[e].forEach(function(a){t.sendMethods[e][a]=!0})})):this.resetAlarmMethods(!1)},resetAlarmMethods:function(t,a){var e=this;e.sendMethods.crash={email:!0},X()(this.attack_types).forEach(function(a){e.sendMethods[a]||(e.sendMethods[a]={}),["email","ding","http"].forEach(function(s){e.sendMethods[a][s]=t})}),e.sendMethods=gt()({},e.sendMethods),a&&setTimeout(function(){return e.saveAlarmMethods()},500)},saveAlarmMethods:function(t){var a=this,e={app_id:a.current_app.id,attack_type_alarm_conf:{}};X()(a.sendMethods).forEach(function(t){var s=a.sendMethods[t];e.attack_type_alarm_conf[t]=[],X()(s).forEach(function(a){s[a]&&e.attack_type_alarm_conf[t].push(a)})}),this.request.post("v1/api/app/alarm/config",e).then(function(){alert("报警方式保存成功")})},saveSettings:function(t){if("syslog"===t){try{this.data.general_config["syslog.facility"]=parseInt(this.data.general_config["syslog.facility"])}catch(t){this.data.general_config["syslog.facility"]=null}return e="Syslog 报警设置保存成功",this.request.post("v1/api/app/general/config",{app_id:this.current_app.id,config:this.data.general_config}).then(function(){alert(e)})}var a={app_id:this.current_app.id},e="报警设置保存成功";switch(t){case"email":a.email_alarm_conf=this.data.email_alarm_conf,"string"==typeof a.email_alarm_conf.recv_addr&&(a.email_alarm_conf.recv_addr=a.email_alarm_conf.recv_addr.split(/\s*[,;]\s*/).filter(function(t){return!!t})),e="邮件报警设置保存成功";break;case"ding":a.ding_alarm_conf=this.data.ding_alarm_conf,"string"==typeof a.ding_alarm_conf.recv_user&&(a.ding_alarm_conf.recv_user=a.ding_alarm_conf.recv_user.split(/\s*[,;]\s*/).filter(function(t){return!!t})),"string"==typeof a.ding_alarm_conf.recv_party&&(a.ding_alarm_conf.recv_party=a.ding_alarm_conf.recv_party.split(/\s*[,;]\s*/).filter(function(t){return!!t})),e="钉钉报警设置保存成功";break;case"http":a.http_alarm_conf=this.data.http_alarm_conf,"string"==typeof a.http_alarm_conf.recv_addr&&(a.http_alarm_conf.recv_addr=[a.http_alarm_conf.recv_addr]),e="HTTP 推送设置保存成功";break;case"kafka":a.kafka_alarm_conf=this.data.kafka_alarm_conf,e="Kafka 推送设置保存成功";break;case"general":a.general_alarm_conf=this.data.general_alarm_conf,e="通用报警设置保存成功"}return this.request.post("v1/api/app/alarm/config",a).then(function(){alert(e)})},testSettings:function(t){var a=this;this.saveSettings(t).then(function(){return a.request.post("v1/api/app/"+t+"/test",{app_id:a.current_app.id})}).then(function(){return alert("发送成功")})}}},yt={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"card"},[t._m(0),t._v(" "),e("div",{staticClass:"card-body"},[t._l(t.attack_types,function(a,s){return e("div",{key:s},[e("div",{staticClass:"row",staticStyle:{"margin-top":"3px"}},[e("div",{staticClass:"col"},[e("label",{staticStyle:{"min-width":"220px"}},[t._v(t._s(a))])]),t._v(" "),e("div",{staticClass:"col"},[e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.sendMethods[s].email,expression:"sendMethods[name].email"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",value:"1"},domProps:{checked:Array.isArray(t.sendMethods[s].email)?t._i(t.sendMethods[s].email,"1")>-1:t.sendMethods[s].email},on:{change:function(a){var e=t.sendMethods[s].email,n=a.target,i=!!n.checked;if(Array.isArray(e)){var r=t._i(e,"1");n.checked?r<0&&t.$set(t.sendMethods[s],"email",e.concat(["1"])):r>-1&&t.$set(t.sendMethods[s],"email",e.slice(0,r).concat(e.slice(r+1)))}else t.$set(t.sendMethods[s],"email",i)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("邮件报警")])])]),t._v(" "),e("div",{staticClass:"col"},[e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.sendMethods[s].ding,expression:"sendMethods[name].ding"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",value:"1"},domProps:{checked:Array.isArray(t.sendMethods[s].ding)?t._i(t.sendMethods[s].ding,"1")>-1:t.sendMethods[s].ding},on:{change:function(a){var e=t.sendMethods[s].ding,n=a.target,i=!!n.checked;if(Array.isArray(e)){var r=t._i(e,"1");n.checked?r<0&&t.$set(t.sendMethods[s],"ding",e.concat(["1"])):r>-1&&t.$set(t.sendMethods[s],"ding",e.slice(0,r).concat(e.slice(r+1)))}else t.$set(t.sendMethods[s],"ding",i)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("钉钉报警")])])]),t._v(" "),e("div",{staticClass:"col"},[e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.sendMethods[s].http,expression:"sendMethods[name].http"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",value:"1"},domProps:{checked:Array.isArray(t.sendMethods[s].http)?t._i(t.sendMethods[s].http,"1")>-1:t.sendMethods[s].http},on:{change:function(a){var e=t.sendMethods[s].http,n=a.target,i=!!n.checked;if(Array.isArray(e)){var r=t._i(e,"1");n.checked?r<0&&t.$set(t.sendMethods[s],"http",e.concat(["1"])):r>-1&&t.$set(t.sendMethods[s],"http",e.slice(0,r).concat(e.slice(r+1)))}else t.$set(t.sendMethods[s],"http",i)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("HTTP 推送")])])])])])}),t._v(" "),e("div",[e("div",{staticClass:"row",staticStyle:{"margin-top":"3px"}},[t._m(1),t._v(" "),e("div",{staticClass:"col"},[e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.sendMethods.crash.email,expression:"sendMethods['crash'].email"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",value:"1"},domProps:{checked:Array.isArray(t.sendMethods.crash.email)?t._i(t.sendMethods.crash.email,"1")>-1:t.sendMethods.crash.email},on:{change:function(a){var e=t.sendMethods.crash.email,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,"1");s.checked?i<0&&t.$set(t.sendMethods.crash,"email",e.concat(["1"])):i>-1&&t.$set(t.sendMethods.crash,"email",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.sendMethods.crash,"email",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("邮件报警")])])]),t._v(" "),e("div",{staticClass:"col"}),t._v(" "),e("div",{staticClass:"col"})])])],2),t._v(" "),e("div",{class:{"card-footer":!0,"sticky-card-footer":t.sticky}},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(a){return t.saveAlarmMethods()}}},[t._v("\n        保存\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-info pull-right",attrs:{type:"submit"},on:{click:function(a){return t.resetAlarmMethods(!1,!0)}}},[t._v("\n        全部关闭\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-info pull-right",staticStyle:{"margin-right":"5px"},attrs:{type:"submit"},on:{click:function(a){return t.resetAlarmMethods(!0,!0)}}},[t._v("\n        全部打开\n      ")])])]),t._v(" "),e("div",{staticClass:"card"},[t._m(2),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          每隔多少秒发送一次报警（报警并非实时发送，而是每隔一段时间检查ES里是否有新报警）\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data.general_alarm_conf.alarm_check_interval,expression:"data.general_alarm_conf.alarm_check_interval",modifiers:{number:!0}}],staticClass:"form-control",attrs:{placeholder:"120"},domProps:{value:t.data.general_alarm_conf.alarm_check_interval},on:{input:function(a){a.target.composing||t.$set(t.data.general_alarm_conf,"alarm_check_interval",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})])]),t._v(" "),e("div",{staticClass:"card-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(a){return t.saveSettings("general")}}},[t._v("\n        保存\n      ")])])]),t._v(" "),e("div",{staticClass:"card"},[t._m(3),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          推送邮箱地址 - 逗号或者分号分隔\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.email_alarm_conf.recv_addr,expression:"data.email_alarm_conf.recv_addr",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:"user1@example.com; user2@example.com"},domProps:{value:t.data.email_alarm_conf.recv_addr},on:{input:function(a){a.target.composing||t.$set(t.data.email_alarm_conf,"recv_addr",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          报警标题\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.email_alarm_conf.subject,expression:"data.email_alarm_conf.subject",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.email_alarm_conf.subject},on:{input:function(a){a.target.composing||t.$set(t.data.email_alarm_conf,"subject",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          自定义 From 头信息\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.email_alarm_conf.from,expression:"data.email_alarm_conf.from",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.email_alarm_conf.from},on:{input:function(a){a.target.composing||t.$set(t.data.email_alarm_conf,"from",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          邮件服务器地址\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.email_alarm_conf.server_addr,expression:"data.email_alarm_conf.server_addr",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:"smtp.163.com:25",autocomplete:"off"},domProps:{value:t.data.email_alarm_conf.server_addr},on:{input:function(a){a.target.composing||t.$set(t.data.email_alarm_conf,"server_addr",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          邮箱账号\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.email_alarm_conf.username,expression:"data.email_alarm_conf.username"}],staticClass:"form-control",attrs:{type:"email",placeholder:"hello@163.com",autocomplete:"off"},domProps:{value:t.data.email_alarm_conf.username},on:{input:function(a){a.target.composing||t.$set(t.data.email_alarm_conf,"username",a.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          邮箱密码\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.email_alarm_conf.password,expression:"data.email_alarm_conf.password"}],staticClass:"form-control",attrs:{type:"password",autocomplete:"off"},domProps:{value:t.data.email_alarm_conf.password},on:{input:function(a){a.target.composing||t.$set(t.data.email_alarm_conf,"password",a.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.email_alarm_conf.enable,expression:"data.email_alarm_conf.enable"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"data.email_alarm_conf.enable"},domProps:{checked:Array.isArray(t.data.email_alarm_conf.enable)?t._i(t.data.email_alarm_conf.enable,null)>-1:t.data.email_alarm_conf.enable},on:{change:function(a){var e=t.data.email_alarm_conf.enable,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.email_alarm_conf,"enable",e.concat([null])):i>-1&&t.$set(t.data.email_alarm_conf,"enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.email_alarm_conf,"enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n            开启邮件报警\n          ")])]),t._v(" "),e("br"),t._v(" "),e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.email_alarm_conf.tls_enable,expression:"data.email_alarm_conf.tls_enable"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"data.email_alarm_conf.enable"},domProps:{checked:Array.isArray(t.data.email_alarm_conf.tls_enable)?t._i(t.data.email_alarm_conf.tls_enable,null)>-1:t.data.email_alarm_conf.tls_enable},on:{change:function(a){var e=t.data.email_alarm_conf.tls_enable,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.email_alarm_conf,"tls_enable",e.concat([null])):i>-1&&t.$set(t.data.email_alarm_conf,"tls_enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.email_alarm_conf,"tls_enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),t._m(4)])])]),t._v(" "),e("div",{staticClass:"card-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(a){return t.saveSettings("email")}}},[t._v("\n        保存\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-info pull-right",attrs:{type:"submit"},on:{click:function(a){return t.testSettings("email")}}},[t._v("\n        发送测试数据\n      ")])])]),t._v(" "),e("div",{staticClass:"card"},[t._m(5),t._v(" "),e("div",{staticClass:"alert alert-warning",staticStyle:{"margin-bottom":"0"}},[t._v("\n      点击「发送测试数据」时，后台会从当前应用里找出2条最新的报警，并发送到指定的地址\n    ")]),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"form-group"},[t._m(6),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.http_alarm_conf.recv_addr,expression:"data.http_alarm_conf.recv_addr",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:"http://myserver/myurl"},domProps:{value:t.data.http_alarm_conf.recv_addr},on:{input:function(a){a.target.composing||t.$set(t.data.http_alarm_conf,"recv_addr",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.http_alarm_conf.enable,expression:"data.http_alarm_conf.enable"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"data.http_alarm_conf.enable"},domProps:{checked:Array.isArray(t.data.http_alarm_conf.enable)?t._i(t.data.http_alarm_conf.enable,null)>-1:t.data.http_alarm_conf.enable},on:{change:function(a){var e=t.data.http_alarm_conf.enable,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.http_alarm_conf,"enable",e.concat([null])):i>-1&&t.$set(t.data.http_alarm_conf,"enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.http_alarm_conf,"enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n            开启报警推送\n          ")])])])]),t._v(" "),e("div",{staticClass:"card-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(a){return t.saveSettings("http")}}},[t._v("\n        保存\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-info pull-right",attrs:{type:"submit"},on:{click:function(a){return t.testSettings("http")}}},[t._v("\n        发送测试数据\n      ")])])]),t._v(" "),e("div",{staticClass:"card"},[t._m(7),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"form-group"},[t._m(8),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.ding_alarm_conf.recv_user,expression:"data.ding_alarm_conf.recv_user",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.ding_alarm_conf.recv_user},on:{input:function(a){a.target.composing||t.$set(t.data.ding_alarm_conf,"recv_user",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          推送部门列表\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.ding_alarm_conf.recv_party,expression:"data.ding_alarm_conf.recv_party",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.ding_alarm_conf.recv_party},on:{input:function(a){a.target.composing||t.$set(t.data.ding_alarm_conf,"recv_party",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          Corp ID\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.ding_alarm_conf.corp_id,expression:"data.ding_alarm_conf.corp_id",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.ding_alarm_conf.corp_id},on:{input:function(a){a.target.composing||t.$set(t.data.ding_alarm_conf,"corp_id",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          Corp Secret\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.ding_alarm_conf.corp_secret,expression:"data.ding_alarm_conf.corp_secret",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.ding_alarm_conf.corp_secret},on:{input:function(a){a.target.composing||t.$set(t.data.ding_alarm_conf,"corp_secret",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          Agent ID\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.ding_alarm_conf.agent_id,expression:"data.ding_alarm_conf.agent_id",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.ding_alarm_conf.agent_id},on:{input:function(a){a.target.composing||t.$set(t.data.ding_alarm_conf,"agent_id",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.ding_alarm_conf.enable,expression:"data.ding_alarm_conf.enable"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"data.ding_alarm_conf.enable"},domProps:{checked:Array.isArray(t.data.ding_alarm_conf.enable)?t._i(t.data.ding_alarm_conf.enable,null)>-1:t.data.ding_alarm_conf.enable},on:{change:function(a){var e=t.data.ding_alarm_conf.enable,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.ding_alarm_conf,"enable",e.concat([null])):i>-1&&t.$set(t.data.ding_alarm_conf,"enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.ding_alarm_conf,"enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n            开启钉钉推送\n          ")])])])]),t._v(" "),e("div",{staticClass:"card-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(a){return t.saveSettings("ding")}}},[t._v("\n        保存\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-info pull-right",attrs:{type:"submit"},on:{click:function(a){return t.testSettings("ding")}}},[t._v("\n        发送测试数据\n      ")])])]),t._v(" "),e("div",{staticClass:"card"},[t._m(9),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"form-group"},[t._m(10),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.general_config["syslog.url"],expression:"data.general_config['syslog.url']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:"tcp://1.1.1.1:6666"},domProps:{value:t.data.general_config["syslog.url"]},on:{input:function(a){a.target.composing||t.$set(t.data.general_config,"syslog.url",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          Facility\n        ")]),t._v(" "),e("b-form-input",{staticClass:"form-control",attrs:{type:"number"},model:{value:t.data.general_config["syslog.facility"],callback:function(a){t.$set(t.data.general_config,"syslog.facility",a)},expression:"data.general_config['syslog.facility']"}})],1),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          Tag\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.general_config["syslog.tag"],expression:"data.general_config['syslog.tag']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.general_config["syslog.tag"]},on:{input:function(a){a.target.composing||t.$set(t.data.general_config,"syslog.tag",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.general_config["syslog.enable"],expression:"data.general_config['syslog.enable']"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"data.general_config['syslog.enable']"},domProps:{checked:Array.isArray(t.data.general_config["syslog.enable"])?t._i(t.data.general_config["syslog.enable"],null)>-1:t.data.general_config["syslog.enable"]},on:{change:function(a){var e=t.data.general_config["syslog.enable"],s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.general_config,"syslog.enable",e.concat([null])):i>-1&&t.$set(t.data.general_config,"syslog.enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.general_config,"syslog.enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n            开启 syslog 日志\n          ")])])])]),t._v(" "),e("div",{staticClass:"card-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(a){return t.saveSettings("syslog")}}},[t._v("\n        保存\n      ")])])]),t._v(" "),e("div",{staticClass:"card"},[t._m(11),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          服务器地址\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.kafka_alarm_conf.url,expression:"data.kafka_alarm_conf['url']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:"127.0.0.1:6666"},domProps:{value:t.data.kafka_alarm_conf.url},on:{input:function(a){a.target.composing||t.$set(t.data.kafka_alarm_conf,"url",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          Topic\n        ")]),t._v(" "),e("b-form-input",{staticClass:"form-control",attrs:{type:"text",placeholder:"your_topic"},model:{value:t.data.kafka_alarm_conf.topic,callback:function(a){t.$set(t.data.kafka_alarm_conf,"topic",a)},expression:"data.kafka_alarm_conf['topic']"}})],1),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          kafka 用户名（可选）\n        ")]),t._v(" "),e("b-form-input",{staticClass:"form-control",attrs:{type:"text"},model:{value:t.data.kafka_alarm_conf.user,callback:function(a){t.$set(t.data.kafka_alarm_conf,"user",a)},expression:"data.kafka_alarm_conf['user']"}})],1),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          kafka 密码（可选）\n        ")]),t._v(" "),e("b-form-input",{staticClass:"form-control",attrs:{type:"text"},model:{value:t.data.kafka_alarm_conf.pwd,callback:function(a){t.$set(t.data.kafka_alarm_conf,"pwd",a)},expression:"data.kafka_alarm_conf['pwd']"}})],1),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.kafka_alarm_conf.enable,expression:"data.kafka_alarm_conf['enable']"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.data.kafka_alarm_conf.enable)?t._i(t.data.kafka_alarm_conf.enable,null)>-1:t.data.kafka_alarm_conf.enable},on:{change:function(a){var e=t.data.kafka_alarm_conf.enable,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.kafka_alarm_conf,"enable",e.concat([null])):i>-1&&t.$set(t.data.kafka_alarm_conf,"enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.kafka_alarm_conf,"enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n            开启 Kafka 日志推送\n          ")])])])]),t._v(" "),e("div",{staticClass:"card-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(a){return t.saveSettings("kafka")}}},[t._v("\n        保存\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-info pull-right",attrs:{type:"submit"},on:{click:function(a){return t.testSettings("kafka")}}},[t._v("\n        发送测试数据\n      ")])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n        报警类型配置\n      ")]),this._v(" "),a("div",{staticClass:"card-options"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col"},[a("label",{staticStyle:{"min-width":"220px"}},[this._v("客户端崩溃（v1.2.3 新增功能）")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n        报警通用配置(全局配置，对所有应用生效)\n      ")]),this._v(" "),a("div",{staticClass:"card-options"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n        邮件报警\n      ")]),this._v(" "),a("div",{staticClass:"card-options"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"custom-switch-description"},[this._v("\n            强制开启 TLS "),a("a",{attrs:{target:"_blank",href:"https://rasp.baidu.com/doc/setup/panel.html#email-alarm"}},[this._v("[帮助文档]")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n        HTTP 报警推送\n      ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",{staticClass:"form-label"},[this._v("\n          HTTP/HTTPS URL "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/setup/log/main.html#format",target:"_blank"}},[this._v("[推送数据格式说明]")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n        钉钉集成\n      ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",{staticClass:"form-label"},[this._v("\n          推送用户列表 - 逗号或者分号分隔\n          "),a("a",{attrs:{target:"_blank",href:"https://rasp.baidu.com/doc/setup/panel.html#dingding-alarm"}},[this._v("\n            [帮助文档]\n          ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n        Syslog 报警配置（Agent 推送）\n      ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",{staticClass:"form-label"},[this._v("\n          服务器地址\n          "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/setup/others.html#common-syslog",target:"_blank"}},[this._v("\n            [帮助文档]\n          ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n        Kafka 报警推送（后台推送，Kafka版本号应大于等于0.8）\n      ")])])}]},kt=e("VU/8")(bt,yt,!1,null,null,null).exports,Ct={name:"AppEditModal",data:function(){return{data:{},is_edit:!1}},methods:{showModal:function(t,a){this.data=JSON.parse(J()(t)),this.is_edit=a,$("#appEditModal").modal(),this.$refs.name.focus()},saveApp:function(){var t={data:this.data,is_edit:this.is_edit};this.$emit("save",t)}}},wt={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"appEditModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"form-group"},[e("label",[t._v("应用名称")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.name,expression:"data.name",modifiers:{trim:!0}}],ref:"name",staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.name},on:{input:function(a){a.target.composing||t.$set(t.data,"name",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",[t._v("应用备注")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.description,expression:"data.description",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.description},on:{input:function(a){a.target.composing||t.$set(t.data,"description",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",[t._v("应用语言")]),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.data.language,expression:"data.language"}],staticClass:"form-control",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.data,"language",a.target.multiple?e:e[0])}}},[e("option",{attrs:{value:"java"}},[t._v("\n              java\n            ")]),t._v(" "),e("option",{attrs:{value:"php"}},[t._v("\n              php\n            ")])])])]),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{"data-dismiss":"modal"},on:{click:function(a){return t.saveApp()}}},[t._v("\n          保存\n        ")]),t._v(" "),e("button",{staticClass:"btn btn-info",attrs:{"data-dismiss":"modal"}},[t._v("\n          关闭\n        ")])])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[this._v("\n          添加/编辑 应用\n        ")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])}]},xt={name:"AppSettings",components:{appEditModal:e("VU/8")(Ct,wt,!1,null,null,null).exports},data:function(){return{data:[],loading:!1,total:0,currentPage:1}},computed:D()({},Object(c.c)(["current_app","app_list"])),watch:{current_app:function(){this.loadApps(1)}},mounted:function(){this.current_app.id=this.$route.params.app_id,this.current_app.id&&this.loadApps(1)},methods:D()({},Object(c.b)(["loadAppList"]),Object(c.d)(["setCurrentApp"]),{loadApps:function(t){var a=this;return this.loading=!0,this.request.post("v1/api/app/get",{page:t,perpage:10}).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})},deleteApp:function(t){var a=this;if(confirm("确认操作"))return this.request.post("v1/api/app/delete",{id:t.id}).then(function(){var e=t.id===a.current_app.id?a.app_list.find(function(a){return a.id!==t.id}):a.current_app;a.loadApps(1),a.loadAppList(e.id)})},editApp:function(t,a){this.$refs.appEditModal.showModal({app_id:t.id,name:t.name,language:t.language,description:t.description},a)},onEdit:function(t){var a=this,e=t.is_edit,s=t.data;this.request.post(e?"v1/api/app/config":"v1/api/app",s).then(function(){a.loadApps(e?1:a.currentPage),a.loadAppList(a.current_app.id)})}})},$t={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"card"},[t._m(0),t._v(" "),e("div",{staticClass:"card-body"},[t.loading?e("vue-loading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-bordered table-hover"},[t._m(1),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.id},[e("td",{staticStyle:{"min-width":"100px"}},[t._v("\n              "+t._s(a.name)+"\n            ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n              "+t._s(a.language)+"\n            ")]),t._v(" "),e("td",[t._v("\n              "+t._s(a.description)+"\n            ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return e.preventDefault(),t.setCurrentApp(a)}}},[t._v("\n                切换\n              ")]),t._v(" "),e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.editApp(a,!0)}}},[t._v("\n                编辑\n              ")]),t._v(" "),e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.deleteApp(a)}}},[t._v("\n                删除\n              ")])])])}),0)]),t._v(" "),t.loading?t._e():e("nav",[e("b-pagination",{attrs:{align:"center","total-rows":t.total,"per-page":10},on:{change:t.loadApps},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1)],1),t._v(" "),e("div",{staticClass:"card-footer text-right"},[e("div",{staticClass:"d-flex"},[e("button",{staticClass:"btn btn-primary",on:{click:function(a){return t.editApp({language:"java"})}}},[t._v("\n          添加\n        ")]),t._v(" "),e("a",{staticClass:"btn btn-primary pull-right",staticStyle:{"margin-left":"auto"},attrs:{href:"v1/api/app/export",target:"_blank"}},[t._v("\n          导出\n        ")])])])]),t._v(" "),e("appEditModal",{ref:"appEditModal",on:{save:function(a){return t.onEdit(a)}}})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n        应用管理\n      ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("thead",[a("th",[this._v("\n            名称\n          ")]),this._v(" "),a("th",[this._v("\n            语言\n          ")]),this._v(" "),a("th",[this._v("\n            备注\n          ")]),this._v(" "),a("th",[this._v("\n            操作\n          ")])])}]},Pt=e("VU/8")(xt,$t,!1,null,null,null).exports,At={name:"AuthSettings",data:function(){return{data:[],total:0,currentPage:1,loading:!1,oldpass:"",newpass1:"",newpass2:""}},mounted:function(){this.loadTokens(1)},methods:{changePass:function(){this.oldpass.length>0&&this.newpass1.length>0&&this.newpass1==this.newpass2?this.request.post("v1/user/update",{old_password:this.oldpass,new_password:this.newpass1}).then(function(){alert("密码修改成功，点击确认重新登录"),location.href="/#/login"}):alert("两次密码输入不一致，请重新输入")},createToken:function(){var t=this,a=prompt("请输入备注信息");a&&a.length&&this.request.post("v1/api/token",{description:a}).then(function(){t.loadTokens(1)})},editToken:function(t){var a=this,e=prompt("请输入新的备注信息");e&&this.request.post("v1/api/token",{description:e,token:t.token}).then(function(){a.loadTokens(1)})},deleteToken:function(t){var a=this;if(confirm("删除 "+t.token+" 吗")){var e={token:t.token};this.request.post("v1/api/token/delete",e).then(function(){a.loadTokens(1)})}},loadTokens:function(t){var a=this;return this.loading=!0,this.request.post("v1/api/token/get",{page:t,perpage:10}).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})}}},St={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"card"},[t._m(0),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          原密码\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.oldpass,expression:"oldpass"}],staticClass:"form-control",attrs:{type:"password",autocomplete:"off"},domProps:{value:t.oldpass},on:{input:function(a){a.target.composing||(t.oldpass=a.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          新密码\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.newpass1,expression:"newpass1"}],staticClass:"form-control",attrs:{type:"password",autocomplete:"off"},domProps:{value:t.newpass1},on:{input:function(a){a.target.composing||(t.newpass1=a.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          再次输入新密码\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.newpass2,expression:"newpass2"}],staticClass:"form-control",attrs:{type:"password",autocomplete:"off"},domProps:{value:t.newpass2},on:{input:function(a){a.target.composing||(t.newpass2=a.target.value)}}})])]),t._v(" "),e("div",{staticClass:"card-footer text-right"},[e("div",{staticClass:"d-flex"},[e("button",{staticClass:"btn btn-primary",on:{click:function(a){return t.changePass()}}},[t._v("\n          保存\n        ")])])])]),t._v(" "),e("div",{staticClass:"card"},[t._m(1),t._v(" "),e("div",{staticClass:"card-body"},[t.loading?e("vue-loading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-striped table-bordered"},[t._m(2),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.token},[e("td",{attrs:{nowrap:""}},[t._v("\n              "+t._s(a.token)+"\n            ")]),t._v(" "),e("td",[t._v("\n              "+t._s(a.description)+"\n            ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.editToken(a)}}},[t._v("\n                编辑\n              ")]),t._v(" "),e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.deleteToken(a)}}},[t._v("\n                删除\n              ")])])])}),0)]),t._v(" "),t.loading?t._e():e("nav",[e("b-pagination",{attrs:{align:"center","total-rows":t.total,"per-page":10},on:{change:t.loadTokens},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1)],1),t._v(" "),e("div",{staticClass:"card-footer text-right"},[e("div",{staticClass:"d-flex"},[e("button",{staticClass:"btn btn-primary",on:{click:function(a){return t.createToken()}}},[t._v("\n          创建\n        ")])])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n        修改登录密码\n      ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n        TOKEN 管理 \n        "),a("a",{staticStyle:{color:"#467fcf"},attrs:{href:"https://rasp.baidu.com/doc/hacking/cloud-api.html#panel-api-description",target:"_blank"}},[this._v("[帮助文档]")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("thead",[a("tr",[a("th",[this._v("\n              Token\n            ")]),this._v(" "),a("th",[this._v("\n              备注\n            ")]),this._v(" "),a("th",[this._v("\n              操作\n            ")])])])}]},jt=e("VU/8")(At,St,!1,null,null,null).exports,Et={name:"GeneralSettings",data:function(){return{weak_password_list:"",dependency_check:{min_interval:60,max_interval:86400},cpu_usage:{min_percent:30,max_percent:100,min_interval:1,max_interval:1800},sampler_interval:{close:0,min_period:60},data:{rasp_config:{}}}},computed:D()({},Object(c.c)(["current_app","sticky"])),methods:D()({},Object(c.d)(["setCurrentApp"]),{setData:function(t){this.data=t,this.data["security.weak_passwords"]&&(this.weak_password_list=this.data["security.weak_passwords"].join(","))},doSave:function(){if(this.data["log.maxstack"]=this.data["plugin.maxstack"],this.data["security.weak_passwords"]=b(this.weak_password_list,","),this.data["security.weak_passwords"].push(""),this.data["security.weak_passwords"].length>200)alert("为了降低内存占用，弱口令最多允许200条，当前数量 "+this.data["security.weak_passwords"].length+"条");else if(delete this.data["security.weak_password"],this.data["dependency_check.interval"]<this.dependency_check.min_interval||this.data["dependency_check.interval"]>this.dependency_check.max_interval)alert("采集任务间隔范围："+this.dependency_check.min_interval+"~"+this.dependency_check.max_interval);else if(this.data["cpu.usage.percent"]<this.cpu_usage.min_percent||this.data["cpu.usage.percent"]>this.cpu_usage.max_percent)alert("单核CPU占用率阈值："+this.cpu_usage.min_percent+"~"+this.cpu_usage.max_percent);else if(this.data["cpu.usage.interval"]<this.cpu_usage.min_interval||this.data["cpu.usage.interval"]>this.cpu_usage.max_interval)alert("单核CPU占用率采集间隔："+this.cpu_usage.min_interval+"~"+this.cpu_usage.max_interval);else if(this.data["response.sampler_interval"]<this.sampler_interval.min_period&&this.data["response.sampler_interval"]>this.sampler_interval.close)alert("采样周期最低60s");else if(this.data["offline_hosts.cleanup.interval"]<0)alert("离线主机清理时间必须大于0");else{var t={app_id:this.current_app.id,config:this.data};this.request.post("v1/api/app/general/config",t).then(function(){alert("保存成功")})}}})},Dt={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"card"},[t._m(0),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"form-group"},[t._m(1),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data["clientip.header"],expression:"data['clientip.header']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",maxlength:"100"},domProps:{value:t.data["clientip.header"]},on:{input:function(a){a.target.composing||t.$set(t.data,"clientip.header",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          自定义拦截状态码\n        ")]),t._v(" "),e("b-form-select",{attrs:{options:[200,302,403,404,500]},model:{value:t.data["block.status_code"],callback:function(a){t.$set(t.data,"block.status_code",t._n(a))},expression:"data['block.status_code']"}})],1),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          自定义拦截跳转页面 [仅自定义拦截状态码为302生效]\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data["block.redirect_url"],expression:"data['block.redirect_url']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data["block.redirect_url"]},on:{input:function(a){a.target.composing||t.$set(t.data,"block.redirect_url",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[t._m(2),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.data["block.content_html"],expression:"data['block.content_html']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data["block.content_html"]},on:{input:function(a){a.target.composing||t.$set(t.data,"block.content_html",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[t._m(3),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.data["block.content_xml"],expression:"data['block.content_xml']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data["block.content_xml"]},on:{input:function(a){a.target.composing||t.$set(t.data,"block.content_xml",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[t._m(4),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.data["block.content_json"],expression:"data['block.content_json']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data["block.content_json"]},on:{input:function(a){a.target.composing||t.$set(t.data,"block.content_json",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          最多读取 body 多少字节\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["body.maxbytes"],expression:"data['body.maxbytes']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0"},domProps:{value:t.data["body.maxbytes"]},on:{input:function(a){a.target.composing||t.$set(t.data,"body.maxbytes",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[t._m(5),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data["request.param_encoding"],expression:"data['request.param_encoding']"}],staticClass:"form-control",attrs:{type:"text",placeholder:""},domProps:{value:t.data["request.param_encoding"]},on:{input:function(a){a.target.composing||t.$set(t.data,"request.param_encoding",a.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          调试开关 [0表示关闭，1以上的值表示开启]\n        ")]),t._v(" "),e("b-form-select",{attrs:{options:[0,1]},model:{value:t.data["debug.level"],callback:function(a){t.$set(t.data,"debug.level",t._n(a))},expression:"data['debug.level']"}})],1),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          自动清理离线超过N天的主机 [0表示关闭，1以上的值表示开启；每天零点执行清理任务]\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["offline_hosts.cleanup.interval"],expression:"data['offline_hosts.cleanup.interval']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0",placeholder:"0"},domProps:{value:t.data["offline_hosts.cleanup.interval"]},on:{input:function(a){a.target.composing||t.$set(t.data,"offline_hosts.cleanup.interval",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          LRU 大小 [默认1000，若要关闭写 0]\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["lru.max_size"],expression:"data['lru.max_size']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0",placeholder:"1000"},domProps:{value:t.data["lru.max_size"]},on:{input:function(a){a.target.composing||t.$set(t.data,"lru.max_size",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          LRU 原始字符串上限 [若不开启只存储哈希；若开启同时存储原始字符串，若字符串超过上限直接进入插件检测；范围 1-102400]\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["lru.compare_limit"],expression:"data['lru.compare_limit']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0",placeholder:"10240"},domProps:{value:t.data["lru.compare_limit"]},on:{input:function(a){a.target.composing||t.$set(t.data,"lru.compare_limit",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [基线] 弱口令列表，适用于数据库、Tomcat管理后台等等；上限200个，单个最长16，逗号分隔\n        ")]),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.weak_password_list,expression:"weak_password_list",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:"111111,123,123123,123456,123456a,a123456,admin,both,manager,mysql,root,rootweblogic,tomcat,user,weblogic1,weblogic123,welcome1"},domProps:{value:t.weak_password_list},on:{input:function(a){a.target.composing||(t.weak_password_list=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [基线] [Web根目录敏感文件检查] 文件名正则，仅PHP支持，最长100字符\n        ")]),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.data["fileleak_scan.name"],expression:"data['fileleak_scan.name']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",maxlen:"100",placeholder:"\\.(git|svn|tar|gz|rar|zip|sql|log)$"},domProps:{value:t.data["fileleak_scan.name"]},on:{input:function(a){a.target.composing||t.$set(t.data,"fileleak_scan.name",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [基线] [Web根目录敏感文件检查] 扫描间隔（秒），范围 60-86400\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["fileleak_scan.interval"],expression:"data['fileleak_scan.interval']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",placeholder:"21600",min:"60"},domProps:{value:t.data["fileleak_scan.interval"]},on:{input:function(a){a.target.composing||t.$set(t.data,"fileleak_scan.interval",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [基线] [Web根目录敏感文件检查] 最多检测多少个文件，写 0 关闭这个功能\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["fileleak_scan.limit"],expression:"data['fileleak_scan.limit']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",placeholder:"100",min:"0"},domProps:{value:t.data["fileleak_scan.limit"]},on:{input:function(a){a.target.composing||t.$set(t.data,"fileleak_scan.limit",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [插件] 单个hook点最大执行时间（ms）\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["plugin.timeout.millis"],expression:"data['plugin.timeout.millis']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{min:"0",type:"number",placeholder:"100"},domProps:{value:t.data["plugin.timeout.millis"]},on:{input:function(a){a.target.composing||t.$set(t.data,"plugin.timeout.millis",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [插件] 传给插件的最大堆栈深度\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["plugin.maxstack"],expression:"data['plugin.maxstack']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0",placeholder:"100"},domProps:{value:t.data["plugin.maxstack"]},on:{input:function(a){a.target.composing||t.$set(t.data,"plugin.maxstack",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [日志] 每个进程/线程每秒钟最大日志条数\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["log.maxburst"],expression:"data['log.maxburst']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0",placeholder:"100"},domProps:{value:t.data["log.maxburst"]},on:{input:function(a){a.target.composing||t.$set(t.data,"log.maxburst",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [日志] 最大备份天数\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["log.maxbackup"],expression:"data['log.maxbackup']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0",placeholder:"30"},domProps:{value:t.data["log.maxbackup"]},on:{input:function(a){a.target.composing||t.$set(t.data,"log.maxbackup",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [熔断] 单核CPU占用率采集间隔（秒），范围 1-1800\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["cpu.usage.interval"],expression:"data['cpu.usage.interval']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"1",max:"1800",placeholder:"5"},domProps:{value:t.data["cpu.usage.interval"]},on:{input:function(a){a.target.composing||t.$set(t.data,"cpu.usage.interval",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [熔断] 单核CPU占用率阈值（百分比），范围 30-100\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["cpu.usage.percent"],expression:"data['cpu.usage.percent']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"30",max:"100",placeholder:"90"},domProps:{value:t.data["cpu.usage.percent"]},on:{input:function(a){a.target.composing||t.$set(t.data,"cpu.usage.percent",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [类库信息] 采集任务间隔（秒），范围 60-86400\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["dependency_check.interval"],expression:"data['dependency_check.interval']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"60",max:"86400",placeholder:"43200"},domProps:{value:t.data["dependency_check.interval"]},on:{input:function(a){a.target.composing||t.$set(t.data,"dependency_check.interval",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [响应检测] 采样周期（秒），设置为 0 关闭，最低 60\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["response.sampler_interval"],expression:"data['response.sampler_interval']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"60",placeholder:"60"},domProps:{value:t.data["response.sampler_interval"]},on:{input:function(a){a.target.composing||t.$set(t.data,"response.sampler_interval",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [响应检测] 在采样周期里，最多检测多少次，设置为 0 关闭\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["response.sampler_burst"],expression:"data['response.sampler_burst']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0",placeholder:"5"},domProps:{value:t.data["response.sampler_burst"]},on:{input:function(a){a.target.composing||t.$set(t.data,"response.sampler_burst",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data["cpu.usage.enable"],expression:"data['cpu.usage.enable']"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"data['cpu.usage.enable']"},domProps:{checked:Array.isArray(t.data["cpu.usage.enable"])?t._i(t.data["cpu.usage.enable"],null)>-1:t.data["cpu.usage.enable"]},on:{change:function(a){var e=t.data["cpu.usage.enable"],s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data,"cpu.usage.enable",e.concat([null])):i>-1&&t.$set(t.data,"cpu.usage.enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data,"cpu.usage.enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n            开启熔断保护:      当CPU占用持续超过某个值，关闭所有防护（仅 Java >= 1.2.1 支持）\n          ")])]),t._v(" "),e("br"),t._v(" "),e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data["plugin.filter"],expression:"data['plugin.filter']"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"data['plugin.filter']"},domProps:{checked:Array.isArray(t.data["plugin.filter"])?t._i(t.data["plugin.filter"],null)>-1:t.data["plugin.filter"]},on:{change:function(a){var e=t.data["plugin.filter"],s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data,"plugin.filter",e.concat([null])):i>-1&&t.$set(t.data,"plugin.filter",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data,"plugin.filter",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n            开启文件过滤器: 当文件不存在时不调用检测插件\n          ")])]),t._v(" "),e("br"),t._v(" "),e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data["decompile.enable"],expression:"data['decompile.enable']"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"data['decompile.enable']"},domProps:{checked:Array.isArray(t.data["decompile.enable"])?t._i(t.data["decompile.enable"],null)>-1:t.data["decompile.enable"]},on:{change:function(a){var e=t.data["decompile.enable"],s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data,"decompile.enable",e.concat([null])):i>-1&&t.$set(t.data,"decompile.enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data,"decompile.enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),t._m(6)]),t._v(" "),e("br"),t._v(" "),e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data["lru.compare_enable"],expression:"data['lru.compare_enable']"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"data['lru.compare_enable']"},domProps:{checked:Array.isArray(t.data["lru.compare_enable"])?t._i(t.data["lru.compare_enable"],null)>-1:t.data["lru.compare_enable"]},on:{change:function(a){var e=t.data["lru.compare_enable"],s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data,"lru.compare_enable",e.concat([null])):i>-1&&t.$set(t.data,"lru.compare_enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data,"lru.compare_enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n            开启 LRU 原始字符串比较（仅 Java >= 1.2.2 支持）\n          ")])])])]),t._v(" "),e("div",{class:{"card-footer":!0,"sticky-card-footer":t.sticky}},[e("div",{staticClass:"d-flex"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(a){return t.doSave()}}},[t._v("\n          保存\n        ")])])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n        通用设置\n      ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",{staticClass:"form-label"},[this._v("\n          真实 IP header\n          "),a("a",{attrs:{target:"_blank",href:"https://rasp.baidu.com/doc/setup/panel.html#reverse-proxy"}},[this._v("\n            [帮助文档]\n          ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",{staticClass:"form-label"},[this._v("\n          自定义HTML响应内容\n          "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/setup/others.html#common-block",target:"_blank"}},[this._v("\n            [帮助文档]\n          ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",{staticClass:"form-label"},[this._v("\n          自定义XML响应内容\n          "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/setup/others.html#common-block",target:"_blank"}},[this._v("\n            [帮助文档]\n          ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",{staticClass:"form-label"},[this._v("\n          自定义JSON响应内容\n          "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/setup/others.html#common-block",target:"_blank"}},[this._v("\n            [帮助文档]\n          ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",{staticClass:"form-label"},[this._v("\n          设置请求编码\n          "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/setup/others.html#common-others",target:"_blank"}},[this._v("\n            [帮助文档]\n          ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"custom-switch-description"},[this._v("\n            开启反汇编功能: 自动提取应用源代码\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/setup/panel.html#decompiler",target:"_blank"}},[this._v("\n              [帮助文档]\n            ")])])}]},Mt=e("VU/8")(Et,Dt,!1,null,null,null).exports,Nt=e("gRE1"),qt=e.n(Nt),Ut={name:"WhitelistSettings",data:function(){return{data:[],index:0,fields:[{key:"index",label:"#",tdAttr:{nowrap:""}},{key:"url",label:"URL"},{key:"hook",label:"检测点",tdAttr:{style:"min-width: 150px; "}},{key:"description",label:"备注"},{key:"command",label:"操作",tdAttr:{nowrap:""}}],modalData:{url:"",hook:{},description:""},attack_types:f}},computed:D()({},Object(c.c)(["current_app","sticky"])),mounted:function(){},methods:D()({},Object(c.d)(["setSticky"]),{whitelist2str:function(t){return X()(t).filter(function(a){return t[a]}).map(function(t){return C(t)}).join(", ")},setData:function(t){this.data=t},showModal:function(t){-1===t&&this.data.length>=200?alert("为了保证性能，白名单最多支持 200 条"):(this.setSticky(!1),this.index=t,gt()(this.modalData,JSON.parse(J()(this.data[t]||{}))),this.$refs.modal.show())},hideModal:function(t){if(!0===t){if(!this.modalData.url||0==this.modalData.url.trim().length)return void alert("URL 未填写");if(this.modalData.url.startsWith("http://")||this.modalData.url.startsWith("https://"))return void alert("URL 无需以 http/https 开头，请删除");if(qt()(this.modalData.hook).indexOf(!0)<0)return void alert("请至少选择一个 hook 点来加白名单");-1==this.index&&(this.index=this.data.length),this.$set(this.data,this.index,this.modalData)}this.modalData={url:"",hook:{},description:""},this.$refs.modal.hide(),this.setSticky(!0)},deleteItem:function(t){confirm("确认删除?")&&this.data.splice(t,1)},doSave:function(){return this.data.forEach(function(t){for(var a in t.hook)t.hook[a]||delete t.hook[a]}),this.request.post("v1/api/app/whitelist/config",{app_id:this.current_app.id,config:this.data}).then(function(){alert("保存成功")})}})},Rt={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"card"},[t._m(0),t._v(" "),e("div",{staticClass:"card-body"},[e("p",[t._v("最多允许200个URL，单条URL长度限制为200字符")]),t._v(" "),e("b-table",{attrs:{hover:"",bordered:"",items:t.data,fields:t.fields},scopedSlots:t._u([{key:"cell(index)",fn:function(a){return[t._v("\n          "+t._s(a.index+1)+"\n        ")]}},{key:"cell(hook)",fn:function(a){return[a.value.all?e("span",[t._v("\n            所有 Hook 点\n          ")]):t._e(),t._v(" "),a.value.all?t._e():e("span",[t._v("\n            "+t._s(t.whitelist2str(a.value))+"\n          ")])]}},{key:"cell(command)",fn:function(a){return[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.showModal(a.index)}}},[t._v("\n            编辑\n          ")]),t._v(" "),e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.deleteItem(a.index)}}},[t._v("\n            删除\n          ")])]}}])}),t._v(" "),0==t.data.length?e("p",{staticClass:"text-center"},[t._v("暂无数据")]):t._e()],1),t._v(" "),e("div",{class:{"card-footer":!0,"sticky-card-footer":t.sticky}},[e("button",{staticClass:"btn btn-info",on:{click:function(a){return t.showModal(-1)}}},[t._v("\n        添加\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-primary pull-right",on:{click:function(a){return t.doSave()}}},[t._v("\n        保存\n      ")])])]),t._v(" "),e("b-modal",{ref:"modal",attrs:{id:"whitelistEditModal","no-fade":"",title:"添加/编辑 白名单",size:"lg","hide-header-close":""},on:{hidden:function(a){return t.hideModal()},shown:function(a){return t.$refs.focus.focus()}}},[e("div",{staticClass:"form-group"},[e("label",[t._v("URL前缀 - 不区分 http/https，不支持通配符或者正则，格式如 "),e("span",{staticClass:"text-danger"},[t._v("rasp.baidu.com/phpmyadmin/")]),t._v("；若要匹配全部URL，请写 "),e("strong",[t._v("*")])]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.modalData.url,expression:"modalData.url",modifiers:{trim:!0}}],ref:"focus",staticClass:"form-control",attrs:{maxlength:"200",type:"text",maxlen:"200"},domProps:{value:t.modalData.url},on:{input:function(a){a.target.composing||t.$set(t.modalData,"url",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",[t._v("白名单备注（可选）")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.modalData.description,expression:"modalData.description",modifiers:{trim:!0}}],ref:"focus",staticClass:"form-control",attrs:{maxlength:"200",type:"text",maxlen:"200"},domProps:{value:t.modalData.description},on:{input:function(a){a.target.composing||t.$set(t.modalData,"description",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",[t._v("检测点")]),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.modalData.hook.all,expression:"modalData.hook.all"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.modalData.hook.all)?t._i(t.modalData.hook.all,null)>-1:t.modalData.hook.all},on:{change:function(a){var e=t.modalData.hook.all,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.modalData.hook,"all",e.concat([null])):i>-1&&t.$set(t.modalData.hook,"all",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.modalData.hook,"all",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n              关闭所有检测点\n            ")])])])]),t._v(" "),t.modalData.hook.all?t._e():e("div",{staticClass:"row"},t._l(t.attack_types,function(a,s){return e("div",{key:s,staticClass:"col-6"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.modalData.hook[s],expression:"modalData.hook[key]"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.modalData.hook[s])?t._i(t.modalData.hook[s],s)>-1:t.modalData.hook[s]},on:{change:function(a){var e=t.modalData.hook[s],n=a.target,i=!!n.checked;if(Array.isArray(e)){var r=s,l=t._i(e,r);n.checked?l<0&&t.$set(t.modalData.hook,s,e.concat([r])):l>-1&&t.$set(t.modalData.hook,s,e.slice(0,l).concat(e.slice(l+1)))}else t.$set(t.modalData.hook,s,i)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n              "+t._s(a)+"\n            ")])])])}),0)]),t._v(" "),e("div",{staticClass:"w-100",attrs:{slot:"modal-footer"},slot:"modal-footer"},[e("b-button",{staticClass:"float-right ml-2 btn-info",attrs:{variant:"default"},on:{click:function(a){return t.hideModal()}}},[t._v("\n        取消\n      ")]),t._v(" "),e("b-button",{staticClass:"float-right ml-2",attrs:{variant:"primary"},on:{click:function(a){return t.hideModal(!0)}}},[t._v("\n        确定\n      ")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n        防护引擎白名单\n      ")])])}]},Lt=e("VU/8")(Ut,Rt,!1,null,null,null).exports,Ot={name:"AlgorithmConfigModal",data:function(){return{key:"",data:{},shouldSave:!1,command_common_error:!1,sql_regex_error:!1,eval_regex_error:!1,protocol_concat:"",error_code_concat:"",deserialization_blacklist_concat:"",webshell_ld_preload_concat:"",ognl_blacklist_concat:"",sql_policy_keys:[{key:"stacked_query",descr:"拦截多语句执行，如 select ...; update ..."},{key:"no_hex",descr:"拦截16进制字符串，如 0x41424344"},{key:"version_comment",descr:"拦截版本号注释，如 select/*!500001,2,*/3"},{key:"function_blacklist",descr:"拦截黑名单函数，如 load_file、sleep、updatexml"},{key:"function_count",descr:"函数频次算法，如 chr(123)||chr(123)||chr(123)"},{key:"union_null",descr:"拦截连续3个NULL或者数字，如 select NULL,NULL,NULL"},{key:"into_outfile",descr:"拦截 into outfile 写文件操作"},{key:"information_schema",descr:"拦截 information_schema 相关操作"}],command_error_keys:[{key:"unbalanced_quote_enable",descr:"检查单双反引号的个数，是否为奇数"},{key:"sensitive_cmd_enable",descr:"检查恶意的命令拼接操作，如 | bash"},{key:"alarm_token_enable",descr:"检查恶意的 TOKEN，如 $IFS"}],xxe_disable_entity_keys:[{key:"java_dom",descr:"org.apache.xerces.parsers.DOMParser"},{key:"java_dom4j",descr:"org.dom4j.io.SAXReader"},{key:"java_jdom",descr:"org.jdom.input.SAXBuilder"},{key:"java_sax",descr:"org.apache.xerces.internal.jaxp.SAXParserImpl"},{key:"java_stax",descr:"javax.xml.stream.XMLInputFactory"}]}},watch:{"data.regex":function(t,a){"sql_regex"==this.key&&(this.sql_regex_error=this.validateRegex(t))},"data.pattern":function(t,a){"command_common"==this.key&&(this.command_common_error=this.validateRegex(t))}},computed:D()({},Object(c.c)(["current_app","app_list","sticky"])),mounted:function(){var t=this;$("#algorithmConfigModal").on("hidden.bs.modal",function(){t.setSticky(!0)})},methods:D()({},Object(c.d)(["setSticky"]),{validateRegex:y,showModal:function(t,a){this.setSticky(!1),this.key=t,this.data=JSON.parse(J()(a)),this.key.endsWith("_protocol")&&(this.protocol_concat=this.data.protocols.join(",")),"sql_exception"==this.key&&(this.error_code_concat=this.data.mysql.error_code.join(",")),"webshell_ld_preload"==this.key&&(this.webshell_ld_preload_concat=this.data.env.join("\n")),"deserialization_blacklist"==this.key&&(this.deserialization_blacklist_concat=this.data.clazz.join("\n")),"ognl_blacklist"==this.key&&(this.ognl_blacklist_concat=this.data.expression.join("\n")),$("#algorithmConfigModal").modal({})},saveConfig:function(){var t,a;"sql_exception"==this.key&&(this.data.mysql.error_code=(t=b(this.error_code_concat,","),a=[],t.forEach(function(t){a.push(parseInt(t))}),a.filter(function(t){return t}))),"deserialization_blacklist"==this.key&&(this.data.clazz=b(this.deserialization_blacklist_concat,"\n")),"ognl_blacklist"==this.key&&(this.data.expression=b(this.ognl_blacklist_concat,"\n")),this.key.endsWith("_protocol")&&(this.data.protocols=b(this.protocol_concat,","));var e={key:this.key,data:this.data};this.$emit("save",e)}})},It={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"algorithmConfigModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog modal-md",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),e("div",{staticClass:"modal-body"},["sql_userinput"==t.key?e("div",[e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.pre_enable,expression:"data.pre_enable"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.data.pre_enable)?t._i(t.data.pre_enable,null)>-1:t.data.pre_enable},on:{change:function(a){var e=t.data.pre_enable,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data,"pre_enable",e.concat([null])):i>-1&&t.$set(t.data,"pre_enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data,"pre_enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("开启关键词过滤: 有漏洞但是没有攻击时不报警")])]),t._v(" "),e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.allow_full,expression:"data.allow_full"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.data.allow_full)?t._i(t.data.allow_full,null)>-1:t.data.allow_full},on:{change:function(a){var e=t.data.allow_full,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data,"allow_full",e.concat([null])):i>-1&&t.$set(t.data,"allow_full",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data,"allow_full",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("允许数据库查询: 通过接口传递完整SQL语句并执行")])])]):t._e(),t._v(" "),"sql_policy"==t.key?e("div",t._l(t.sql_policy_keys,function(a){return e("div",{key:a.key},[e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.feature[a.key],expression:"data.feature[row.key]"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.data.feature[a.key])?t._i(t.data.feature[a.key],null)>-1:t.data.feature[a.key]},on:{change:function(e){var s=t.data.feature[a.key],n=e.target,i=!!n.checked;if(Array.isArray(s)){var r=t._i(s,null);n.checked?r<0&&t.$set(t.data.feature,a.key,s.concat([null])):r>-1&&t.$set(t.data.feature,a.key,s.slice(0,r).concat(s.slice(r+1)))}else t.$set(t.data.feature,a.key,i)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v(t._s(a.descr))])]),t._v(" "),e("br")])}),0):t._e(),t._v(" "),"command_error"==t.key?e("div",t._l(t.command_error_keys,function(a){return e("div",{key:a.key},[e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data[a.key],expression:"data[row.key]"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.data[a.key])?t._i(t.data[a.key],null)>-1:t.data[a.key]},on:{change:function(e){var s=t.data[a.key],n=e.target,i=!!n.checked;if(Array.isArray(s)){var r=t._i(s,null);n.checked?r<0&&t.$set(t.data,a.key,s.concat([null])):r>-1&&t.$set(t.data,a.key,s.slice(0,r).concat(s.slice(r+1)))}else t.$set(t.data,a.key,i)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v(t._s(a.descr))])]),t._v(" "),e("br")])}),0):t._e(),t._v(" "),"xxe_disable_entity"==t.key?e("div",[e("p",[t._v("将为以下类调用 setFeature() 函数，禁止外部实体加载。开启此选项可能会影响业务，请谨慎选择。")]),t._v(" "),t._l(t.xxe_disable_entity_keys,function(a){return e("div",{key:a.key},[e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data[a.key],expression:"data[row.key]"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.data[a.key])?t._i(t.data[a.key],null)>-1:t.data[a.key]},on:{change:function(e){var s=t.data[a.key],n=e.target,i=!!n.checked;if(Array.isArray(s)){var r=t._i(s,null);n.checked?r<0&&t.$set(t.data,a.key,s.concat([null])):r>-1&&t.$set(t.data,a.key,s.slice(0,r).concat(s.slice(r+1)))}else t.$set(t.data,a.key,i)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v(t._s(a.descr))])]),t._v(" "),e("br")])})],2):t._e(),t._v(" "),t.key.endsWith("_protocol")?e("div",[e("label",[t._v("禁止加载的协议列表，逗号分隔")]),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.protocol_concat,expression:"protocol_concat",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},domProps:{value:t.protocol_concat},on:{input:function(a){a.target.composing||(t.protocol_concat=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]):t._e(),t._v(" "),"eval_regex"==t.key?e("div",[e("label",[t._v("EVAL 语句正则表达式")]),t._v(" "),e("div",{class:{"form-group":!0,"has-error":t.eval_regex_error}},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.regex,expression:"data.regex",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.regex},on:{input:function(a){a.target.composing||t.$set(t.data,"regex",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),t.eval_regex_error?e("span",{staticClass:"text-danger"},[t._v(t._s(t.eval_regex_error))]):t._e()]):t._e(),t._v(" "),"sql_regex"==t.key?e("div",[e("label",[t._v("SQL语句正则表达式 - 在编写正则时，请注意防范ReDos风险")]),t._v(" "),e("div",{class:{"form-group":!0,"has-error":t.sql_regex_error}},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.regex,expression:"data.regex",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.regex},on:{input:function(a){a.target.composing||t.$set(t.data,"regex",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),t.sql_regex_error?e("span",{staticClass:"text-danger"},[t._v(t._s(t.sql_regex_error))]):t._e()]):t._e(),t._v(" "),"sql_exception"==t.key?e("div",[e("label",[t._v("SQL异常代码（逗号分隔；v1.2.1 之前不支持自定义错误代码）")]),t._v(" "),e("div",{staticClass:"form-group"},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.error_code_concat,expression:"error_code_concat",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.error_code_concat},on:{input:function(a){a.target.composing||(t.error_code_concat=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})])]):t._e(),t._v(" "),"webshell_ld_preload"==t.key?e("div",[e("label",[t._v("需要拦截的环境变量（一行一个）")]),t._v(" "),e("div",{staticClass:"form-group"},[e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.webshell_ld_preload_concat,expression:"webshell_ld_preload_concat",modifiers:{trim:!0}}],staticClass:"form-control",staticStyle:{"white-space":"nowrap"},attrs:{type:"text",autocorrect:"off",rows:"5"},domProps:{value:t.webshell_ld_preload_concat},on:{input:function(a){a.target.composing||(t.webshell_ld_preload_concat=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})])]):t._e(),t._v(" "),"deserialization_blacklist"==t.key?e("div",[e("label",[t._v("反序列化黑名单（一行一个）")]),t._v(" "),e("div",{staticClass:"form-group"},[e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.deserialization_blacklist_concat,expression:"deserialization_blacklist_concat",modifiers:{trim:!0}}],staticClass:"form-control",staticStyle:{"white-space":"nowrap"},attrs:{type:"text",autocorrect:"off",rows:"5"},domProps:{value:t.deserialization_blacklist_concat},on:{input:function(a){a.target.composing||(t.deserialization_blacklist_concat=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})])]):t._e(),t._v(" "),"ognl_blacklist"==t.key?e("div",[e("label",[t._v("OGNL语句黑名单（一行一个）")]),t._v(" "),e("div",{staticClass:"form-group"},[e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.ognl_blacklist_concat,expression:"ognl_blacklist_concat",modifiers:{trim:!0}}],staticClass:"form-control",staticStyle:{"white-space":"nowrap"},attrs:{type:"text",autocorrect:"off",rows:"5"},domProps:{value:t.ognl_blacklist_concat},on:{input:function(a){a.target.composing||(t.ognl_blacklist_concat=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})])]):t._e(),t._v(" "),"command_common"==t.key?e("div",[e("label",[t._v("渗透命令探针 - 正则表达式")]),t._v(" "),e("div",{class:{"form-group":!0,"has-error":t.command_common_error}},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.pattern,expression:"data.pattern",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.pattern},on:{input:function(a){a.target.composing||t.$set(t.data,"pattern",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),t.command_common_error?e("span",{staticClass:"text-danger"},[t._v(t._s(t.command_common_error))]):t._e()]):t._e(),t._v(" "),"response_dataLeak"==t.key?e("div",[e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.kind.phone,expression:"data.kind.phone"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.data.kind.phone)?t._i(t.data.kind.phone,null)>-1:t.data.kind.phone},on:{change:function(a){var e=t.data.kind.phone,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.kind,"phone",e.concat([null])):i>-1&&t.$set(t.data.kind,"phone",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.kind,"phone",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("检测手机号泄露")])]),t._v(" "),e("br"),t._v(" "),e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.kind.identity_card,expression:"data.kind.identity_card"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.data.kind.identity_card)?t._i(t.data.kind.identity_card,null)>-1:t.data.kind.identity_card},on:{change:function(a){var e=t.data.kind.identity_card,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.kind,"identity_card",e.concat([null])):i>-1&&t.$set(t.data.kind,"identity_card",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.kind,"identity_card",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("检测身份证泄露")])]),t._v(" "),e("br"),t._v(" "),e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.kind.bank_card,expression:"data.kind.bank_card"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.data.kind.bank_card)?t._i(t.data.kind.bank_card,null)>-1:t.data.kind.bank_card},on:{change:function(a){var e=t.data.kind.bank_card,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.kind,"bank_card",e.concat([null])):i>-1&&t.$set(t.data.kind,"bank_card",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.kind,"bank_card",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("检测银行卡、信用卡泄露")])])]):t._e()]),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-primary mr-auto",attrs:{"data-dismiss":"modal",disabled:t.sql_regex_error||t.command_common_error},on:{click:function(a){return t.saveConfig()}}},[t._v("\n          确定\n        ")]),t._v(" "),e("button",{staticClass:"btn btn-info",attrs:{"data-dismiss":"modal"}},[t._v("\n          取消\n        ")])])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[this._v("\n          高级选项\n        ")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])}]},zt={name:"AlgorithmSettings",data:function(){return{items:{},data:{meta:{}},byhost_regex_error:!1,hasAdvancedConfig:{command_common:!0,sql_userinput:!0,sql_policy:!0,sql_exception:!0,sql_regex:!0,eval_regex:!0,include_protocol:!0,xxe_protocol:!0,ssrf_protocol:!0,response_dataLeak:!0,command_error:!0,xxe_disable_entity:!0,deserialization_blacklist:!0,ognl_blacklist:!0,webshell_ld_preload:!0},browser_headers:m}},components:{AlgorithmConfigModal:e("VU/8")(Ot,It,!1,null,null,null).exports},computed:D()({},Object(c.c)(["current_app","sticky"])),watch:{current_app:function(){this.loadConfig()},"data.iast.byhost_regex":function(t,a){this.byhost_regex_error=this.validateRegex(t)}},mounted:function(){this.current_app.id&&this.loadConfig()},methods:D()({},Object(c.b)(["loadAppList"]),Object(c.d)(["setCurrentApp"]),{attack_type2name:C,validateRegex:y,showAdvancedConfig:function(t,a){this.$refs.algorithmConfigModal.showModal(t,a)},applyAdvancedConfig:function(t){if(t){var a=t.key;t=t.data;this.data[a]=t}},loadConfig:function(){if(this.current_app.selected_plugin_id.length){var t=this,a={id:this.current_app.selected_plugin_id};this.request.post("v1/api/plugin/get",a).then(function(a){var s=a.algorithm_config,n={};t.data=a.algorithm_config,X()(s).forEach(function(t){if(-1!=t.indexOf("_")){var a=t.split("_")[0];n[a]||(n[a]={name:a,items:[]}),n[a].items.push({name:s[t].name,key:t})}}),X()(n).forEach(function(t){n[t].items.sort(e)}),t.items=qt()(n),a.algorithm_config.sql_exception&&a.algorithm_config.sql_exception.mysql||(t.hasAdvancedConfig.sql_exception=!1),a.algorithm_config.webshell_ld_preload.env||(t.hasAdvancedConfig.webshell_ld_preload=!1)})}function e(t,a){return t.name.localeCompare(a.name)}},saveConfig:function(){var t=this,a={id:this.current_app.selected_plugin_id,config:this.data};this.request.post("v1/api/plugin/algorithm/config",a).then(function(){t.loadAppList(t.current_app.id),alert("保存成功，请等待一个心跳周期生效（3分钟以内，取决于客户端配置）")})},resetConfig:function(){var t=this;if(confirm("还原默认配置？")){var a={id:this.current_app.selected_plugin_id};this.request.post("v1/api/plugin/algorithm/restore",a).then(function(){t.loadAppList(t.current_app.id),t.loadConfig(),alert("恢复成功")})}}})},Ft={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"card"},[e("div",{staticClass:"card-header"},[e("h3",{staticClass:"card-title"},[t._v("\n        "+t._s(t.data.iast?"扫描设置":"防护设置")+"\n      ")])]),t._v(" "),t.current_app.selected_plugin_id&&t.current_app.selected_plugin_id.length?e("div",{staticClass:"card-body"},[t.data.iast?e("div",[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Fuzz 服务器地址")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.iast.fuzz_server,expression:"data.iast.fuzz_server"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.iast.fuzz_server},on:{input:function(a){a.target.composing||t.$set(t.data.iast,"fuzz_server",a.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Fuzz 服务器连接超时（毫秒）")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.iast.request_timeout,expression:"data.iast.request_timeout"}],staticClass:"form-control",attrs:{type:"number"},domProps:{value:t.data.iast.request_timeout},on:{input:function(a){a.target.composing||t.$set(t.data.iast,"request_timeout",a.target.value)}}})]),t._v(" "),e("div",{class:{"form-group":!0,"has-error":t.byhost_regex_error}},[t._m(0),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.iast.byhost_regex,expression:"data.iast.byhost_regex"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.iast.byhost_regex},on:{input:function(a){a.target.composing||t.$set(t.data.iast,"byhost_regex",a.target.value)}}}),t._v(" "),t.byhost_regex_error?e("span",{staticClass:"text-danger",staticStyle:{"margin-top":"5px",display:"block"}},[t._v(t._s(t.byhost_regex_error))]):t._e()])]):t._e(),t._v(" "),t.data.meta&&!t.data.iast?e("div",{staticClass:"form-group"},[e("div",{staticClass:"form-label"},[t._v("\n          快速设置\n        ")]),t._v(" "),e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.meta.all_log,expression:"data.meta.all_log"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",name:"custom-switch-checkbox"},domProps:{checked:Array.isArray(t.data.meta.all_log)?t._i(t.data.meta.all_log,null)>-1:t.data.meta.all_log},on:{change:function(a){var e=t.data.meta.all_log,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.meta,"all_log",e.concat([null])):i>-1&&t.$set(t.data.meta,"all_log",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.meta,"all_log",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v('\n            将所有算法设置为「记录日志」模式（"XXE 禁止外部实体加载" 算法除外）\n          ')])]),t._v(" "),e("br"),t._v(" "),e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.meta.is_dev,expression:"data.meta.is_dev"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",name:"custom-switch-checkbox"},domProps:{checked:Array.isArray(t.data.meta.is_dev)?t._i(t.data.meta.is_dev,null)>-1:t.data.meta.is_dev},on:{change:function(a){var e=t.data.meta.is_dev,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.meta,"is_dev",e.concat([null])):i>-1&&t.$set(t.data.meta,"is_dev",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.meta,"is_dev",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n            启动「研发模式」，开启一些消耗性能的检测算法\n          ")])]),t._v(" "),e("br"),t._v(" "),void 0!=t.data.meta.log_event?e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.meta.log_event,expression:"data.meta.log_event"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",name:"custom-switch-checkbox"},domProps:{checked:Array.isArray(t.data.meta.log_event)?t._i(t.data.meta.log_event,null)>-1:t.data.meta.log_event},on:{change:function(a){var e=t.data.meta.log_event,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.meta,"log_event",e.concat([null])):i>-1&&t.$set(t.data.meta,"log_event",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.meta,"log_event",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),t._m(1)]):t._e()]):t._e(),t._v(" "),t._l(t.items,function(a){return e("div",{key:a.name,staticClass:"form-group"},[e("div",{staticClass:"form-label"},[t._v("\n          "+t._s(t.attack_type2name(a.name))+"\n          "),"response"==a.name?e("span",[t._v("(该检测点不支持阻断，拦截攻击等同于记录日志)")]):t._e()]),t._v(" "),t._l(a.items,function(a){return e("div",{key:a.key},[e("form",{attrs:{disabled:"true"}},[e("div",{staticClass:"selectgroup"},[e("label",{staticClass:"selectgroup-item"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data[a.key].action,expression:"data[item.key].action"}],staticClass:"selectgroup-input",attrs:{type:"radio",name:"value",value:"block"},domProps:{checked:t._q(t.data[a.key].action,"block")},on:{change:function(e){return t.$set(t.data[a.key],"action","block")}}}),t._v(" "),e("span",{staticClass:"selectgroup-button"},[t._v("\n                  拦截攻击\n                ")])]),t._v(" "),e("label",{staticClass:"selectgroup-item"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data[a.key].action,expression:"data[item.key].action"}],staticClass:"selectgroup-input",attrs:{type:"radio",name:"value",value:"log"},domProps:{checked:t._q(t.data[a.key].action,"log")},on:{change:function(e){return t.$set(t.data[a.key],"action","log")}}}),t._v(" "),e("span",{staticClass:"selectgroup-button"},[t._v("\n                  记录日志\n                ")])]),t._v(" "),e("label",{staticClass:"selectgroup-item"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data[a.key].action,expression:"data[item.key].action"}],staticClass:"selectgroup-input",attrs:{type:"radio",name:"value",value:"ignore"},domProps:{checked:t._q(t.data[a.key].action,"ignore")},on:{change:function(e){return t.$set(t.data[a.key],"action","ignore")}}}),t._v(" "),e("span",{staticClass:"selectgroup-button"},[t._v("\n                  完全忽略\n                ")])])]),t._v(" "),e("p",{staticStyle:{display:"inline","margin-left":"10px"}},[t._v("\n              "+t._s(a.name)+"\n              "),t.data[a.key].reference?e("a",{attrs:{target:"_blank",href:t.data[a.key].reference}},[t._v("\n                [帮助文档]\n              ")]):t._e(),t._v(" "),t.hasAdvancedConfig[a.key]?e("a",{staticStyle:{color:"#B22222"},attrs:{href:"javascript:"},on:{click:function(e){return t.showAdvancedConfig(a.key,t.data[a.key])}}},[t._v("\n                [高级选项]\n              ")]):t._e()])])])})],2)})],2):e("div",{staticClass:"card-body"},[e("p",[t._v("\n        你还没有选择插件，请在「插件管理」中进行设置\n      ")])]),t._v(" "),t.current_app.selected_plugin_id&&t.current_app.selected_plugin_id.length?e("div",{class:{"card-footer":!0,"sticky-card-footer":t.sticky}},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:t.byhost_regex_error},on:{click:function(a){return t.saveConfig()}}},[t._v("\n        保存\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-info pull-right",attrs:{type:"submit"},on:{click:function(a){return t.resetConfig()}}},[t._v("\n        重置\n      ")])]):t._e()]),t._v(" "),e("AlgorithmConfigModal",{ref:"algorithmConfigModal",on:{save:t.applyAdvancedConfig}})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("label",{attrs:{for:""}},[this._v("使用 HOST 直接访问的服务（正则）"),a("a",{attrs:{target:"_blank",href:"https://rasp.baidu.com/doc/install/iast.html#faq-no-task"}},[this._v("[帮助文档]")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"custom-switch-description"},[this._v("\n            打印「行为日志」，仅用于调试，请勿在线上开启 \n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/setup/log/main.html#log-plugin",target:"_blank"}},[this._v("[帮助文档]")])])}]},Tt=e("VU/8")(zt,Ft,!1,null,null,null).exports,Ht={name:"HardeningSettings",data:function(){return{data:{"inject.custom_headers":{}},browser_headers:m}},computed:D()({},Object(c.c)(["current_app"])),methods:{setData:function(t){t["inject.custom_headers"]=t["inject.custom_headers"]||{},this.browser_headers.forEach(function(a){a.options.some(function(e){return e.value===t["inject.custom_headers"][a.name]})||a.options.push({name:t["inject.custom_headers"][a.name],value:t["inject.custom_headers"][a.name]})}),this.data=t},saveData:function(){var t=gt()(this.data);return"string"==typeof t["inject.custom_headers"]["X-Protected-By"]&&(t["inject.custom_headers"]["X-Protected-By"]=t["inject.custom_headers"]["X-Protected-By"].trim(),0==t["inject.custom_headers"]["X-Protected-By"].length&&(t["inject.custom_headers"]["X-Protected-By"]=void 0)),this.request.post("v1/api/app/general/config",{app_id:this.current_app.id,config:this.data}).then(function(){alert("保存成功")})}}},Vt={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("b-card",[e("div",{attrs:{slot:"header"},slot:"header"},[e("h3",{staticClass:"card-title"},[t._v("\n        应用加固\n      ")])]),t._v(" "),t._l(t.browser_headers,function(a){return e("div",{key:a.name,staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n        "+t._s(a.descr)+"\n        "),e("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/hardening.html#"+a.name,target:"_blank"}},[t._v("\n          [帮助文档]\n        ")])]),t._v(" "),e("div",{staticClass:"selectgroup"},t._l(a.options,function(s){return e("label",{key:s.name,staticClass:"selectgroup-item"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data["inject.custom_headers"][a.name],expression:"data['inject.custom_headers'][row.name]"}],staticClass:"selectgroup-input",attrs:{type:"radio",name:a.name},domProps:{value:s.value,checked:t._q(t.data["inject.custom_headers"][a.name],s.value)},on:{change:function(e){return t.$set(t.data["inject.custom_headers"],a.name,s.value)}}}),t._v(" "),e("span",{staticClass:"selectgroup-button"},[t._v("\n            "+t._s(s.name)+"\n          ")])])}),0)])}),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("自定义 X-Protected-By 头（要求 Agent 版本 >= 1.2.2，留空则不展示）\n        "),e("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/hardening.html#X-Protected-By",target:"_blank"}},[t._v("\n          [帮助文档]\n        ")])]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data["inject.custom_headers"]["X-Protected-By"],expression:"data['inject.custom_headers']['X-Protected-By']"}],staticClass:"form-control",attrs:{type:"text",maxlength:"200"},domProps:{value:t.data["inject.custom_headers"]["X-Protected-By"]},on:{input:function(a){a.target.composing||t.$set(t.data["inject.custom_headers"],"X-Protected-By",a.target.value)}}})]),t._v(" "),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("b-button",{attrs:{variant:"primary"},on:{click:t.saveData}},[t._v("\n        保存\n      ")])],1)],2)],1)},staticRenderFns:[]},Yt=e("VU/8")(Ht,Vt,!1,null,null,null).exports,Xt={name:"PanelSettings",data:function(){return{data:{panel_url:"",agent_url:[],agent_urls_text:""}}},computed:D()({},Object(c.c)(["current_app"])),mounted:function(){this.loadData()},methods:{loadData:function(t){var a=this;this.request.post("v1/api/server/url/get",{}).then(function(t){a.data=t,a.data.agent_urls_text=t.agent_urls.join("\n")})},parseAgentURL:function(){var t=[];return this.data.agent_urls_text.split("\n").forEach(function(a){(a=a.trim()).length&&t.push(a)}),t},saveData:function(){var t={panel_url:this.data.panel_url,agent_urls:this.parseAgentURL()};return this.request.post("v1/api/server/url",t).then(function(){alert("保存成功")})},removeLogs:function(){if(confirm("清空日志不可恢复，请确认")){var t={app_id:this.current_app.id};return this.request.post("v1/api/server/clear_logs",t).then(function(){alert("操作成功")})}}}},Bt={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("b-card",[e("div",{attrs:{slot:"header"},slot:"header"},[e("h3",{staticClass:"card-title"},[t._v("\n        后台设置\n      ")])]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n        管理后台地址 [用于生成邮件里的报警链接]\n      ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.panel_url,expression:"data.panel_url"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.panel_url},on:{input:function(a){a.target.composing||t.$set(t.data,"panel_url",a.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n        若开启"),e("a",{attrs:{href:"https://rasp.baidu.com/doc/install/panel.html#load-balance",target:"_blank"}},[t._v("负载均衡")]),t._v('，请填写 Agent 服务器列表 [用于生成 "添加主机" 里的安装命令，一行一个]\n      ')]),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.data.agent_urls_text,expression:"data.agent_urls_text"}],staticClass:"form-control",attrs:{type:"text",rows:"5"},domProps:{value:t.data.agent_urls_text},on:{input:function(a){a.target.composing||t.$set(t.data,"agent_urls_text",a.target.value)}}})]),t._v(" "),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("b-button",{attrs:{variant:"primary"},on:{click:t.saveData}},[t._v("\n        保存\n      ")])],1)]),t._v(" "),e("b-card",[e("div",{attrs:{slot:"header"},slot:"header"},[e("h3",{staticClass:"card-title"},[t._v("\n        清空数据\n      ")])]),t._v(" "),e("p",[t._v("点击执行后，会清空如下内容（"),e("strong",[t._v("仅当前应用")]),t._v("）")]),t._v(" "),e("ul",t._l(["攻击事件","基线报警","异常日志","请求数量","崩溃信息","类库信息"],function(a){return e("li",[t._v(t._s(a))])}),0),t._v(" "),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("b-button",{attrs:{variant:"danger"},on:{click:t.removeLogs}},[t._v("\n        执行\n      ")])],1)])],1)},staticRenderFns:[]},Jt=e("VU/8")(Xt,Bt,!1,null,null,null).exports,Wt=e("nYKV"),Qt=e.n(Wt),Kt={name:"Settings",components:{AlarmSettings:kt,WhitelistSettings:Lt,AppSettings:Pt,AuthSettings:jt,AlgorithmSettings:Tt,GeneralSettings:Mt,HardeningSettings:Yt,PanelSettings:Jt},data:function(){return{tab_names:["general","alarm","whitelist","algorithm","hardening","auth","app","panel"],tab_index:0,data:void 0,loading:!1}},computed:D()({},Object(c.c)(["current_app"]),{setting_tab:function(){return this.$route.params.setting_tab}}),watch:{current_app:function(){this.loadSettings()},setting_tab:"setTabIndex"},mounted:function(){this.setTabIndex(this.setting_tab),this.current_app.id&&this.loadSettings()},methods:{loadSettings:function(){var t=this;this.loading=!0,this.request.post("v1/api/app/get",{app_id:this.current_app.id}).then(function(a){t.loading=!1,t.data=Qt()({general_config:{"inject.custom_headers":{}},whitelist_config:[],email_alarm_conf:{recv_addr:[]},ding_alarm_conf:{recv_user:[],recv_party:[]},http_alarm_conf:{recv_addr:[]},kafka_alarm_conf:{},general_alarm_conf:{}},a),t.$refs.generalSettings.setData(t.data.general_config),t.$refs.hardeningSettings.setData(t.data.general_config),t.$refs.whitelistSettings.setData(t.data.whitelist_config)})},setTabIndex:function(t){this.tab_index=this.tab_names.indexOf(t)||0},onTabIndex:function(t){this.$router.push({params:{setting_tab:this.tab_names[t]}})}}},Gt={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("b-tabs",{staticClass:"w-100",attrs:{vertical:"","nav-wrapper-class":"col-3","no-fade":"","nav-class":"list-group list-group-transparent mx-0"},on:{input:t.onTabIndex},model:{value:t.tab_index,callback:function(a){t.tab_index=a},expression:"tab_index"}},[e("b-tab",{attrs:{"title-link-class":"list-group-item border-0 w-100","title-item-class":"px-0"}},[e("template",{slot:"title"},[e("span",{staticClass:"icon mr-3"},[e("i",{staticClass:"fe fe-settings"})]),t._v("\n          通用设置\n        ")]),t._v(" "),e("GeneralSettings",{ref:"generalSettings"})],2),t._v(" "),e("b-tab",{attrs:{"title-link-class":"list-group-item border-0 w-100","title-item-class":"px-0"}},[e("template",{slot:"title"},[e("span",{staticClass:"icon mr-3"},[e("i",{staticClass:"fe fe-alert-triangle"})]),t._v("\n          报警设置\n        ")]),t._v(" "),e("AlarmSettings",{ref:"alarmSettings",attrs:{data:t.data}})],2),t._v(" "),e("b-tab",{attrs:{"title-link-class":"list-group-item border-0 w-100","title-item-class":"px-0"}},[e("template",{slot:"title"},[e("span",{staticClass:"icon mr-3"},[e("i",{staticClass:"fe fe-list"})]),t._v("\n          黑白名单\n        ")]),t._v(" "),e("WhitelistSettings",{ref:"whitelistSettings"})],2),t._v(" "),e("b-tab",{attrs:{"title-link-class":"list-group-item border-0 w-100","title-item-class":"px-0"}},[e("template",{slot:"title"},[e("span",{staticClass:"icon mr-3"},[e("i",{staticClass:"fe fe-filter"})]),t._v("\n          防护设置\n        ")]),t._v(" "),e("AlgorithmSettings",{ref:"algorithmSettings"})],2),t._v(" "),e("b-tab",{attrs:{"title-link-class":"list-group-item border-0 w-100","title-item-class":"px-0"}},[e("template",{slot:"title"},[e("span",{staticClass:"icon mr-3"},[e("i",{staticClass:"fe fe-shield"})]),t._v("\n          应用加固\n        ")]),t._v(" "),e("HardeningSettings",{ref:"hardeningSettings"})],2),t._v(" "),e("b-tab",{attrs:{"title-link-class":"list-group-item border-0 w-100","title-item-class":"px-0"}},[e("template",{slot:"title"},[e("span",{staticClass:"icon mr-3"},[e("i",{staticClass:"fe fe-user"})]),t._v("\n          登录认证\n        ")]),t._v(" "),e("AuthSettings",{ref:"authSettings"})],2),t._v(" "),e("b-tab",{attrs:{"title-link-class":"list-group-item border-0 w-100","title-item-class":"px-0"}},[e("template",{slot:"title"},[e("span",{staticClass:"icon mr-3"},[e("i",{staticClass:"fe fe-server"})]),t._v("\n          应用管理\n        ")]),t._v(" "),e("AppSettings",{ref:"appSettings"})],2),t._v(" "),e("b-tab",{attrs:{"title-link-class":"list-group-item border-0 w-100","title-item-class":"px-0"}},[e("template",{slot:"title"},[e("span",{staticClass:"icon mr-3"},[e("i",{staticClass:"fe fe-settings"})]),t._v("\n          后台设置\n        ")]),t._v(" "),e("PanelSettings",{ref:"panelSettings"})],2)],1)],1)])},staticRenderFns:[]},Zt=e("VU/8")(Kt,Gt,!1,null,null,null).exports,ta={name:"FileUpload",data:function(){return{file:void 0}},mounted:function(){},methods:{clear:function(){this.$refs.fileInput.value="",this.file=void 0},handleFileChange:function(t,a){this.file=a[0],this.$emit("input",a[0])}},components:{}},aa={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"custom-file"},[e("input",{ref:"fileInput",staticClass:"custom-file-input",attrs:{type:"file"},on:{change:function(a){return t.handleFileChange(a.target.name,a.target.files)}}}),t._v(" "),t.file?e("label",{staticClass:"custom-file-label"},[t._v(t._s(t.file.name))]):t._e(),t._v(" "),t.file?t._e():e("label",{staticClass:"custom-file-label"},[t._v("选择插件")])])},staticRenderFns:[]},ea=e("VU/8")(ta,aa,!1,null,null,null).exports,sa={name:"Plugins",data:function(){return{currentPage:1,total:1,data:[],loading:!1}},computed:D()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.loadPluginList(1)}},mounted:function(){this.current_app.id&&this.loadPluginList(1)},methods:D()({},Object(c.b)(["loadAppList"]),{ceil:Math.ceil,loadPluginList:function(t){var a=this;return this.loading=!0,this.request.post("v1/api/app/plugin/get",{page:t,perpage:10,app_id:this.current_app.id}).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})},doUpload:function(){var t=this,a=this.$refs.fileUpload.file;if(a){var e=new FormData;e.append("plugin",a),this.request.post("v1/api/plugin?app_id="+this.current_app.id,e).then(function(){t.loadPluginList(1),t.$refs.fileUpload.clear()})}},doDelete:function(t){var a=this,e={id:t.id};confirm("确认删除?")&&this.request.post("v1/api/plugin/delete",e).then(function(){return a.loadPluginList(1)})},doSelect:function(t){var a=this;if(confirm("确认下发? 一个心跳周期后生效")){var e={app_id:this.current_app.id,plugin_id:t.id};this.request.post("v1/api/app/plugin/select",e).then(function(){return a.loadAppList(a.current_app.id)})}}}),components:{FileUpload:ea}},na={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header"},[e("h1",{staticClass:"page-title"},[t._v("\n        插件管理\n      ")]),t._v(" "),e("div",{staticClass:"page-options d-flex"},[e("FileUpload",{ref:"fileUpload"})],1),t._v(" "),e("button",{staticClass:"btn btn-primary ml-2",on:{click:function(a){return t.doUpload()}}},[t._v("\n        提交\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-info ml-2",on:{click:function(a){return t.loadPluginList(1)}}},[t._v("\n        刷新\n      ")])]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("vue-loading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:t.loadPluginList},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-bordered"},[t._m(0),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.id},[e("td",[t._v(t._s(t.moment(a.upload_time).format("YYYY-MM-DD HH:mm:ss")))]),t._v(" "),e("td",[t._v(t._s(a.name)+": "+t._s(a.version)+" \n                "),"official"==a.name?e("span",[t._v("(防护插件)")]):"iast"==a.name?e("span",[t._v("(扫描插件)")]):t._e()]),t._v(" "),e("td",[t.current_app.selected_plugin_id==a.id?e("span",[t._v("\n                  是\n                ")]):t._e()]),t._v(" "),e("td",[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.doSelect(a)}}},[t._v("\n                  推送\n                ")]),t._v("  \n                "),e("a",{attrs:{href:"/v1/api/plugin/download?id="+a.id,target:"_blank"}},[t._v("\n                  下载\n                ")]),t._v("  \n                "),e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.doDelete(a)}}},[t._v("\n                  删除\n                ")]),t._v("  \n                "),t.current_app.selected_plugin_id==a.id?e("router-link",{attrs:{to:{name:"settings",params:{setting_tab:"algorithm"}}}},[t._v("配置")]):t._e()],1)])}),0)]),t._v(" "),t.loading||0!=t.total?t._e():e("p",{staticClass:"text-center"},[t._v("暂无数据")]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:t.loadPluginList},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e()],1)])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("thead",[a("tr",[a("th",[this._v("上传时间")]),this._v(" "),a("th",[this._v("插件版本")]),this._v(" "),a("th",[this._v("当前版本")]),this._v(" "),a("th",[this._v("操作")])])])}]},ia=e("VU/8")(sa,na,!1,null,null,null).exports,ra={name:"Audit",data:function(){return{audit_types:u,data:[],loading:!1,currentPage:1,ip:"",total:0}},computed:D()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.loadAudit(1)}},mounted:function(){this.current_app.id&&this.loadAudit(1)},methods:{ceil:Math.ceil,loadAudit:function(t){var a=this;return this.loading=!0,this.request.post("v1/api/operation/search",{page:t,perpage:10,start_time:this.$refs.datePicker.start.valueOf(),end_time:this.$refs.datePicker.end.valueOf(),data:{app_id:this.current_app.id,ip:this.ip}}).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})}},components:{DatePicker:st}},la={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header"},[e("h1",{staticClass:"page-title"},[t._v("\n          操作审计\n        ")]),t._v(" "),e("div",{staticClass:"page-options d-flex"},[e("div",{staticClass:"input-icon ml-2"},[t._m(0),t._v(" "),e("DatePicker",{ref:"datePicker",on:{selected:function(a){return t.loadAudit(1)}}})],1),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(1),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.ip,expression:"ip",modifiers:{trim:!0}}],staticClass:"form-control w-10",attrs:{type:"text",placeholder:"搜索IP"},domProps:{value:t.ip},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadAudit(1)},input:function(a){a.target.composing||(t.ip=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("button",{staticClass:"btn btn-primary ml-2",on:{click:function(a){return t.loadAudit(1)}}},[t._v("\n            搜索\n          ")])])]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("vue-loading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n                ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadAudit(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-bordered"},[t._m(2),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.id},[e("td",{attrs:{nowrap:""}},[t._v("\n                  "+t._s(t.moment(a.time).format("YYYY-MM-DD HH:mm:ss"))+"\n                ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n"+t._s(t.audit_types[a.type_id])+"\n")]),t._v(" "),e("td",[t._v(t._s(a.content))]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                  "+t._s(a.user.length?a.user:"-")+"\n                ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                  "+t._s(a.ip)+"\n                ")])])}),0)]),t._v(" "),t.loading||0!=t.total?t._e():e("p",{staticClass:"text-center"},[t._v("\n暂无数据\n")]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n                ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadAudit(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e()],1)])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-calendar"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",[t._v("操作时间")]),t._v(" "),e("th",[t._v("操作类型")]),t._v(" "),e("th",[t._v("操作内容")]),t._v(" "),e("th",[t._v("操作人")]),t._v(" "),e("th",[t._v("IP 地址")])])])}]},oa=e("VU/8")(ra,la,!1,null,null,null).exports,ca={name:"attack_params",data:function(){return{data:{message:"wtf",attack_params:{}}}},methods:{setData:function(t){this.data=t},onCopySucc:function(t){console.log("succ")},onCopyError:function(t){console.log("fail",t)}}},da={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"event-detail"},["sql"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            数据库类型\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.server)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            执行的SQL语句\n            ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.query.length>1e4?t.data.attack_params.query+" ...":t.data.attack_params.query)+"                \n        ")])]):t._e(),t._v(" "),"sql_exception"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            数据库类型\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.server)+"\n        ")]),t._v(" "),t.data.attack_params.query?e("div",[e("div",{staticClass:"h6"},[t._v("\n                执行的SQL语句 \n\n                ")]),t._v(" "),e("p",[t._v("\n                "+t._s(t.data.attack_params.query.length>1e4?t.data.attack_params.query+" ...":t.data.attack_params.query)+"\n            ")])]):t._e()]):t._e(),t._v(" "),"directory"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            读取的目录\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.path)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            读取的目录 - 真实路径\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.realpath)+"\n        ")])]):t._e(),t._v(" "),"readFile"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            读取的文件\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.path)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            读取的文件 - 真实路径\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.realpath)+"\n        ")])]):t._e(),t._v(" "),"writeFile"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            写入的文件\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.path)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            写入的文件 - 真实路径\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.realpath)+"\n        ")])]):t._e(),t._v(" "),"deleteFile"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            删除的文件\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.path)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            删除的文件 - 真实路径\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.realpath)+"\n        ")])]):t._e(),t._v(" "),"include"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            要包含的文件\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.url)+"\n        ")]),t._v(" "),t.data.attack_params.realpath?e("div",{staticClass:"h6"},[t._v("\n            要包含的文件 - 真实路径\n        ")]):t._e(),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.realpath)+"\n        ")])]):t._e(),t._v(" "),"webdav"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            源文件\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.source)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            目标文件\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.dest)+"\n        ")])]):t._e(),t._v(" "),"fileUpload"==t.data.attack_type?e("div",[t.data.attack_params.name?e("div",{staticClass:"h6"},[t._v("\n            Multipart 参数名称\n        ")]):t._e(),t._v(" "),t.data.attack_params.name?e("p",[t._v("\n            "+t._s(t.data.attack_params.name)+"\n        ")]):t._e(),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            上传的文件名\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.filename)+"\n        ")]),t._v(" "),t.data.attack_params.dest_path?[e("div",{staticClass:"h6"},[t._v("\n                文件存储位置\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.attack_params.dest_path))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n                文件存储位置（真实路径）\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.attack_params.dest_realpath))])]:t._e(),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            上传的文件内容 - 前4KB\n        ")]),t._v(" "),e("pre",[t._v(t._s(t.data.attack_params.content))])],2):t._e(),t._v(" "),"rename"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            源文件\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.source)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            目标文件\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.dest)+"\n        ")])]):t._e(),t._v(" "),"command"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            要执行的命令\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.command)+"\n        ")])]):t._e(),t._v(" "),"xxe"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            要加载的外部实体\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.entity)+"\n        ")])]):t._e(),t._v(" "),"ognl"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            要执行的OGNL表达式\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.expression)+"\n        ")])]):t._e(),t._v(" "),"deserialization"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            要生成的Java类名\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.clazz)+"\n        ")])]):t._e(),t._v(" "),"ssrf"==t.data.attack_type||"ssrfRedirect"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            要访问的 URL\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.url)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            目标 IP\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.ip.join(", "))+"\n        ")])]):t._e(),t._v(" "),"xss_echo"==t.data.attack_type||"xss_userinput"==t.data.attack_type?e("div",[t.data.attack_params.name?e("div",{staticClass:"h6"},[t._v("\n            XSS 参数名称\n        ")]):t._e(),t._v(" "),t.data.attack_params.name?e("p",[t._v("\n            "+t._s(t.data.attack_params.name)+"\n        ")]):t._e(),t._v(" "),t.data.attack_params.value?e("div",{staticClass:"h6"},[t._v("\n            XSS 利用代码\n        ")]):t._e(),t._v(" "),t.data.attack_params.value?e("p",[t._v("\n            "+t._s(t.data.attack_params.value.length>1e4?t.data.attack_params.value+" ...":t.data.attack_params.value)+"   \n        ")]):t._e()]):t._e(),t._v(" "),"jndi"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            JNDI加载路径\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.name)+"\n        ")])]):t._e(),t._v(" "),"dns"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            要解析的DNS域名\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.host)+"\n        ")])]):t._e(),t._v(" "),"response"==t.data.attack_type&&"response_dataLeak"==t.data.plugin_algorithm?e("div",[e("div",{staticClass:"h6"},[t._v("\n            泄露的敏感信息样例\n        ")]),t._v(" "),e("div",[e("table",{staticClass:"table table-bordered"},[t._m(0),t._v(" "),e("tbody",t._l(t.data.attack_params.parts,function(a,s){return e("tr",{key:s},[e("td",{attrs:{nowrap:""}},[t._v(t._s(a.type))]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v(t._s(a.match))]),t._v(" "),e("td",[t._v(t._s(a.parts))])])}),0)])])]):t._e(),t._v(" "),"webshell_eval"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            菜刀要 eval 的内容\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.eval)+"\n        ")])]):t._e(),t._v(" "),"webshell_command"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            WebShell 要执行的命令\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.command)+"\n        ")])]):t._e(),t._v(" "),"webshell_file_put_contents"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            WebShell 要写入的文件\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.name)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            WebShell 要写入的文件 - 真实路径\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.realpath)+"\n        ")])]):t._e(),t._v(" "),"webshell_callable"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            后门要执行的函数\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.function)+"()\n        ")])]):t._e(),t._v(" "),"webshell_ld_preload"==t.data.attack_type&&t.data.attack_params.env?e("div",[e("div",{staticClass:"h6"},[t._v("\n            后门要设置的环境变量\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.env)+"\n        ")])]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("thead",[a("tr",[a("th",[this._v("类型")]),this._v(" "),a("th",[this._v("未打码信息")]),this._v(" "),a("th",[this._v("原始内容（片段）")])])])}]},_a={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"event-detail"},["sql"==t.data.attack_type?e("div",[t._v("\n        SQL注入大多是语句拼接造成的，请检查代码中是否有参数拼接的情况。在条件允许的情况下，尽量使用 prepare query 的形式来修复漏洞。\n    ")]):t._e(),t._v(" "),"sql_exception"==t.data.attack_type?e("div",[t._v("\n        检查SQL语句异常是否来自正常操作，如果不是请检查应用是否存在漏洞。\n    ")]):t._e(),t._v(" "),"directory"==t.data.attack_type?e("div",[t._v("\n        通常应用不会读取敏感目录，请与业务线确认这个是否为正常行为。如果不是，请根据堆栈检查服务器是否存在 webshell 后门。\n    ")]):t._e(),t._v(" "),"readFile"==t.data.attack_type?e("div",[t._v("\n        通常应用不会读取敏感文件，请与业务线确认这个是否为正常行为。如果不是，请根据堆栈检查服务器是否存在 webshell 后门。\n    ")]):t._e(),t._v(" "),"deleteFile"==t.data.attack_type?e("div",[t._v("\n        对传入的文件路径进行过滤或者校验。\n    ")]):t._e(),t._v(" "),"writeFile"==t.data.attack_type?e("div",[t._v("\n        对要删除的文件名称进行过滤，比如限制目录等等，以避免对系统造成破坏。\n    ")]):t._e(),t._v(" "),"include"==t.data.attack_type?e("div",[t._v("\n        请检查要包含的文件是否正常，否则表示服务器上存在文件包含漏洞。\n    ")]):t._e(),t._v(" "),"webdav"==t.data.attack_type?e("div",[t._v("\n        请检查服务器是否开放了 MOVE/PUT 操作，攻击者可利用特殊的HTTP方法上传 webshell 后门。此算法没有误报。           \n    ")]):t._e(),t._v(" "),"fileUpload"==t.data.attack_type?e("div",[t._v("\n        当服务器允许用户上传文件，且没有过滤扩展名时，可能造成任意文件上传漏洞。修复方法是使用扩展名的白名单，比如只允许 txt/png/jpg 等后缀。此算法通常没有误报。\n    ")]):t._e(),t._v(" "),"rename"==t.data.attack_type?e("div",[t._v("\n        当服务器存在漏洞，攻击者可以通过重命名的方式，将不可执行的 txt/rar 等文件名重命名为 php/jsp/.. 等可以执行的脚本文件。此算法在一些PHP框架下会误报。\n    ")]):t._e(),t._v(" "),"command"==t.data.attack_type?e("div",[t._v("\n        如果这个命令执行不是业务正常需求，则很有可能是 webshell 后门执行的操作，或者攻击者利用漏洞执行的命令。\n    ")]):t._e(),t._v(" "),"xxe"==t.data.attack_type?e("div",[t._v("\n        检查业务代码是否直接处理用户输入的 xml，且允许加载任意外部实体，若允许则可能存在 xxe 漏洞。\n        在 v1.1 之后我们会增加XXE代码安全开关，自动帮你禁止xml实体加载，自动修复漏洞。\n    ")]):t._e(),t._v(" "),"ognl"==t.data.attack_type?e("div",[t._v("\n        尝试升级 struts 到新版，或者推动业务改造，使用其他的开发框架。在百度，我们已经禁止业务线使用 struts 框架。\n    ")]):t._e(),t._v(" "),"deserialization"==t.data.attack_type?e("div",[t._v("\n        检查系统是否存在已知的反序列化漏洞，并升级软件或者框架到最新版本。\n    ")]):t._e(),t._v(" "),"link"==t.data.attack_type?e("div",[t._v("\n        如果这个链接操作不是业务正常需求，则很有可能是 webshell 后门执行的操作，比如用于绕过EDR检测。\n    ")]):t._e(),t._v(" "),"ssrf"==t.data.attack_type||"ssrfRedirect"==t.data.attack_type?e("div",[t._v("\n        检查业务代码，看是否可以直接向用户指定的内网URL，发起请求。\n    ")]):t._e(),t._v(" "),"webshell_eval"==t.data.attack_type?e("div",[t._v("\n        检查服务器上是否存在中国菜刀后门，后门也可能存在于业务代码中，具体请看应用堆栈。\n    ")]):t._e(),t._v(" "),"webshell_command"==t.data.attack_type?e("div",[t._v("\n        检查服务器上是否存在 webshell 后门或者可以被利用的命令执行点，此算法没有误报。\n    ")]):t._e(),t._v(" "),"webshell_file_put_contents"==t.data.attack_type?e("div",[t._v("\n        检查服务器上是否存在 webshell 后门，或者可以被利用的后门上传点，此算法没有误报。\n    ")]):t._e(),t._v(" "),"webshell_callable"==t.data.attack_type?e("div",[t._v("\n        检查服务器上是否存在 webshell 后门，即使用 call_user_func/array_walk/.. 调用 system/exec/... 等函数的方式。此算法没有误报。\n    ")]):t._e(),t._v(" "),"webshell_ld_preload"==t.data.attack_type?e("div",[t._v("\n        检查服务器上是否存在 webshell 后门，即使用 putenv + LD_PRELOAD + mail 方式执行任意命令的后门。\n    ")]):t._e(),t._v(" "),"xss_userinput"==t.data.attack_type||"xss_echo"==t.data.attack_type?e("div",[t._v("\n        检查应用是否直接输出了用户传入的参数，可以考虑使用 ESAPI 进行转义。\n    ")]):t._e(),t._v(" "),"eval"==t.data.attack_type?e("div",[t._v("\n        避免使用 eval/assert 函数，或者检查目标文件是否为后门程序。\n    ")]):t._e(),t._v(" "),"loadLibrary"==t.data.attack_type?e("div",[t._v("\n        检查目标文件是否为后门。\n    ")]):t._e(),t._v(" "),"response"==t.data.attack_type?e("div",[t._v("\n        对响应里的敏感数据进行打码处理，避免展示明文数据。\n    ")]):t._e()])},staticRenderFns:[]},pa={name:"EventDetailModal",components:{attack_params:e("VU/8")(ca,da,!1,null,null,null).exports,fix_solutions:e("VU/8")({name:"fix_solutions",data:function(){return{data:{attack_params:{}}}},methods:{setData:function(t){this.data=t}}},_a,!1,null,null,null).exports},data:function(){return{tabIndex:0,tabs:["漏洞详情","请求信息","资产信息","修复建议"],data:{url:"",stack_md5:"",attack_location:{},source_code:[],stack_trace:"",merged_code:[]}}},methods:{attack_type2name:C,exportJSON:function(){x("alarm.json",J()(this.data,null,2))},showModal:function(t){this.tabIndex=0,this.data=t,t.stack_trace||(t.attack_params.stack?t.stack_trace=t.attack_params.stack.join("\n"):t.stack_trace=""),this.$refs.attack_params.setData(t),this.$refs.fix_solutions.setData(t),this.mergeStackAndSource(t),$("#showEventDetailModal").modal()},decodeMultipartFile:function(t){var a=[];try{JSON.parse(t).forEach(function(t){a.push("name="+t.name+"; filename="+t.filename)})}catch(t){return"解析 Multipart File 参数出现异常，请加入QQ群联系群主: "+t}return a.join("\n")},decodeMultipartForm:function(t){var a=[],e=JSON.parse(t);try{X()(e).forEach(function(t){var s=e[t];s.constructor==Array?s.forEach(function(e){a.push(t+"="+e)}):s.constructor==Object?X()(s).forEach(function(e){a.push(t+"["+e+"]="+s[e])}):a.push(t+"="+s)})}catch(t){return"解析 Multipart Form 参数出现异常，请加入QQ群联系群主: "+t}return a.join("&")},mergeHeaders:function(t){var a="";for(var e in t)a=a+"\n"+e+": "+t[e];return a.trim()},mergeStackAndSource:function(t){if(t.source_code&&t.source_code.length){var a=t.stack_trace.trim().split("\n");if(a.length==t.source_code.length){this.data.merged_code=[];for(var e=0;e<a.length;e++){var s=a[e],n=t.source_code[e].trim();this.data.merged_code.push({stack:s,code:n.length?n:"(空)"})}}else console.error("Error: stack_trace size '"+a.length+"' is different from source_code size '"+t.source_code.length+"', skipped")}}}},va={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"showEventDetailModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),e("div",{staticClass:"modal-body",staticStyle:{"padding-top":"0"}},[e("ul",{staticClass:"nav nav-tabs",attrs:{id:"myTab",role:"tablist"}},t._l(t.tabs,function(a,s){return e("li",{key:s,staticClass:"nav-item"},[e("a",{class:{"nav-link":!0,active:t.tabIndex==s},attrs:{href:"javascript:"},on:{click:function(a){t.tabIndex=s}}},[t._v("\n              "+t._s(a)+"\n            ")])])}),0),t._v(" "),e("br"),t._v(" "),e("div",{staticClass:"tab-content",attrs:{id:"myTabContent"}},[e("div",{class:{"tab-pane":!0,fade:!0,show:0==t.tabIndex,active:0==t.tabIndex},attrs:{id:"vuln"}},[e("div",{staticClass:"h6"},[t._v("\n              报警时间\n            ")]),t._v(" "),e("p",[t._v(t._s(t.moment(t.data.event_time).format("YYYY-MM-DD HH:mm:ss")))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              报警消息\n            ")]),t._v(" "),e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n              ["+t._s(t.attack_type2name(t.data.attack_type))+"] "+t._s(t.data.plugin_message)+"\n            ")]),t._v(" "),e("attack_params",{ref:"attack_params"}),t._v(" "),t.data.stack_md5?e("div",{staticClass:"h6"},[t._v("\n              应用堆栈 MD5\n            ")]):t._e(),t._v(" "),t.data.stack_md5?e("p",[t._v(t._s(t.data.stack_md5))]):t._e(),t._v(" "),t.data.stack_trace?e("div",{staticClass:"h6"},[t._v("\n              应用堆栈\n            ")]):t._e(),t._v(" "),t.data.stack_trace?e("pre",[t._v(t._s(t.data.stack_trace))]):t._e(),t._v(" "),t.data.merged_code?e("div",[e("div",{staticClass:"h6"},[t._v("\n                应用源代码\n              ")]),t._v(" "),e("pre",t._l(t.data.merged_code,function(a,s){return e("div",{key:s},[t._v(t._s(t.data.merged_code.length-s)+". "+t._s(a.stack)),e("br"),t._v(t._s(a.code)+"\n              ")])}),0)]):t._e()],1),t._v(" "),e("div",{class:{"tab-pane":!0,fade:!0,show:1==t.tabIndex,active:1==t.tabIndex},attrs:{id:"home"}},[e("div",{staticClass:"h6"},[t._v("\n              请求编号\n            ")]),t._v(" "),e("p",[t._v("\n              "+t._s(t.data.request_id?t.data.request_id:"-")+"\n            ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              请求 URL\n            ")]),t._v(" "),e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n              "+t._s(t.data.request_method?t.data.request_method.toUpperCase():"")+" \n              "),e("a",{attrs:{target:"_blank",href:t.data.url}},[t._v("\n                "+t._s(t.data.url?t.data.url:"-")+"\n              ")])]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              请求来源\n            ")]),t._v(" "),e("p",[t._v("\n              "+t._s(t.data.attack_source?t.data.attack_source:"-")+"\n              "),t.data.attack_location&&"-"!=t.data.attack_location.location_zh_cn?e("span",[t._v("\n                "+t._s(t.data.attack_location.location_zh_cn)+"\n              ")]):t._e()]),t._v(" "),t.data.client_ip?e("div",{staticClass:"h6"},[t._v("\n              客户端真实 IP\n            ")]):t._e(),t._v(" "),t.data.client_ip?e("p",[t._v("\n              "+t._s(t.data.client_ip)+"\n            ")]):t._e(),t._v(" "),t.data.header&&Object.keys(t.data.header).length?e("div",[t.data.header.referer?e("div",{staticClass:"h6"},[t._v("\n                请求 Referer\n              ")]):t._e(),t._v(" "),t.data.header.referer?e("p",[e("a",{attrs:{target:"_blank",href:t.data.header.referer}},[t._v("\n                  "+t._s(t.data.header.referer)+"\n                ")])]):t._e(),t._v(" "),t.data.header.user_agent?e("div",{staticClass:"h6"},[t._v("\n                请求 UA\n              ")]):t._e(),t._v(" "),t.data.header.user_agent?e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n                "+t._s(t.data.header.user_agent)+"\n              ")]):t._e(),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n                完整 Header 信息\n              ")]),t._v(" "),e("pre",[t._v(t._s(t.mergeHeaders(t.data.header)))]),t._v(" "),t.data.parameter&&"[]"!=t.data.parameter.multipart&&"{}"!=t.data.parameter.multipart?e("div",[e("div",{staticClass:"h6"},[t._v("\n                  Multipart 文件参数\n                ")]),t._v(" "),e("pre",[t._v(t._s(t.decodeMultipartFile(t.data.parameter.multipart)))])]):t._e(),t._v(" "),t.data.parameter&&"{}"!=t.data.parameter.form?e("div",[e("div",{staticClass:"h6"},[t._v("\n                  Form 参数\n                ")]),t._v(" "),e("pre",[t._v(t._s(t.decodeMultipartForm(t.data.parameter.form)))])]):t._e(),t._v(" "),t.data.parameter&&"{}"!=t.data.parameter.json?e("div",[e("div",{staticClass:"h6"},[t._v("\n                  JSON 参数\n                ")]),t._v(" "),e("pre",[t._v(t._s(t.data.parameter.json))])]):t._e()]):e("div",[e("div",{staticClass:"h6"},[t._v("\n                请求 Referer\n              ")]),t._v(" "),e("p",{staticStyle:{"white-space":"normal","word-break":"break-all"}},[t._v("\n                "+t._s(t.data.referer?t.data.referer:"-")+"\n              ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n                请求 UA\n              ")]),t._v(" "),e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n                "+t._s(t.data.user_agent?t.data.user_agent:"-")+"\n              ")])]),t._v(" "),t.data.body?e("div",[e("div",{staticClass:"h6"},[t._v("\n                请求 BODY\n              ")]),t._v(" "),e("pre",{staticStyle:{"word-break":"break-all"}},[t._v(t._s(t.data.body))])]):t._e()]),t._v(" "),e("div",{class:{"tab-pane":!0,fade:!0,show:2==t.tabIndex,active:2==t.tabIndex},attrs:{id:"profile"}},[e("div",{staticClass:"h6"},[t._v("\n              主机名称\n            ")]),t._v(" "),e("p",[t._v("\n              "+t._s(t.data.server_hostname)+"\n            ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              服务器 IP\n            ")]),t._v(" "),e("ul",t._l(t.data.server_nic,function(a){return e("li",{key:a.name},[t._v("\n                "+t._s(a.name)+": "+t._s(a.ip)+"\n              ")])}),0),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              RASP 版本\n            ")]),t._v(" "),e("p",[t._v("\n              "+t._s(t.data.rasp_version)+"\n            ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              RASP ID\n            ")]),t._v(" "),e("p",[t._v("\n              "+t._s(t.data.rasp_id)+"\n            ")]),t._v(" "),t.data.server_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n                应用版本\n              ")]),t._v(" "),e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n                "+t._s(t.data.server_type)+"/"+t._s(t.data.server_version)+"\n              ")])]):t._e()]),t._v(" "),e("div",{class:{"tab-pane":!0,fade:!0,show:3==t.tabIndex,active:3==t.tabIndex},attrs:{id:"contact"}},[e("fix_solutions",{ref:"fix_solutions"})],1)])]),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-primary mr-auto",on:{click:function(a){return t.exportJSON()}}},[t._v("\n          导出\n        ")]),t._v(" "),e("button",{staticClass:"btn btn-primary",attrs:{"data-dismiss":"modal"}},[t._v("\n          关闭\n        ")])])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[this._v("\n          报警详情\n        ")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])}]},ua=e("VU/8")(pa,va,!1,null,null,null).exports,ma={name:"Events",components:{EventDetailModal:ua,DatePicker:st},data:function(){return{data:[],loading:!1,currentPage:1,srcip:"",url:"",request_id:"",request_method:"",body:"",header:"",stack:"",stack_md5:"",plugin_algorithm:"",plugin_message:"",server_hostname:"",total:0,attack_types:f,status_types:g,selected_status:X()(g),selected:X()(f)}},computed:D()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.loadEvents(1)},selected:function(){this.loadEvents(1)},selected_status:function(){this.loadEvents(1)}},mounted:function(){this.current_app.id&&this.loadEvents(1)},methods:{ceil:Math.ceil,displayURL:function(t){return t.url?t.url.length>100?t.url.substring(0,100)+" ...":t.url:"-"},selectAllStatus:function(t){var a=t.target;this.selected_status=a.checked?X()(this.status_types):[]},selectAll:function(t){var a=t.target;this.selected=a.checked?X()(this.attack_types):[]},attack_type2name:C,block_status2name:k,showEventDetail:function(t){this.$refs.showEventDetail.showModal(t)},loadEvents:function(t){var a=this;return this.loading=!0,this.request.post("v1/api/log/attack/search",{data:{start_time:this.$refs.datePicker.start.valueOf(),end_time:this.$refs.datePicker.end.valueOf(),attack_type:this.selected,attack_source:this.srcip,app_id:this.current_app.id,url:this.url,header:this.header,request_id:this.request_id,request_method:this.request_method,intercept_state:this.selected_status,plugin_message:this.plugin_message,plugin_algorithm:this.plugin_algorithm,server_hostname:this.server_hostname,stack_md5:this.stack_md5,stack:this.stack},page:t,perpage:10}).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})}}},ha={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header",staticStyle:{"flex-direction":"column",display:"flex"}},[e("div",{staticStyle:{display:"flex","flex-direction":"row","justify-content":"flex-start",width:"100%"}},[e("h1",{staticClass:"page-title"},[t._v("\n          攻击事件\n        ")]),t._v(" "),e("div",{staticClass:"page-options d-flex"},[e("b-dropdown",{staticClass:"ml-2",attrs:{text:"拦截状态",right:""}},[e("b-container",{staticStyle:{width:"250px"}},[e("b-form-row",[t._l(t.status_types,function(a,s){return[e("b-col",{key:s},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.selected_status,expression:"selected_status"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.selected_status)?t._i(t.selected_status,s)>-1:t.selected_status},on:{change:function(a){var e=t.selected_status,n=a.target,i=!!n.checked;if(Array.isArray(e)){var r=s,l=t._i(e,r);n.checked?l<0&&(t.selected_status=e.concat([r])):l>-1&&(t.selected_status=e.slice(0,l).concat(e.slice(l+1)))}else t.selected_status=i}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                        "+t._s(a)+"\n                      ")])])])]})],2)],1)],1),t._v(" "),e("b-dropdown",{staticClass:"ml-2",attrs:{text:"攻击类型",right:""}},[e("b-container",{staticStyle:{width:"500px"}},[e("b-form-row",[e("b-col",[e("label",{staticClass:"custom-switch"},[e("input",{staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:""},on:{change:t.selectAll}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                      全选\n                    ")])])]),t._v(" "),e("div",{staticClass:"w-100"}),t._v(" "),t._l(t.attack_types,function(a,s,n){return[e("b-col",{key:s},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.selected)?t._i(t.selected,s)>-1:t.selected},on:{change:function(a){var e=t.selected,n=a.target,i=!!n.checked;if(Array.isArray(e)){var r=s,l=t._i(e,r);n.checked?l<0&&(t.selected=e.concat([r])):l>-1&&(t.selected=e.slice(0,l).concat(e.slice(l+1)))}else t.selected=i}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                        "+t._s(a)+"\n                      ")])])]),t._v(" "),n%2==1?e("div",{staticClass:"w-100"}):t._e()]})],2)],1)],1),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(0),t._v(" "),e("DatePicker",{ref:"datePicker",on:{selected:function(a){return t.loadEvents(1)}}})],1),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(1),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.srcip,expression:"srcip",modifiers:{trim:!0}}],staticClass:"form-control w-10",staticStyle:{width:"210px"},attrs:{type:"text",placeholder:"请求来源"},domProps:{value:t.srcip},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.srcip=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})])],1)]),t._v(" "),e("div",{staticClass:"page-options d-flex",staticStyle:{"margin-top":"5px"}},[e("div",{staticClass:"input-icon ml-2"},[t._m(2),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.url,expression:"url",modifiers:{trim:!0}}],staticClass:"form-control w-10",staticStyle:{width:"210px"},attrs:{type:"text",placeholder:"目标 URL"},domProps:{value:t.url},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.url=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(3),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.plugin_message,expression:"plugin_message",modifiers:{trim:!0}}],staticClass:"form-control w-10",staticStyle:{width:"210px"},attrs:{type:"text",placeholder:"报警消息"},domProps:{value:t.plugin_message},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.plugin_message=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})])]),t._v(" "),e("div",{staticClass:"page-options d-flex",staticStyle:{"margin-top":"5px"}},[e("div",{staticClass:"input-icon ml-2"},[t._m(4),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.request_id,expression:"request_id",modifiers:{trim:!0}}],staticClass:"form-control w-10",staticStyle:{width:"210px"},attrs:{type:"text",placeholder:"请求 ID"},domProps:{value:t.request_id},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.request_id=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(5),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.plugin_algorithm,expression:"plugin_algorithm",modifiers:{trim:!0}}],staticClass:"form-control w-10",staticStyle:{width:"210px"},attrs:{type:"text",placeholder:"检测算法"},domProps:{value:t.plugin_algorithm},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.plugin_algorithm=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})])]),t._v(" "),e("div",{staticClass:"page-options d-flex",staticStyle:{"margin-top":"5px"}},[e("div",{staticClass:"input-icon ml-2"},[t._m(6),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.server_hostname,expression:"server_hostname",modifiers:{trim:!0}}],staticClass:"form-control w-10",staticStyle:{width:"210px"},attrs:{type:"text",placeholder:"资产IP/主机名/RASP ID"},domProps:{value:t.server_hostname},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.server_hostname=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(7),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.stack_md5,expression:"stack_md5",modifiers:{trim:!0}}],staticClass:"form-control w-10",staticStyle:{width:"210px"},attrs:{type:"text",placeholder:"堆栈 MD5"},domProps:{value:t.stack_md5},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.stack_md5=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})])]),t._v(" "),e("div",{staticClass:"page-options d-flex",staticStyle:{"margin-top":"5px"}},[e("button",{staticClass:"btn btn-primary ml-2",staticStyle:{height:"38px"},on:{click:function(a){return t.loadEvents(1)}}},[t._v("\n          搜索\n        ")])])]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("VueLoading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadEvents(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-striped table-bordered"},[t._m(8),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.id},[e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(t.moment(a.event_time).format("YYYY-MM-DD"))+"\n                "),e("br"),t._v("\n                "+t._s(t.moment(a.event_time).format("HH:mm:ss"))+"\n              ")]),t._v(" "),e("td",{staticStyle:{"max-width":"500px","word-break":"break-word"}},[e("a",{attrs:{href:a.url,target:"_blank"}},[t._v("\n                  "+t._s(t.displayURL(a))+"\n                ")])]),t._v(" "),e("td",[e("a",{attrs:{target:"_blank",href:"https://www.virustotal.com/#/ip-address/"+(a.client_ip?a.client_ip:a.attack_source)}},[t._v("\n                  "+t._s(a.client_ip?a.client_ip:a.attack_source?a.attack_source:"-")+"\n                ")])]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(t.block_status2name(a.intercept_state))+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[e("span",{staticClass:"tag tag-danger"},[t._v("\n                  "+t._s(t.attack_type2name(a.attack_type))+"\n                ")])]),t._v(" "),e("td",[t._v("\n                "+t._s(a.plugin_message)+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.showEventDetail(a)}}},[t._v("\n                  查看详情\n                ")])])])}),0)]),t._v(" "),t.loading||0!=t.total?t._e():e("p",{staticClass:"text-center"},[t._v("暂无数据")]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadEvents(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e()],1)])]),t._v(" "),e("EventDetailModal",{ref:"showEventDetail"})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-calendar"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",[t._v("\n                请求时间\n              ")]),t._v(" "),e("th",{staticStyle:{"min-width":"150px"}},[t._v("\n                URL\n              ")]),t._v(" "),e("th",[t._v("\n                请求来源\n              ")]),t._v(" "),e("th",[t._v("\n                拦截状态\n              ")]),t._v(" "),e("th",{attrs:{nowrap:""}},[t._v("\n                攻击类型\n              ")]),t._v(" "),e("th",[t._v("\n                报警消息\n              ")]),t._v(" "),e("th",[t._v("\n                操作\n              ")])])])}]},fa=e("VU/8")(ma,ha,!1,null,null,null).exports,ga={name:"vulns",components:{EventDetailModal:ua,DatePicker:st},data:function(){return{data:[],loading:!1,currentPage:1,url:"",total:0,attack_types:f,status_types:g,selected_status:X()(g),selected:X()(f)}},computed:D()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.loadEvents(1)},selected:function(){this.loadEvents(1)},selected_status:function(){this.loadEvents(1)}},mounted:function(){this.current_app.id&&this.loadEvents(1)},methods:{ceil:Math.ceil,displayURL:function(t){return t.url?t.url.length>100?t.url.substring(0,100)+" ...":t.url:"-"},selectAllStatus:function(t){var a=t.target;this.selected_status=a.checked?X()(this.status_types):[]},selectAll:function(t){var a=t.target;this.selected=a.checked?X()(this.attack_types):[]},attack_type2name:C,block_status2name:k,showEventDetail:function(t){this.$refs.showEventDetail.showModal(t)},loadEvents:function(t){var a=this;return this.loading=!0,this.request.post("v1/api/log/attack/aggr/vuln",{data:{start_time:this.$refs.datePicker.start.valueOf(),end_time:this.$refs.datePicker.end.valueOf(),attack_type:this.selected,intercept_state:this.selected_status,url:this.url,app_id:this.current_app.id},page:t,perpage:10}).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})}}},ba={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header"},[e("h1",{staticClass:"page-title"},[t._v("\n        漏洞列表\n      ")]),t._v(" "),e("div",{staticClass:"page-options d-flex"},[e("div",{staticClass:"input-icon ml-2"},[t._m(0),t._v(" "),e("DatePicker",{ref:"datePicker",on:{selected:function(a){return t.loadEvents(1)}}})],1),t._v(" "),e("b-dropdown",{staticClass:"ml-2",attrs:{text:"拦截状态",right:""}},[e("b-container",{staticStyle:{width:"250px"}},[e("b-form-row",[t._l(t.status_types,function(a,s){return[e("b-col",{key:s},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.selected_status,expression:"selected_status"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.selected_status)?t._i(t.selected_status,s)>-1:t.selected_status},on:{change:function(a){var e=t.selected_status,n=a.target,i=!!n.checked;if(Array.isArray(e)){var r=s,l=t._i(e,r);n.checked?l<0&&(t.selected_status=e.concat([r])):l>-1&&(t.selected_status=e.slice(0,l).concat(e.slice(l+1)))}else t.selected_status=i}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                      "+t._s(a)+"\n                    ")])])])]})],2)],1)],1),t._v(" "),e("b-dropdown",{staticClass:"ml-2",attrs:{text:"漏洞类型",right:""}},[e("b-container",{staticStyle:{width:"500px"}},[e("b-form-row",[e("b-col",[e("label",{staticClass:"custom-switch"},[e("input",{staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:""},on:{change:t.selectAll}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                    全选\n                  ")])])]),t._v(" "),e("div",{staticClass:"w-100"}),t._v(" "),t._l(t.attack_types,function(a,s,n){return[e("b-col",{key:s},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.selected)?t._i(t.selected,s)>-1:t.selected},on:{change:function(a){var e=t.selected,n=a.target,i=!!n.checked;if(Array.isArray(e)){var r=s,l=t._i(e,r);n.checked?l<0&&(t.selected=e.concat([r])):l>-1&&(t.selected=e.slice(0,l).concat(e.slice(l+1)))}else t.selected=i}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                      "+t._s(a)+"\n                    ")])])]),t._v(" "),n%2==1?e("div",{staticClass:"w-100"}):t._e()]})],2)],1)],1),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(1),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.url,expression:"url",modifiers:{trim:!0}}],staticClass:"form-control w-10",attrs:{type:"text",placeholder:"目标URL"},domProps:{value:t.url},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.url=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("button",{staticClass:"btn btn-primary ml-2",on:{click:function(a){return t.loadEvents(1)}}},[t._v("\n          搜索\n        ")])],1)]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("VueLoading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadEvents(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-striped table-bordered"},[t._m(2),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.id},[e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(t.moment(a.event_time).format("YYYY-MM-DD"))+"\n                "),e("br"),t._v("\n                "+t._s(t.moment(a.event_time).format("HH:mm:ss"))+"\n              ")]),t._v(" "),e("td",{staticStyle:{"max-width":"500px","word-break":"break-word"}},[e("a",{attrs:{href:a.url,target:"_blank"}},[t._v("\n                  "+t._s(t.displayURL(a))+"\n                ")])]),t._v(" "),e("td",[a.attack_source?e("div",[e("a",{attrs:{target:"_blank",href:"https://www.virustotal.com/#/ip-address/"+(a.client_ip?a.client_ip:a.attack_source)}},[t._v("\n                    "+t._s(a.client_ip?a.client_ip:a.attack_source)+"                  \n                  ")]),t._v(" "),e("br")]):t._e(),t._v("\n                利用 "+t._s(a.attack_count)+" 次\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(t.block_status2name(a.intercept_state))+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[e("span",{staticClass:"tag tag-danger"},[t._v("\n                  "+t._s(t.attack_type2name(a.attack_type))+"\n                ")])]),t._v(" "),e("td",{staticStyle:{"word-break":"break-all"}},[t._v("\n                "+t._s(a.plugin_message)+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.showEventDetail(a)}}},[t._v("\n                  查看详情\n                ")])])])}),0)]),t._v(" "),t.loading||0!=t.total?t._e():e("p",{staticClass:"text-center"},[t._v("暂无数据")]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadEvents(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e()],1)])]),t._v(" "),e("EventDetailModal",{ref:"showEventDetail"})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-calendar"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",[t._v("\n                最后发现\n              ")]),t._v(" "),e("th",{staticStyle:{"min-width":"150px"}},[t._v("\n                URL\n              ")]),t._v(" "),e("th",[t._v("\n                请求来源\n              ")]),t._v(" "),e("th",[t._v("\n                最后状态\n              ")]),t._v(" "),e("th",{attrs:{nowrap:""}},[t._v("\n                漏洞类型\n              ")]),t._v(" "),e("th",[t._v("\n                报警消息\n              ")]),t._v(" "),e("th",[t._v("\n                操作\n              ")])])])}]},ya=e("VU/8")(ga,ba,!1,null,null,null).exports,ka={name:"ExceptionDetailModal",data:function(){return{data:{}}},methods:{showModal:function(t){this.data=t,$("#showExceptionDetailModal").modal()}}},Ca={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"showExceptionDetailModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),e("div",{staticClass:"modal-body",staticStyle:{"padding-top":"0"}},[t._m(1),t._v(" "),e("br"),t._v(" "),e("div",{staticClass:"tab-content",attrs:{id:"myTabContent"}},[e("div",{staticClass:"tab-pane fade show active",attrs:{id:"exception",role:"tabpanel","aria-labelledby":"home-tab"}},[e("div",{staticClass:"h6"},[t._v("\n              报警时间\n            ")]),t._v(" "),e("p",[t._v(t._s(t.moment(t.data.event_time).format("YYYY-MM-DD HH:mm:ss")))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              报警消息\n            ")]),t._v(" "),e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n              ["+t._s(t.data.error_code)+"] "+t._s(t.data.message)+"\n            ")]),t._v(" "),t.data.pid?e("div",[e("div",{staticClass:"h6"},[t._v("\n                PID\n              ")]),t._v(" "),e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n                "+t._s(t.data.pid)+"\n              ")])]):t._e(),t._v(" "),t.data.path?e("div",[e("div",{staticClass:"h6"},[t._v("\n                日志路径\n              ")]),t._v(" "),e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n                "+t._s(t.data.path)+"\n              ")])]):t._e(),t._v(" "),t.data.stack_trace?e("div",{staticClass:"h6"},[t._v("\n              堆栈信息\n            ")]):t._e(),t._v(" "),t.data.stack_trace?e("pre",[t._v(t._s(t.data.stack_trace))]):t._e()]),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{id:"profile",role:"tabpanel","aria-labelledby":"profile-tab"}},[e("div",{staticClass:"h6"},[t._v("\n              主机名称\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.server_hostname))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              服务器 IP\n            ")]),t._v(" "),e("ul",t._l(t.data.server_nic,function(a){return e("li",{key:a.name},[t._v(t._s(a.name)+": "+t._s(a.ip))])}),0)])])]),t._v(" "),t._m(2)])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[this._v("\n          异常详情\n        ")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])},function(){var t=this.$createElement,a=this._self._c||t;return a("ul",{staticClass:"nav nav-tabs",attrs:{id:"myTab",role:"tablist"}},[a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link active",attrs:{id:"home-tab","data-toggle":"tab",href:"#exception"}},[this._v("\n              异常信息\n            ")])]),this._v(" "),a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link",attrs:{id:"profile-tab","data-toggle":"tab",href:"#profile",role:"tab"}},[this._v("资产信息")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-primary",attrs:{"data-dismiss":"modal"}},[this._v("\n          关闭\n        ")])])}]},wa={name:"Exceptions",components:{EventDetailModal:ua,ExceptionDetailModal:e("VU/8")(ka,Ca,!1,null,null,null).exports,DatePicker:st},data:function(){return{data:[],loading:!1,currentPage:1,hostname:"",message:"",total:0,fields:[{key:"event_time",label:"异常时间",class:"text-nowrap"},{key:"error_code",label:"异常编号",class:"text-nowrap"},{key:"server_hostname",label:"主机信息",tdAttr:{style:"min-width: 150px;"}},{key:"message",label:"内容"},{key:"button",label:"查看详情",class:"text-nowrap"}]}},computed:D()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.fetchData(1)},selected:function(){this.fetchData(1)}},mounted:function(){this.current_app.id&&this.fetchData(1)},methods:{ceil:Math.ceil,fetchData:function(t){var a=this,e={data:{start_time:this.$refs.datePicker.start.valueOf(),end_time:this.$refs.datePicker.end.valueOf(),app_id:this.current_app.id,server_hostname:this.hostname||void 0,message:this.message||void 0},page:t,perpage:10};return this.request.post("/v1/api/log/error/search",e).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})},showExceptionDetail:function(t){this.$refs.showExceptionDetail.showModal(t)}}},xa={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header"},[e("h1",{staticClass:"page-title"},[t._v("\n        异常日志\n      ")]),t._v(" "),e("div",{staticClass:"page-options d-flex"},[e("div",{staticClass:"input-icon ml-2"},[t._m(0),t._v(" "),e("DatePicker",{ref:"datePicker",on:{selected:function(a){return t.fetchData(1)}}})],1),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(1),t._v(" "),e("b-form-input",{staticClass:"form-control",attrs:{type:"text",placeholder:"搜索主机或者IP"},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.fetchData(1)}},model:{value:t.hostname,callback:function(a){t.hostname="string"==typeof a?a.trim():a},expression:"hostname"}})],1),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(2),t._v(" "),e("b-form-input",{staticClass:"form-control",attrs:{type:"text",placeholder:"搜索消息"},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.fetchData(1)}},model:{value:t.message,callback:function(a){t.message="string"==typeof a?a.trim():a},expression:"message"}})],1),t._v(" "),e("button",{staticClass:"btn btn-primary ml-2",on:{click:function(a){return t.fetchData(1)}}},[t._v("\n          搜索\n        ")])])]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("vue-loading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:t.fetchData},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),e("b-table",{attrs:{hover:"",bordered:"",items:t.data,fields:t.fields},scopedSlots:t._u([{key:"event_time",fn:function(a){return[t._v("\n            "+t._s(t.moment(a.item.event_time).format("YYYY-MM-DD"))+"\n            "),e("br"),t._v("\n            "+t._s(t.moment(a.item.event_time).format("HH:mm:ss"))+"\n          ")]}},{key:"message",fn:function(a){return[t._v("\n            ["+t._s(a.item.level)+"] "+t._s(a.item.message)+"\n          ")]}},{key:"server_hostname",fn:function(a){return[t._v("\n            "+t._s(a.item.server_hostname)),e("br"),t._v(" "),t._l(a.item.server_nic,function(a){return e("span",{key:a.name},[t._v(t._s(a.name)+": "+t._s(a.ip)),e("br")])})]}},{key:"cell(button)",fn:function(a){return[e("b-link",{on:{click:function(e){return t.showExceptionDetail(a.item)}}},[t._v("查看详情")])]}}])}),t._v(" "),t.loading||0!=t.total?t._e():e("p",{staticClass:"text-center"},[t._v("暂无数据")]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:t.fetchData},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e()],1)])]),t._v(" "),e("ExceptionDetailModal",{ref:"showExceptionDetail"})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-calendar"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])}]},$a=e("VU/8")(wa,xa,!1,null,null,null).exports,Pa={name:"DependencyDetailModal",data:function(){return{loading:!1,total:0,currentPage:1,data:{},search_data:{}}},methods:{ceil:Math.ceil,fetchData:function(t){var a=this;this.request.post("v1/api/dependency/search",{data:this.search_data,page:t,perpage:10}).then(function(t){a.data=t.data,a.total=t.total})},showModal:function(t){this.fetchData(1),$("#showDependencyDetailModal").modal()}}},Aa={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"showDependencyDetailModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog",staticStyle:{"max-width":"90%"},attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title"},[t._v("\n          依赖详情: "+t._s(t.search_data.tag)+"\n        ")]),t._v(" "),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})]),t._v(" "),e("div",{staticClass:"modal-body"},[e("table",{staticClass:"table table-bordered"},[t._m(0),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.id},[e("td",{attrs:{nowrap:""}},[t._v(t._s(a.hostname))]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v(t._s(a.register_ip))]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v(t._s(t.moment(a["@timestamp"]).format("YYYY-MM-DD HH:mm:ss")))]),t._v(" "),e("td",[t._v("\n                "+t._s(a.path.join(", "))+"\n              ")])])}),0)]),t._v(" "),e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:t.fetchData},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1),t._v(" "),t._m(1)])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("thead",[a("tr",[a("th",[this._v("主机名")]),this._v(" "),a("th",[this._v("网络信息")]),this._v(" "),a("th",[this._v("最后上报")]),this._v(" "),a("th",[this._v("路径列表")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-primary",attrs:{"data-dismiss":"modal"}},[this._v("\n          关闭\n        ")])])}]},Sa={name:"Dependency",components:{DependencyDetailModal:e("VU/8")(Pa,Aa,!1,null,null,null).exports,DatePicker:st},data:function(){return{data:[],loading:!1,currentPage:1,hostname:"",key_word:"",total:0,fields:[{key:"vendor",label:"厂商"},{key:"product",label:"产品"},{key:"version",label:"版本号",tdAttr:{style:"min-width: 150px;"}},{key:"rasp_count",label:"影响主机"},{key:"button",label:"查看详情",class:"text-nowrap"}]}},computed:D()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.fetchData(1)},selected:function(){this.fetchData(1)}},mounted:function(){this.current_app.id&&this.fetchData(1)},methods:{ceil:Math.ceil,deleteExpiredData:function(){var t=this;if(confirm("依赖库默认每隔6小时上报一次，后台不会清理超时数据。是否清理3天以前的依赖库数据?")){var a={app_id:this.current_app.id,timestamp:1e3*Q()().subtract(3,"days").unix()};return this.request.post("v1/api/dependency/delete",a).then(function(a){alert("过期数据清理完成，预计3秒后生效。点击确定刷新"),t.fetchData(1)})}},fetchData:function(t){var a=this,e={data:{app_id:this.current_app.id,hostname:this.hostname||void 0,key_word:this.key_word||void 0},page:t,perpage:10};return this.request.post("v1/api/dependency/aggr",e).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})},showDependencyDetail:function(t){this.$refs.dependencyDetailModal.search_data={app_id:this.current_app.id,tag:t.tag,key_word:this.key_word,hostname:this.hostname},this.$refs.dependencyDetailModal.showModal()}}},ja={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header"},[e("h1",{staticClass:"page-title"},[t._v("\n        类库信息\n      ")]),t._v(" "),e("div",{staticClass:"page-options d-flex"},[e("div",{staticClass:"input-icon ml-2"},[t._m(0),t._v(" "),e("b-form-input",{staticClass:"form-control",attrs:{type:"text",placeholder:"搜索主机/IP/OS"},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.fetchData(1)}},model:{value:t.hostname,callback:function(a){t.hostname="string"==typeof a?a.trim():a},expression:"hostname"}})],1),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(1),t._v(" "),e("b-form-input",{staticClass:"form-control",attrs:{type:"text",placeholder:"搜索厂商或者产品"},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.fetchData(1)}},model:{value:t.key_word,callback:function(a){t.key_word="string"==typeof a?a.trim():a},expression:"key_word"}})],1),t._v(" "),e("button",{staticClass:"btn btn-primary ml-2",on:{click:function(a){return t.fetchData(1)}}},[t._v("\n          搜索\n        ")]),t._v(" "),e("button",{staticClass:"btn btn-primary ml-2",on:{click:function(a){return t.deleteExpiredData()}}},[t._v("\n          清理\n        ")])])]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("vue-loading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:t.fetchData},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),e("b-table",{attrs:{hover:"",bordered:"",items:t.data,fields:t.fields},scopedSlots:t._u([{key:"cell(button)",fn:function(a){return[e("b-link",{on:{click:function(e){return t.showDependencyDetail(a.item)}}},[t._v("查看详情")])]}}])}),t._v(" "),t.loading||0!=t.total?t._e():e("p",{staticClass:"text-center"},[t._v("暂无数据")]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:t.fetchData},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e()],1)])]),t._v(" "),e("DependencyDetailModal",{ref:"dependencyDetailModal"})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])}]},Ea=e("VU/8")(Sa,ja,!1,null,null,null).exports,Da={name:"IastConfigModal",data:function(){return{data:{scan_rate:{max_concurrent_request:20,max_request_interval:1e3,min_request_interval:0},white_url_reg:"",scan_proxy:""},scan_plugin_status:{},byurl_regex_error:!1,modalDisplay:"modal"}},watch:{"data.white_url_reg":function(t,a){this.byurl_regex_error=this.validateRegex(t)}},methods:{showModal:function(t){this.data=t,$("#setConfigModal").modal()},validateRegex:y,getRequest:function(t,a,e){var s={order:a,data:e,headers:{"Content-Type":"application/json"}};return this.request.post(t,s)},setConfigTask:function(){var t=this,a=this.data.host,e=this.data.port,s=this.data.app_id,n=this.data.scan_rate;this.modalDisplay="modal",this.concurrent=isNaN(Number(n.max_concurrent_request))?void 0:Number(n.max_concurrent_request),this.minInterval=isNaN(Number(n.min_request_interval))?void 0:Number(n.min_request_interval),this.maxInterval=isNaN(Number(n.max_request_interval))?void 0:Number(n.max_request_interval),void 0!=this.data.white_url_reg&&this.data.white_url_reg,void 0!=this.data.scan_proxy&&this.data.scan_proxy,!this.byurl_regex_error&&this.concurrent>0&&this.maxInterval>0&&this.minInterval>=0?this.minInterval<=this.maxInterval?this.getRequest(this.data.baseUrl,"setConfig",{host:a,port:e,app_id:s,config:{scan_plugin_status:this.data.scan_plugin_status,scan_rate:{max_concurrent_request:this.concurrent,max_request_interval:this.maxInterval,min_request_interval:this.minInterval},white_url_reg:this.data.white_url_reg,scan_proxy:this.data.scan_proxy}}).then(function(a){0==a.status?(alert("设置成功"),t.concurrent=void 0,t.minInterval=void 0,t.maxInterval=void 0):alert(a.description)}):(this.minInterval=void 0,alert("最小间隔不应超过最大间隔"),this.modalDisplay=!1):this.modalDisplay=!1},setPluginStatus:function(t){this.data.scan_plugin_status[pl].enable=!this.data.scan_plugin_status[pl].enable},reset:function(){this.concurrent=void 0,this.minInterval=void 0,this.maxInterval=void 0}}},Ma={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"setConfigModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),e("div",{staticClass:"modal-body"},[e("form",{staticClass:"form-horizontal",attrs:{id:""}},[e("div",{staticClass:"form-group"},[t._m(1),t._v(" "),e("div",{staticClass:"row",staticStyle:{"margin-top":"3px"}},[t._l(t.data.scan_plugin_status,function(a,s,n){return[e("div",{staticClass:"col"},[e("label",{staticClass:"custom-switch",staticStyle:{"min-width":"200px"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.enable,expression:"value.enable"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.enable)?t._i(a.enable,null)>-1:a.enable},on:{change:function(e){var s=a.enable,n=e.target,i=!!n.checked;if(Array.isArray(s)){var r=t._i(s,null);n.checked?r<0&&t.$set(a,"enable",s.concat([null])):r>-1&&t.$set(a,"enable",s.slice(0,r).concat(s.slice(r+1)))}else t.$set(a,"enable",i)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v(t._s(a.show_name))])])])]})],2)]),t._v(" "),e("div",{staticClass:"form-group"},[e("div",{staticClass:"row",staticStyle:{"margin-top":"3px"}},[e("div",{staticClass:"col"},[e("label",[t._v("url白名单正则（被正则命中的url不会被扫描, 正则会匹配request_uri部分,\n                    例如 http://test.com/path/eg?p=1&b=2 对应request_uri部分为 /path/eg?p=1&b=2,\n                    当不希望扫描path/eg开头的路径时时可以配置为 ^/path/eg）")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.white_url_reg,expression:"data.white_url_reg"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.white_url_reg},on:{input:function(a){a.target.composing||t.$set(t.data,"white_url_reg",a.target.value)}}}),t._v(" "),e("label",{directives:[{name:"show",rawName:"v-show",value:t.byurl_regex_error,expression:"byurl_regex_error"}],staticStyle:{color:"#ff0000"}},[t._v("*白名单正则非法")])])])]),t._v(" "),e("div",{staticClass:"form-group"},[e("div",{staticClass:"row",staticStyle:{"margin-top":"3px"}},[e("div",{staticClass:"col"},[e("label",{attrs:{for:"concurrent",align:"center"}},[t._v("最大并发请求数")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.scan_rate.max_concurrent_request,expression:"data.scan_rate.max_concurrent_request"}],staticClass:"form-control",attrs:{type:"number",id:"concurrent",placeholder:"20"},domProps:{value:t.data.scan_rate.max_concurrent_request},on:{input:function(a){a.target.composing||t.$set(t.data.scan_rate,"max_concurrent_request",a.target.value)}}}),t._v(" "),e("label",{directives:[{name:"show",rawName:"v-show",value:t.data.scan_rate.max_concurrent_request<=0,expression:"data.scan_rate.max_concurrent_request <= 0"}],staticStyle:{color:"#F00"}},[t._v("*最大并发数应大于0")])])])]),t._v(" "),e("div",{staticClass:"form-group"},[t._m(2),t._v(" "),e("div",{staticClass:"row",staticStyle:{"margin-top":"3px"}},[e("div",{staticClass:"col"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.scan_rate.min_request_interval,expression:"data.scan_rate.min_request_interval"}],staticClass:"form-control",attrs:{type:"number",id:"minInterval",placeholder:"0"},domProps:{value:t.data.scan_rate.min_request_interval},on:{input:function(a){a.target.composing||t.$set(t.data.scan_rate,"min_request_interval",a.target.value)}}}),t._v(" "),e("label",{directives:[{name:"show",rawName:"v-show",value:t.data.scan_rate.min_request_interval<0,expression:"data.scan_rate.min_request_interval < 0"}],staticStyle:{color:"#F00"}},[t._v("*最小间隔应大于等于0")])]),t._v(" "),t._m(3),t._v(" "),e("div",{staticClass:"col"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.scan_rate.max_request_interval,expression:"data.scan_rate.max_request_interval"}],staticClass:"form-control",attrs:{type:"number",id:"maxInterval",placeholder:"1000"},domProps:{value:t.data.scan_rate.max_request_interval},on:{input:function(a){a.target.composing||t.$set(t.data.scan_rate,"max_request_interval",a.target.value)}}}),t._v(" "),e("label",{directives:[{name:"show",rawName:"v-show",value:t.data.scan_rate.max_request_interval<=0,expression:"data.scan_rate.max_request_interval <= 0"}],staticStyle:{color:"#F00"}},[t._v("*最大间隔应大于0")])])])]),t._v(" "),e("div",{staticClass:"form-group"},[e("div",{staticClass:"row",staticStyle:{"margin-top":"3px"}},[e("div",{staticClass:"col"},[e("label",[t._v("扫描请求使用的http代理")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.scan_proxy,expression:"data.scan_proxy"}],staticClass:"form-control",attrs:{type:"text",id:"scanProxy"},domProps:{value:t.data.scan_proxy},on:{input:function(a){a.target.composing||t.$set(t.data,"scan_proxy",a.target.value)}}})])])])])]),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-primary pull-left",attrs:{type:"button",disabled:t.byurl_regex_error,"data-dismiss":t.modalDisplay},on:{click:function(a){return t.setConfigTask()}}},[t._v("确定\n        ")]),t._v(" "),e("button",{staticClass:"btn btn-info",attrs:{click:t.reset(),"data-dismiss":"modal"}},[t._v("\n          关闭\n        ")])])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[this._v("\n          任务设置\n        ")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("label",[this._v("请选择插件")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"row",staticStyle:{"margin-top":"3px"}},[a("div",{staticClass:"col"},[a("label",{attrs:{for:"minInterval",align:"center"}},[this._v("请求间隔(ms)")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col",attrs:{align:"middle"}},[a("h5",[this._v("～")])])}]},Na={name:"Iast",components:{IastConfigModal:e("VU/8")(Da,Ma,!1,null,null,null).exports,DatePicker:st},data:function(){return{data:[],taskObject:{},config:"",timer:"",refreshFreq:!0,loadIcon:[],loading:!1,currentPage:1,hostname:"",key_word:"",total:0,register:0,baseUrl:"v1/iast",running:"运行中",cancel:"终止",pause:"暂停",unknown:"未知状态",unscanned:"未启动"}},computed:D()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.fetchData(1)},currentPage:function(){this.fetchData(this.currentPage)}},mounted:function(){this.current_app.id=this.$route.params.app_id,this.current_app.id&&(this.fetchData(1),this.timer=setInterval(this.getInterval,3e3),this.setLoadIcons())},beforeDestroy:function(){clearInterval(this.timer)},methods:{ceil:Math.ceil,getInterval:function(){this.refreshFreq&&this.refreshDriver()},showIastConfigDetail:function(t){this.$refs.showIastConfigDetail.showModal(t)},fetchData:function(t){var a=this,e={order:"getAllTasks",data:{page:this.currentPage,app_id:this.current_app.id}};return this.request.post(this.baseUrl,e).then(function(e){a.page=t,void 0==e.data?(a.status=e.status,a.data=[],a.total=0):(a.status=e.data.status,a.data=e.data.result,a.total=e.data.total),a.register=e.register,a.loading=!1})},getRequest:function(t,a,e){e.app_id=this.current_app.id;var s={order:a,data:e};return this.request.post(t,s)},setLoadIcons:function(){for(var t=0;t<this.data.length;t++)this.loadIcon.push(!1)},getTaskStatus:function(t,a){return void 0==t.id?(this.taskObject[a]=this.unscanned,this.unscanned):(this.taskObject[a]=this.running,this.running)},stopTask:function(t){var a=this;this.loadIcon[t]=!0;var e=this.data[t].id;this.getRequest(this.baseUrl,"stopTask",{scanner_id:Number(e)}).then(function(e){var s=e.status;a.fetchData(a.currentPage),0==s||alert(e.description),a.loadIcon[t]=!1})},startTask:function(t){var a=this;this.loadIcon[t]=!0;var e=this.data[t].host,s=this.data[t].port;this.getRequest(this.baseUrl,"startTask",{host:e,port:s,config:{}}).then(function(e){var s=e.status;a.fetchData(a.currentPage),0==s||alert(e.description),a.loadIcon[t]=!1})},cleanTask:function(t,a){var e=this;if(0==a){if(1==confirm("确认删除任务?")){var s=this.data[t].host,n=this.data[t].port;this.getRequest(this.baseUrl,"cleanTask",{host:s,port:n,url_only:!1}).then(function(t){var a=t.status;e.fetchData(e.currentPage),0==a?alert("清除成功!"):alert(t.description)})}}else if(1==confirm("确认清空扫描队列?")){s=this.data[t].host,n=this.data[t].port;this.getRequest(this.baseUrl,"cleanTask",{host:s,port:n,url_only:!0}).then(function(t){var a=t.status;e.fetchData(e.currentPage),0==a?alert("清除成功!"):alert(t.description)})}},refreshDriver:function(){this.fetchData(this.currentPage)},getConfig:function(t){var a=this,e=t.host,s=t.port;this.getRequest(this.baseUrl,"getConfig",{host:e,port:s}).then(function(t){0!=t.status&&alert(t.description);var n=t.data;n.host=e,n.port=s,n.baseUrl=a.baseUrl,n.app_id=a.current_app.id,a.showIastConfigDetail(n)})}}},qa={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header"},[e("h1",{staticClass:"page-title"},[t._v("\n        扫描任务列表\n      ")]),t._v(" "),e("div",{staticClass:"page-options d-flex",staticStyle:{"margin-top":"5px"}},[e("div",{staticClass:"p-4"},[e("label",{staticClass:"custom-switch",attrs:{for:"checkRefresh"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.refreshFreq,expression:"refreshFreq"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",id:"checkRefresh"},domProps:{value:!0,checked:Array.isArray(t.refreshFreq)?t._i(t.refreshFreq,!0)>-1:t.refreshFreq},on:{change:function(a){var e=t.refreshFreq,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,!0);s.checked?i<0&&(t.refreshFreq=e.concat([!0])):i>-1&&(t.refreshFreq=e.slice(0,i).concat(e.slice(i+1)))}else t.refreshFreq=n}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("自动刷新")])])]),t._v(" "),e("div",{staticClass:"p-2"},[e("button",{staticClass:"btn btn-primary ml-2",attrs:{type:"button"},on:{click:function(a){return t.refreshDriver()}}},[e("span",{staticClass:"fa fa-refresh",attrs:{"aria-hidden":"true"}}),t._v(" 刷新\n          ")])])])]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("vue-loading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:t.fetchData},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-hover table-bordered"},[t._m(0),t._v(" "),e("tbody",t._l(t.data,function(a,s){return e("tr",[e("td",[e("a",[t._v(t._s(a.host)+":"+t._s(a.port))])]),t._v(" "),e("td",[t._v("\n              "+t._s(t.getTaskStatus(a,s))+"\n            ")]),t._v(" "),e("td",[t._v("\n              "+t._s(a.scanned)+"/"+t._s(a.failed)+"/"+t._s(a.total)+"\n            ")]),t._v(" "),e("td",[t._v("\n              "+t._s(0==a.last_time?"—":t.moment(1e3*a.last_time).format("YYYY-MM-DD HH:mm:ss"))+"\n            ")]),t._v(" "),e("td",[void 0==a.id?e("div",[t._v("—")]):e("div",[t._v("CPU "+t._s(a.cpu)+" / MEM "+t._s(a.mem))])]),t._v(" "),e("td",{attrs:{align:"left"}},[e("div",{staticStyle:{"vertical-align":"middle"}},[e("a",{directives:[{name:"show",rawName:"v-show",value:t.taskObject[s]!=t.unscanned,expression:"taskObject[i] != unscanned"}],attrs:{href:"javascript:",disabled:t.taskObject[s]==t.unscanned||t.loadIcon[s]},on:{click:function(a){return t.stopTask(s)}},model:{value:t.taskObject[s],callback:function(a){t.$set(t.taskObject,s,a)},expression:"taskObject[i]"}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.loadIcon[s],expression:"loadIcon[i]"}],staticClass:"fas fa-spinner fa-spin"}),t._v("\n                  停止扫描\n                ")]),t._v(" "),e("a",{directives:[{name:"show",rawName:"v-show",value:t.taskObject[s]==t.unscanned,expression:"taskObject[i] ==  unscanned"}],attrs:{href:"javascript:",disabled:t.taskObject[s]==t.running||t.loadIcon[s]},on:{click:function(a){return t.startTask(s)}}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.loadIcon[s],expression:"loadIcon[i]"}],staticClass:"fas fa-spinner fa-spin"}),t._v("\n                  启动扫描\n                ")]),t._v(" "),e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.getConfig(a)}}},[t._v("\n                  设置\n                ")]),t._v(" "),e("a",{directives:[{name:"show",rawName:"v-show",value:t.taskObject[s]==t.unscanned,expression:"taskObject[i] == unscanned"}],attrs:{href:"javascript:"},on:{click:function(a){return t.cleanTask(s,!0)}},model:{value:t.status,callback:function(a){t.status=a},expression:"status"}},[t._v("\n                  清空队列\n                ")]),t._v(" "),e("a",{directives:[{name:"show",rawName:"v-show",value:t.taskObject[s]==t.unscanned,expression:"taskObject[i] == unscanned"}],attrs:{href:"javascript:"},on:{click:function(a){return t.cleanTask(s,!1)}},model:{value:t.status,callback:function(a){t.status=a},expression:"status"}},[t._v("\n                  删除任务\n                ")])])])])}),0)]),t._v(" "),t.loading||0!=t.register?t._e():e("p",{staticClass:"text-center",model:{value:t.register,callback:function(a){t.register=a},expression:"register"}},[t._v("扫描器未连接或已离线，"),e("a",{attrs:{href:"https://rasp.baidu.com/doc/install/iast.html",target:"_blank"}},[t._v("请参考文档进行配置")])]),t._v(" "),t.loading||0!=t.total||1!=t.register?t._e():e("p",{staticClass:"text-center",model:{value:t.register,callback:function(a){t.register=a},expression:"register"}},[t._v("连接中")]),t._v(" "),t.loading||0!=t.total||2!=t.register?t._e():e("p",{staticClass:"text-center",model:{value:t.register,callback:function(a){t.register=a},expression:"register"}},[t._v("扫描器已连接，暂无数据。可尝试触发一些请求，"),e("a",{attrs:{href:"https://rasp.baidu.com/doc/install/iast.html#faq-no-task",target:"_blank"}},[t._v("或者参考文档排查")])]),t._v(" "),t.loading||3!=t.register?t._e():e("p",{staticClass:"text-center",model:{value:t.register,callback:function(a){t.register=a},expression:"register"}},[t._v("响应接收异常")]),t._v(" "),t.loading||4!=t.register?t._e():e("p",{staticClass:"text-center",model:{value:t.register,callback:function(a){t.register=a},expression:"register"}},[t._v("扫描器连接超时")]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" 结果，显示 "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:t.fetchData},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e()],1)])]),t._v(" "),e("IastConfigModal",{ref:"showIastConfigDetail"})],1)},staticRenderFns:[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",{attrs:{nowrap:""}},[t._v("\n              目标\n            ")]),t._v(" "),e("th",{attrs:{nowrap:""}},[t._v("\n              状态\n            ")]),t._v(" "),e("th",{attrs:{nowrap:""}},[t._v("\n              已扫描/已失败/总任务\n            ")]),t._v(" "),e("th",[t._v("\n              最后收到任务\n            ")]),t._v(" "),e("th",[t._v("\n              进程资源消耗\n            ")]),t._v(" "),e("th",{attrs:{nowrap:""}},[t._v("\n              操作\n            ")])])])}]},Ua=e("VU/8")(Na,qa,!1,null,null,null).exports,Ra={name:"AddHostModal",data:function(){return{data:{},location:location,agent_url_id:0,agent_urls:[],panel_url:"",rasp_version:"1.3.7"}},computed:D()({},Object(c.c)(["current_app","sticky"])),mounted:function(){var t=this;$("#addHostModal").on("hidden.bs.modal",function(){t.setSticky(!0)})},methods:D()({},Object(c.d)(["setSticky"]),{showModal:function(t){var a=this;return this.request.post("v1/api/server/url/get",{}).then(function(t){a.agent_urls=t.agent_urls,a.panel_url=t.panel_url,a.setSticky(!1),$("#addHostModal").modal()})}})},La={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"addHostModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),e("div",{staticClass:"modal-body",staticStyle:{"padding-top":"0"}},[0==t.agent_urls.length?e("div",[e("p",[e("br"),t._v("\n              你还没有设置 Agent 服务器地址，请先前往 \n              "),e("router-link",{attrs:{"data-dismiss":"modal",to:{name:"settings",params:{setting_tab:"panel"}}}},[t._v("[后台设置]")]),t._v(" 页面添加\n            ")],1)]):e("div",[t._m(1),t._v(" "),e("br"),t._v(" "),e("div",{staticClass:"tab-content",attrs:{id:"myTabContent"}},[e("div",{staticClass:"tab-pane fade",attrs:{id:"common-tab"}},[t._m(2),t._v(" "),e("h4",[t._v("Java 版本")]),t._v(" "),e("pre",[t._v("cloud.enable: true\ncloud.backend_url: "+t._s(t.agent_urls[0])+"\ncloud.app_id: "+t._s(t.current_app.id)+"\ncloud.app_secret: "+t._s(t.current_app.secret)+"\ncloud.heartbeat_interval: 90")]),t._v(" "),e("h4",[t._v("PHP 版本")]),t._v(" "),e("pre",[t._v("openrasp.app_id="+t._s(t.current_app.id)+"\nopenrasp.app_secret="+t._s(t.current_app.secret)+"            \nopenrasp.backend_url="+t._s(t.agent_urls[0])+"\nopenrasp.heartbeat_interval=90")])]),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{id:"batch-tab"}},[t._m(3),t._v(" "),e("h4",[t._v("1. 下载自动安装程序")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("curl https://packages.baidu.com/app/openrasp/release/"+t._s(t.rasp_version)+"/installer.sh -o installer.sh")]),t._v(" "),e("h4",[t._v("2. 执行脚本")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("bash installer.sh -i -a "+t._s(t.current_app.id)+" -b "+t._s(t.current_app.secret)+" -c "+t._s(t.agent_urls[t.agent_url_id]))])]),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{id:"docker-tab"}},[t._m(4),t._v(" "),e("h4",[t._v("Java Tomcat 容器示例")]),t._v(" "),e("pre",[t._v("ADD https://packages.baidu.com/app/openrasp/release/"+t._s(t.rasp_version)+"/rasp-java.tar.gz /tmp\nRUN cd /tmp \\\n    && tar -xf rasp-java.tar.* \\\n    && /jdk/bin/java -jar rasp-*/RaspInstall.jar -install /tomcat/ -heartbeat 90 -appid "+t._s(t.current_app.id)+" -appsecret "+t._s(t.current_app.secret)+" -backendurl "+t._s(t.agent_urls[t.agent_url_id])+" \\\n    && rm -rf rasp-*\n# 对于Alpine Linux容器，需要安装系统依赖\n# RUN apk add --no-cache libcurl libstdc++")]),t._v(" "),e("h4",[t._v("Java SpringBoot 容器示例")]),t._v(" "),e("pre",[t._v("ADD https://packages.baidu.com/app/openrasp/release/"+t._s(t.rasp_version)+'/rasp-java.tar.gz /tmp\nRUN cd /tmp \\\n    && tar -xf rasp-java.tar.* \\\n    && mv rasp-*/rasp/ /rasp/ \\\n    && rm -f rasp-java.tar.gz\n# 对于Alpine Linux容器，需要安装系统依赖\n# RUN apk add --no-cache libcurl libstdc++\n\nRUN echo "cloud.enable: true" >> /rasp/conf/openrasp.yml \\\n    && echo "cloud.backend_url: '+t._s(t.agent_urls[t.agent_url_id])+'" >> /rasp/conf/openrasp.yml \\\n    && echo "cloud.app_id: '+t._s(t.current_app.id)+'" >> /rasp/conf/openrasp.yml \\\n    && echo "cloud.app_secret: '+t._s(t.current_app.secret)+'" >> /rasp/conf/openrasp.yml\n\n# 对于 JDK9，需要额外增加 --add-opens java.base/jdk.internal.loader=ALL-UNNAMED 参数\nCMD java -javaagent:"/rasp/rasp.jar" -jar /springboot.jar')]),t._v(" "),e("h4",[t._v("PHP 容器示例")]),t._v(" "),e("pre",[t._v("ADD https://packages.baidu.com/app/openrasp/release/"+t._s(t.rasp_version)+"/rasp-php-linux.tar.bz2 /tmp/\nRUN cd /tmp \\\n    && tar -xf rasp-php-linux.tar.bz2 \\\n    && php rasp-php-*/install.php -d /opt/rasp/ --heartbeat 90 --backend-url "+t._s(t.agent_urls[t.agent_url_id])+" --app-id "+t._s(t.current_app.id)+" --app-secret "+t._s(t.current_app.secret)+" \\\n    && rm -rf rasp-php*")])]),t._v(" "),e("div",{staticClass:"tab-pane fade show active",attrs:{id:"java-tab"}},[e("h4",[t._v("1. 下载 Java Agent 安装包")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("curl https://packages.baidu.com/app/openrasp/release/"+t._s(t.rasp_version)+"/rasp-java.tar.gz -o rasp-java.tar.gz"),e("br"),t._v("tar -xvf rasp-java.tar.gz"),e("br"),t._v("cd rasp-*/")]),t._v(" "),e("h4",[t._v("2. 执行 RaspInstall 进行安装")]),t._v(" "),e("p",[t._v("请先替换 /path/to/tomcat 为你的服务器路径，再执行命令安装")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("java -jar RaspInstall.jar -heartbeat 90 -appid "+t._s(t.current_app.id)+" -appsecret "+t._s(t.current_app.secret)+" -backendurl "+t._s(t.agent_urls[t.agent_url_id])+" -install "),e("font",{attrs:{color:"red"}},[t._v("/path/to/tomcat")])],1),t._v(" "),e("h4",[t._v("3. 重启 Tomcat/JBoss/WebLogic/SpringBoot 应用服务器")]),t._v(" "),t._m(5)]),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{id:"php-tab"}},[e("h4",[t._v("1. 下载 PHP 安装包")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("curl https://packages.baidu.com/app/openrasp/release/"+t._s(t.rasp_version)+"/rasp-php-linux.tar.bz2 -o rasp-php-linux.tar.bz2"),e("br"),t._v("tar -xvf rasp-php-linux.tar.bz2"),e("br"),t._v("cd rasp-*/")]),t._v(" "),e("h4",[t._v("2. 执行 install.php 进行安装")]),t._v(" "),t._m(6),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("php install.php -d "),e("font",{attrs:{color:"red"}},[t._v("/opt/rasp")]),t._v(" --heartbeat 90 --app-id "+t._s(t.current_app.id)+" --app-secret "+t._s(t.current_app.secret)+" --backend-url "+t._s(t.agent_urls[t.agent_url_id]))],1),t._v(" "),e("h4",[t._v("3. 重启 PHP-FPM 或者 Apache 服务器")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("service php-fpm restart")]),t._v(" "),e("p",[t._v("-或者-")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("apachectl -k restart")])]),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{id:"iast-tab"}},[e("h4",[t._v("1. 下载或者升级 Fuzz 工具")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("pip3 install --upgrade git+https://github.com/baidu-security/openrasp-iast")]),t._v(" "),e("h4",[t._v("2. 配置 MySQL 服务器 - 使用 MySQL root 账号执行以下命令授权")]),t._v(" "),e("pre",[t._v("# 如果是 MySQL 8.X 以及更高版本\nDROP DATABASE IF EXISTS openrasp;\nCREATE DATABASE openrasp default charset utf8mb4 COLLATE utf8mb4_general_ci;\nCREATE user 'rasp'@'%' identified with mysql_native_password by 'rasp123';\ngrant all privileges on openrasp.* to 'rasp'@'%' with grant option;\ngrant all privileges on openrasp.* to 'rasp'@'localhost' with grant option;\n\n# 如果是低版本 MySQL\nDROP DATABASE IF EXISTS openrasp;\nCREATE DATABASE openrasp default charset utf8mb4 COLLATE utf8mb4_general_ci;\ngrant all privileges on openrasp.* to 'rasp'@'%' identified by 'rasp123';\ngrant all privileges on openrasp.* to 'rasp'@'localhost' identified by 'rasp123';\n")]),t._v(" "),e("h4",[t._v("3. 配置 Fuzz 工具 - 请修正 MySQL 服务器地址")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("openrasp-iast config -a "+t._s(t.current_app.id)+" -b "+t._s(t.current_app.secret)+" -c "+t._s(t.panel_url)+" -m mysql://rasp:rasp123@127.0.0.1/openrasp")]),t._v(" "),e("h4",[t._v("4. 启动 Fuzz 工具")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("openrasp-iast start -f")]),t._v(" "),e("p",[t._v("-或者后台启动-")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("openrasp-iast start")])])])])]),t._v(" "),t._m(7)])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[this._v("\n            添加主机\n          ")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ul",{staticClass:"nav nav-tabs",attrs:{id:"myTab",role:"tablist"}},[e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{"data-toggle":"tab",href:"#common-tab"}},[t._v("\n                  手动安装\n                ")])]),t._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{"data-toggle":"tab",href:"#batch-tab"}},[t._v("\n                  批量部署\n                ")])]),t._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{"data-toggle":"tab",href:"#docker-tab"}},[t._v("\n                  Docker 部署\n                ")])]),t._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link active",attrs:{"data-toggle":"tab",href:"#java-tab"}},[t._v("\n                  Java 服务器\n                ")])]),t._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{"data-toggle":"tab",href:"#php-tab"}},[t._v("\n                  PHP 服务器\n                ")])]),t._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{"data-toggle":"tab",href:"#iast-tab"}},[t._v("\n                  Fuzz 工具安装\n                ")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("OpenRASP 自动安装程序可以覆盖绝大多数场景，如果你的环境无法自动安装，请参考 "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/install/software.html",target:"_blank"}},[this._v("安装客户端")]),this._v(" 进行手动安装。以下是连接管理后台所需要的关键参数，Java 版本请附加到 conf/openrasp.yml，PHP 版本请附加到 ini 文件。")])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"alert alert-warning"},[this._v("\n                  批量部署脚本，会自动安装并重启应用，更多信息请看\n                  "),a("a",{staticClass:"active router-link-active",attrs:{target:"_blank",href:"https://rasp.baidu.com/doc/install/deploy.html"}},[this._v("大规模部署")]),this._v("\n                  文档\n                ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"alert alert-warning"},[this._v("\n                  在构建镜像阶段加入 OpenRASP 即可，更多信息请看\n                  "),a("a",{staticClass:"active router-link-active",attrs:{target:"_blank",href:"https://rasp.baidu.com/doc/install/deploy.html#container"}},[this._v("大规模部署")]),this._v("\n                  文档\n                ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("pre",{staticStyle:{"white-space":"inherit"}},[this._v("/path/to/tomcat/bin/shutdown.sh"),a("br"),this._v("/path/to/tomcat/bin/startup.sh")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("默认安装路径为 "),a("strong",[this._v("/opt/rasp")]),this._v("，可替换为其他路径")])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-footer"},[a("a",{staticClass:"btn btn-secondary mr-auto",attrs:{href:"https://rasp.baidu.com/doc/install/software.html",target:"_blank"}},[this._v("\n            了解更多\n          ")]),this._v(" "),a("button",{staticClass:"btn btn-primary",attrs:{"data-dismiss":"modal"}},[this._v("\n            关闭\n          ")])])}]},Oa={name:"Navigation",components:{AddHostModal:e("VU/8")(Ra,La,!1,null,null,null).exports},data:function(){return{keyword:"",no_plugin:!1,all_log:!1,is_default_password:!1,apps:[],total:0,loading:!1}},computed:D()({},Object(c.c)(["current_app","app_list","app_count","sticky"]),{app_list_filtered:function(){var t=this.keyword.toLowerCase();return""===t&&(this.total=this.app_count),this.apps.length>0?this.apps.filter(function(a){return-1!=a.name.toLowerCase().indexOf(t)}):this.app_list.filter(function(a){return-1!=a.name.toLowerCase().indexOf(t)})}}),watch:{current_app:function(t){this.no_plugin=!this.current_app.selected_plugin_id||!this.current_app.selected_plugin_id.length,this.all_log=!1,this.no_plugin||(this.all_log=this.current_app.algorithm_config.meta.all_log),this.$router.push({name:this.$route.name,params:{app_id:t.id}})},keyword:{handler:function(){var t=this;clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.loadApps(t.keyword)},100)},deep:!0}},methods:D()({},Object(c.b)(["loadAppList"]),Object(c.d)(["setCurrentApp"]),Object(c.d)(["setSticky"]),{loadApps:function(t){var a=this;return this.loading=!0,this.request.post("v1/api/app/get",{name:t,page:1,perpage:50}).then(function(t){a.apps=t.data,a.total=t.total,a.loading=!1})},showAddHostModal:function(){this.$refs.addHost.showModal()},doLogout:function(){return this.request.post("v1/user/logout",{}).then(function(t){o.a.set("RASP_AUTH_ID",null),location.href="/#/login"})}}),mounted:function(){var t=this;this.request.post("v1/api/server/url/get",{}).then(function(a){if(a)if(a.panel_url)console.log("panel_url already configured");else{console.log("panel_url not set, initializing");var e=location.href.split(/\?|#/)[0];t.request.post("v1/api/server/url",{panel_url:e,agent_urls:[e]}).then(function(t){})}}),this.request.post("/v1/user/default",{}).then(function(a){a&&(t.is_default_password=a.is_default)})}},Ia={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"header py-4"},[e("div",{staticClass:"container"},[e("div",{staticClass:"d-flex"},[e("div",{staticClass:"dropdown"},[e("a",{staticClass:"nav-link pr-0 leading-none",staticStyle:{"padding-left":"0"},attrs:{href:"javascript:","data-toggle":"dropdown"}},[e("span",{staticClass:"avatar",style:{"background-image":t.current_app.language?"url(/static/images/lang/"+t.current_app.language+".png)":void 0}}),t._v(" "),e("span",{staticClass:"ml-2 d-none d-lg-block"},[t._m(0),t._v(" "),e("small",{staticClass:"text-default d-block mt-1"},[t._v("\n                "+t._s(t.current_app.name)+"\n              ")])])]),t._v(" "),e("div",{staticClass:"dropdown-menu dropdown-menu-left dropdown-menu-arrow"},[e("div",{staticClass:"form-group",staticStyle:{margin:"6px 15px 10px 15px"}},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.keyword,expression:"keyword",modifiers:{trim:!0}}],staticClass:"form-control form-control-sm",attrs:{type:"text"},domProps:{value:t.keyword},on:{input:function(a){a.target.composing||(t.keyword=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticStyle:{"max-height":"300px",overflow:"scroll"}},t._l(t.app_list_filtered,function(a){return e("a",{key:a.id,staticClass:"dropdown-item",attrs:{href:"javascript:"},on:{click:function(e){return e.preventDefault(),t.setCurrentApp(a)}}},[e("i",{staticClass:"dropdown-icon fe fe-lock"}),t._v("\n                "+t._s(a.name)+"\n              ")])}),0),t._v(" "),e("div",{staticClass:"dropdown-divider"}),t._v(" "),e("router-link",{class:{"dropdown-item":!0,active:!1},attrs:{to:{name:"settings",params:{setting_tab:"app"}}}},[e("i",{staticClass:"dropdown-icon fe fe-settings"}),t._v("\n              应用管理 ("+t._s(t.total)+")\n            ")])],1)]),t._v(" "),e("div",{staticClass:"d-flex order-lg-2 ml-auto"},[e("div",{staticClass:"nav-item d-none d-md-flex"},[e("a",{staticClass:"btn btn-sm btn-outline-primary",attrs:{href:"javascript:"},on:{click:t.showAddHostModal}},[t._v("\n              添加主机\n            ")])]),t._v(" "),e("div",{staticClass:"dropdown"},[t._m(1),t._v(" "),e("div",{staticClass:"dropdown-menu dropdown-menu-right dropdown-menu-arrow",attrs:{"x-placement":"bottom-end"}},[e("RouterLink",{staticClass:"dropdown-item",attrs:{to:{name:"exceptions",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"dropdown-icon fe fe-alert-circle"}),t._v("\n                异常日志\n              ")]),t._v(" "),e("RouterLink",{staticClass:"dropdown-item",attrs:{to:{name:"crash",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"dropdown-icon fe fe-alert-triangle"}),t._v("\n                崩溃信息\n              ")]),t._v(" "),e("RouterLink",{staticClass:"dropdown-item",attrs:{to:{name:"audit",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"dropdown-icon fe fe-user-check"}),t._v("\n                操作审计\n              ")]),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),e("div",{staticClass:"dropdown-divider"}),t._v(" "),e("a",{staticClass:"dropdown-item",attrs:{href:"javascript:"},on:{click:function(a){return t.doLogout()}}},[e("i",{staticClass:"dropdown-icon fe fe-log-out"}),t._v(" 退出登录\n              ")])],1)])]),t._v(" "),t._m(4)])])]),t._v(" "),e("div",{staticClass:"header collapse d-lg-flex p-0",attrs:{id:"headerMenuCollapse"}},[e("div",{staticClass:"container"},[e("div",{staticClass:"row align-items-center"},[e("div",{staticClass:"col-lg order-lg-first"},[t.current_app.id?e("ul",{staticClass:"nav nav-tabs border-0 flex-column flex-lg-row"},[e("li",{staticClass:"nav-item"},[e("RouterLink",{staticClass:"nav-link",attrs:{to:{name:"dashboard",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"fe fe-home"}),t._v("\n                安全总览\n              ")])],1),t._v(" "),e("li",{staticClass:"nav-item"},[e("RouterLink",{staticClass:"nav-link",attrs:{to:{name:"vulns",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"fe fe-eye"}),t._v("\n                漏洞列表\n              ")])],1),t._v(" "),e("li",{staticClass:"nav-item"},[e("RouterLink",{staticClass:"nav-link",attrs:{to:{name:"events",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"fe fe-bell"}),t._v("\n                攻击事件\n              ")])],1),t._v(" "),e("li",{staticClass:"nav-item dropdown"},[e("RouterLink",{staticClass:"nav-link",attrs:{to:{name:"baseline",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"fe fe-check-square"}),t._v("\n                安全基线\n              ")])],1),t._v(" "),e("li",{staticClass:"nav-item"},[e("RouterLink",{staticClass:"nav-link",attrs:{to:{name:"hosts",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"fe fe-cloud"}),t._v("\n                主机管理\n              ")])],1),t._v(" "),e("li",{staticClass:"nav-item"},[e("RouterLink",{staticClass:"nav-link",attrs:{to:{name:"iast",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"fa fa-paper-plane-o"}),t._v("\n                扫描器\n              ")])],1),t._v(" "),e("li",{staticClass:"nav-item"},[e("RouterLink",{staticClass:"nav-link",attrs:{to:{name:"plugins",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"fe fe-zap"}),t._v("\n                插件管理\n              ")])],1),t._v(" "),e("li",{staticClass:"nav-item"},[e("RouterLink",{staticClass:"nav-link",attrs:{to:{name:"dependency",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"fe fe-code"}),t._v("\n                类库信息\n              ")])],1),t._v(" "),e("li",{staticClass:"nav-item dropdown"},[e("RouterLink",{staticClass:"nav-link",attrs:{to:{name:"settings",params:{setting_tab:"general",app_id:t.current_app.id}}}},[e("i",{staticClass:"fe fe-settings"}),t._v("\n                系统设置\n              ")])],1)]):t._e()])])])]),t._v(" "),t.is_default_password?e("div",{staticClass:"alert alert-warning",staticStyle:{"margin-bottom":"0"}},[e("div",{staticClass:"container"},[t._v("\n      你还没有修改默认的后台密码，可前往 \n      "),e("router-link",{attrs:{to:{name:"settings",params:{setting_tab:"auth"}}}},[t._v("登录认证")]),t._v(" 设置\n    ")],1)]):t._e(),t._v(" "),t.no_plugin?e("div",{staticClass:"alert alert-warning"},[e("div",{staticClass:"container"},[e("strong",[t._v("注意!")]),t._v(" 当前应用没有配置任何检测插件，请前往 \n      "),e("router-link",{attrs:{to:{name:"plugins"}}},[t._v("插件页面")]),t._v(" 进行配置\n    ")],1)]):t._e(),t._v(" "),t.all_log?e("div",{staticClass:"alert alert-warning"},[e("div",{staticClass:"container"},[t._v("\n      当前以「记录日志」模式运行，可前往 \n      "),e("router-link",{attrs:{to:{name:"settings",params:{setting_tab:"algorithm"}}}},[t._v("防护设置")]),t._v(" 关闭\n    ")],1)]):t._e(),t._v(" "),e("AddHostModal",{ref:"addHost"})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"text-muted",staticStyle:{"margin-left":"-2px"}},[this._v("\n                当前应用\n                "),a("i",{staticClass:"fa fa-caret-down"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("a",{staticClass:"nav-link pr-0 leading-none",attrs:{href:"javascript:","data-toggle":"dropdown"}},[a("span",{staticClass:"ml-2 d-none d-lg-block"},[a("span",{staticClass:"text-default"},[this._v("\n                  openrasp "),a("i",{staticClass:"fa fa-caret-down"})]),this._v(" "),a("small",{staticClass:"text-muted d-block mt-1"},[this._v("\n                  管理员权限\n                ")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("a",{staticClass:"dropdown-item",attrs:{href:"https://rasp.baidu.com/doc",target:"_blank"}},[a("i",{staticClass:"dropdown-icon fe fe-file-text"}),this._v(" 帮助文档\n              ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("a",{staticClass:"dropdown-item",attrs:{href:"https://rasp.baidu.com/#section-support",target:"_blank"}},[a("i",{staticClass:"dropdown-icon fa fa-qq"}),this._v(" 技术支持\n              ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("a",{staticClass:"header-toggler d-lg-none ml-3 ml-lg-0",attrs:{href:"#","data-toggle":"collapse","data-target":"#headerMenuCollapse"}},[a("span",{staticClass:"header-toggler-icon"})])}]},za={name:"Footer",data:function(){return{cloud:{version:"获取中",commit_id:"",build_time:""},fe:{version:"1.0.0",commit_id:"Unknown",build_time:"Unknown"}}},methods:{getVersion:function(){var t=this;this.request.post("v1/version",{}).then(function(a){t.cloud=a})}},mounted:function(){this.getVersion()}},Fa={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("footer",{staticClass:"footer"},[e("div",{staticClass:"container"},[e("div",{staticClass:"row align-items-center flex-row-reverse"},[t._m(0),t._v(" "),e("div",{staticClass:"col-12 col-lg-auto mt-3 mt-lg-0 text-center"},[t._v("\n        Copyright © 2017-2020 Baidu, Inc. "+t._s(t.cloud.version)+" ("+t._s(t.cloud.commit_id.substr(0,8))+")，编译时间 "+t._s(t.cloud.build_time)+"\n      ")])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col-auto ml-lg-auto"},[a("div",{staticClass:"row align-items-center"},[a("div",{staticClass:"col-auto"},[a("ul",{staticClass:"list-inline list-inline-dots mb-0"},[a("li",{staticClass:"list-inline-item"},[a("a",{attrs:{href:"https://rasp.baidu.com/",target:"_blank"}},[this._v("官方网站")])]),this._v(" "),a("li",{staticClass:"list-inline-item"},[a("a",{attrs:{href:"https://rasp.baidu.com/#section-books",target:"_blank"}},[this._v("最佳实践")])])])])])])}]},Ta={name:"Main",components:{Navigation:e("VU/8")(Oa,Ia,!1,null,null,null).exports,Footer:e("VU/8")(za,Fa,!1,null,null,null).exports}},Ha={render:function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"page",attrs:{id:"main"}},[a("div",{staticStyle:{"min-height":"calc(100vh - 67px)"}},[a("Navigation"),this._v(" "),a("RouterView",{staticStyle:{"min-height":"100%","margin-bottom":"-50px"}})],1),this._v(" "),a("Footer",{staticStyle:{height:"67px"}})],1)},staticRenderFns:[]},Va=e("VU/8")(Ta,Ha,!1,null,null,null).exports;s.default.use(r.a);var Ya=new r.a({routes:[{path:"/login",name:"login",component:j},{path:"/",beforeEnter:function(t,a,e){o.a.get("RASP_AUTH_ID")?P.dispatch("loadAppList",t.params.app_id).then(function(){return e()}).catch(function(t){console.error(t),e({name:"500"})}):e({name:"login",query:{next:location.href}})},component:Va,children:[{path:"dashboard/:app_id",name:"dashboard",component:V},{path:"hosts/:app_id/",name:"hosts",component:ht},{path:"audit/:app_id/",name:"audit",component:oa},{path:"dependency/:app_id/",name:"dependency",component:Ea},{path:"iast/:app_id/",name:"iast",component:Ua},{path:"settings/:setting_tab/:app_id/",name:"settings",component:Zt},{path:"plugins/:app_id/",name:"plugins",component:ia},{path:"baseline/:app_id/",name:"baseline",component:rt},{path:"crash/:app_id/",name:"crash",component:_t},{path:"events/:app_id/",name:"events",component:fa},{path:"vulns/:app_id/",name:"vulns",component:ya},{path:"exceptions/:app_id/",name:"exceptions",component:$a},{path:"*",redirect:{name:"dashboard"}}]},{path:"*",redirect:{name:"dashboard"}}],linkExactActiveClass:"active"}),Xa=e("wvfG"),Ba=e.n(Xa),Ja=e("Tqaz"),Wa=(e("K3J8"),e("Jmt5"),e("9M+g"),e("kD4L"),e("lkn4"),e("x9ll"),e("fUvK"),e("f4zI"));s.default.mixin({filters:{capitalize:function(t){return t?(t=t.toString()).charAt(0).toUpperCase()+t.slice(1):""}},components:{VueLoading:Wa.VueLoading},data:function(){return{request:w}},mounted:function(){$(document).on("click.bs.dropdown.data-api",".dropdown .keep-open-on-click",function(t){t.stopPropagation()})},methods:{moment:function(){return Q.a.apply(void 0,arguments)}}}),s.default.use(Ba.a),s.default.use(Ja.a),window.$=window.jQuery=e("7t+N"),s.default.config.productionTip=!1,s.default.prototype.$http=v.a,new s.default({el:"#app",router:Ya,store:P,render:function(t){return t(i)}})},kD4L:function(t,a){},lkn4:function(t,a){},uslO:function(t,a,e){var s={"./af":"3CJN","./af.js":"3CJN","./ar":"3MVc","./ar-dz":"tkWw","./ar-dz.js":"tkWw","./ar-kw":"j8cJ","./ar-kw.js":"j8cJ","./ar-ly":"wPpW","./ar-ly.js":"wPpW","./ar-ma":"dURR","./ar-ma.js":"dURR","./ar-sa":"7OnE","./ar-sa.js":"7OnE","./ar-tn":"BEem","./ar-tn.js":"BEem","./ar.js":"3MVc","./az":"eHwN","./az.js":"eHwN","./be":"3hfc","./be.js":"3hfc","./bg":"lOED","./bg.js":"lOED","./bm":"hng5","./bm.js":"hng5","./bn":"aM0x","./bn.js":"aM0x","./bo":"w2Hs","./bo.js":"w2Hs","./br":"OSsP","./br.js":"OSsP","./bs":"aqvp","./bs.js":"aqvp","./ca":"wIgY","./ca.js":"wIgY","./cs":"ssxj","./cs.js":"ssxj","./cv":"N3vo","./cv.js":"N3vo","./cy":"ZFGz","./cy.js":"ZFGz","./da":"YBA/","./da.js":"YBA/","./de":"DOkx","./de-at":"8v14","./de-at.js":"8v14","./de-ch":"Frex","./de-ch.js":"Frex","./de.js":"DOkx","./dv":"rIuo","./dv.js":"rIuo","./el":"CFqe","./el.js":"CFqe","./en-au":"Sjoy","./en-au.js":"Sjoy","./en-ca":"Tqun","./en-ca.js":"Tqun","./en-gb":"hPuz","./en-gb.js":"hPuz","./en-ie":"ALEw","./en-ie.js":"ALEw","./en-il":"QZk1","./en-il.js":"QZk1","./en-nz":"dyB6","./en-nz.js":"dyB6","./eo":"Nd3h","./eo.js":"Nd3h","./es":"LT9G","./es-do":"7MHZ","./es-do.js":"7MHZ","./es-us":"INcR","./es-us.js":"INcR","./es.js":"LT9G","./et":"XlWM","./et.js":"XlWM","./eu":"sqLM","./eu.js":"sqLM","./fa":"2pmY","./fa.js":"2pmY","./fi":"nS2h","./fi.js":"nS2h","./fo":"OVPi","./fo.js":"OVPi","./fr":"tzHd","./fr-ca":"bXQP","./fr-ca.js":"bXQP","./fr-ch":"VK9h","./fr-ch.js":"VK9h","./fr.js":"tzHd","./fy":"g7KF","./fy.js":"g7KF","./gd":"nLOz","./gd.js":"nLOz","./gl":"FuaP","./gl.js":"FuaP","./gom-latn":"+27R","./gom-latn.js":"+27R","./gu":"rtsW","./gu.js":"rtsW","./he":"Nzt2","./he.js":"Nzt2","./hi":"ETHv","./hi.js":"ETHv","./hr":"V4qH","./hr.js":"V4qH","./hu":"xne+","./hu.js":"xne+","./hy-am":"GrS7","./hy-am.js":"GrS7","./id":"yRTJ","./id.js":"yRTJ","./is":"upln","./is.js":"upln","./it":"FKXc","./it.js":"FKXc","./ja":"ORgI","./ja.js":"ORgI","./jv":"JwiF","./jv.js":"JwiF","./ka":"RnJI","./ka.js":"RnJI","./kk":"j+vx","./kk.js":"j+vx","./km":"5j66","./km.js":"5j66","./kn":"gEQe","./kn.js":"gEQe","./ko":"eBB/","./ko.js":"eBB/","./ky":"6cf8","./ky.js":"6cf8","./lb":"z3hR","./lb.js":"z3hR","./lo":"nE8X","./lo.js":"nE8X","./lt":"/6P1","./lt.js":"/6P1","./lv":"jxEH","./lv.js":"jxEH","./me":"svD2","./me.js":"svD2","./mi":"gEU3","./mi.js":"gEU3","./mk":"Ab7C","./mk.js":"Ab7C","./ml":"oo1B","./ml.js":"oo1B","./mn":"CqHt","./mn.js":"CqHt","./mr":"5vPg","./mr.js":"5vPg","./ms":"ooba","./ms-my":"G++c","./ms-my.js":"G++c","./ms.js":"ooba","./mt":"oCzW","./mt.js":"oCzW","./my":"F+2e","./my.js":"F+2e","./nb":"FlzV","./nb.js":"FlzV","./ne":"/mhn","./ne.js":"/mhn","./nl":"3K28","./nl-be":"Bp2f","./nl-be.js":"Bp2f","./nl.js":"3K28","./nn":"C7av","./nn.js":"C7av","./pa-in":"pfs9","./pa-in.js":"pfs9","./pl":"7LV+","./pl.js":"7LV+","./pt":"ZoSI","./pt-br":"AoDM","./pt-br.js":"AoDM","./pt.js":"ZoSI","./ro":"wT5f","./ro.js":"wT5f","./ru":"ulq9","./ru.js":"ulq9","./sd":"fW1y","./sd.js":"fW1y","./se":"5Omq","./se.js":"5Omq","./si":"Lgqo","./si.js":"Lgqo","./sk":"OUMt","./sk.js":"OUMt","./sl":"2s1U","./sl.js":"2s1U","./sq":"V0td","./sq.js":"V0td","./sr":"f4W3","./sr-cyrl":"c1x4","./sr-cyrl.js":"c1x4","./sr.js":"f4W3","./ss":"7Q8x","./ss.js":"7Q8x","./sv":"Fpqq","./sv.js":"Fpqq","./sw":"DSXN","./sw.js":"DSXN","./ta":"+7/x","./ta.js":"+7/x","./te":"Nlnz","./te.js":"Nlnz","./tet":"gUgh","./tet.js":"gUgh","./tg":"5SNd","./tg.js":"5SNd","./th":"XzD+","./th.js":"XzD+","./tl-ph":"3LKG","./tl-ph.js":"3LKG","./tlh":"m7yE","./tlh.js":"m7yE","./tr":"k+5o","./tr.js":"k+5o","./tzl":"iNtv","./tzl.js":"iNtv","./tzm":"FRPF","./tzm-latn":"krPU","./tzm-latn.js":"krPU","./tzm.js":"FRPF","./ug-cn":"To0v","./ug-cn.js":"To0v","./uk":"ntHu","./uk.js":"ntHu","./ur":"uSe8","./ur.js":"uSe8","./uz":"XU1s","./uz-latn":"/bsm","./uz-latn.js":"/bsm","./uz.js":"XU1s","./vi":"0X8Q","./vi.js":"0X8Q","./x-pseudo":"e/KL","./x-pseudo.js":"e/KL","./yo":"YXlc","./yo.js":"YXlc","./zh-cn":"Vz2w","./zh-cn.js":"Vz2w","./zh-hk":"ZUyn","./zh-hk.js":"ZUyn","./zh-tw":"BbgG","./zh-tw.js":"BbgG"};function n(t){return e(i(t))}function i(t){var a=s[t];if(!(a+1))throw new Error("Cannot find module '"+t+"'.");return a}n.keys=function(){return Object.keys(s)},n.resolve=i,t.exports=n,n.id="uslO"},x9ll:function(t,a){}},["NHnr"]);
//# sourceMappingURL=app.b590102301ab171b51f0.js.map